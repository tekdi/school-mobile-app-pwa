import{r as t,c as e,g as r}from"./p-8938a358.js";const n=typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}var o=i;var a=s;if(typeof n.setTimeout==="function"){o=setTimeout}if(typeof n.clearTimeout==="function"){a=clearTimeout}function u(t){if(o===setTimeout){return setTimeout(t,0)}if((o===i||!o)&&setTimeout){o=setTimeout;return setTimeout(t,0)}try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}function f(t){if(a===clearTimeout){return clearTimeout(t)}if((a===s||!a)&&clearTimeout){a=clearTimeout;return clearTimeout(t)}try{return a(t)}catch(e){try{return a.call(null,t)}catch(e){return a.call(this,t)}}}var c=[];var l=false;var h;var d=-1;function m(){if(!l||!h){return}l=false;if(h.length){c=h.concat(c)}else{d=-1}if(c.length){w()}}function w(){if(l){return}var t=u(m);l=true;var e=c.length;while(e){h=c;c=[];while(++d<e){if(h){h[d].run()}}d=-1;e=c.length}h=null;l=false;f(t)}function v(t){var e=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){e[r-1]=arguments[r]}}c.push(new y(t,e));if(c.length===1&&!l){u(w)}}function y(t,e){this.fun=t;this.array=e}y.prototype.run=function(){this.fun.apply(null,this.array)};var b="browser";var p="browser";var E=true;var g={};var P=[];var S="";var T={};var $={};var k={};function O(){}var _=O;var A=O;var R=O;var D=O;var N=O;var j=O;var I=O;function M(t){throw new Error("process.binding is not supported")}function C(){return"/"}function L(t){throw new Error("process.chdir is not supported")}function x(){return 0}var B=n.performance||{};var F=B.now||B.mozNow||B.msNow||B.oNow||B.webkitNow||function(){return(new Date).getTime()};function U(t){var e=F.call(B)*.001;var r=Math.floor(e);var n=Math.floor(e%1*1e9);if(t){r=r-t[0];n=n-t[1];if(n<0){r--;n+=1e9}}return[r,n]}var q=new Date;function W(){var t=new Date;var e=t-q;return e/1e3}var G={nextTick:v,title:b,browser:E,env:g,argv:P,version:S,versions:T,on:_,addListener:A,once:R,off:D,removeListener:N,removeAllListeners:j,emit:I,binding:M,cwd:C,chdir:L,umask:x,hrtime:U,platform:p,release:$,config:k,uptime:W};const z="/Volumes/Development_Lacie/Development/new/jeep-sqlite/node_modules/sql.js/dist";var H=[];var V=[];var Q=typeof Uint8Array!=="undefined"?Uint8Array:Array;var K=false;function Z(){K=true;var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var e=0,r=t.length;e<r;++e){H[e]=t[e];V[t.charCodeAt(e)]=e}V["-".charCodeAt(0)]=62;V["_".charCodeAt(0)]=63}function J(t){if(!K){Z()}var e,r,n,i,s,o;var a=t.length;if(a%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}s=t[a-2]==="="?2:t[a-1]==="="?1:0;o=new Q(a*3/4-s);n=s>0?a-4:a;var u=0;for(e=0,r=0;e<n;e+=4,r+=3){i=V[t.charCodeAt(e)]<<18|V[t.charCodeAt(e+1)]<<12|V[t.charCodeAt(e+2)]<<6|V[t.charCodeAt(e+3)];o[u++]=i>>16&255;o[u++]=i>>8&255;o[u++]=i&255}if(s===2){i=V[t.charCodeAt(e)]<<2|V[t.charCodeAt(e+1)]>>4;o[u++]=i&255}else if(s===1){i=V[t.charCodeAt(e)]<<10|V[t.charCodeAt(e+1)]<<4|V[t.charCodeAt(e+2)]>>2;o[u++]=i>>8&255;o[u++]=i&255}return o}function X(t){return H[t>>18&63]+H[t>>12&63]+H[t>>6&63]+H[t&63]}function Y(t,e,r){var n;var i=[];for(var s=e;s<r;s+=3){n=(t[s]<<16)+(t[s+1]<<8)+t[s+2];i.push(X(n))}return i.join("")}function tt(t){if(!K){Z()}var e;var r=t.length;var n=r%3;var i="";var s=[];var o=16383;for(var a=0,u=r-n;a<u;a+=o){s.push(Y(t,a,a+o>u?u:a+o))}if(n===1){e=t[r-1];i+=H[e>>2];i+=H[e<<4&63];i+="=="}else if(n===2){e=(t[r-2]<<8)+t[r-1];i+=H[e>>10];i+=H[e>>4&63];i+=H[e<<2&63];i+="="}s.push(i);return s.join("")}function et(t,e,r,n,i){var s,o;var a=i*8-n-1;var u=(1<<a)-1;var f=u>>1;var c=-7;var l=r?i-1:0;var h=r?-1:1;var d=t[e+l];l+=h;s=d&(1<<-c)-1;d>>=-c;c+=a;for(;c>0;s=s*256+t[e+l],l+=h,c-=8){}o=s&(1<<-c)-1;s>>=-c;c+=n;for(;c>0;o=o*256+t[e+l],l+=h,c-=8){}if(s===0){s=1-f}else if(s===u){return o?NaN:(d?-1:1)*Infinity}else{o=o+Math.pow(2,n);s=s-f}return(d?-1:1)*o*Math.pow(2,s-n)}function rt(t,e,r,n,i,s){var o,a,u;var f=s*8-i-1;var c=(1<<f)-1;var l=c>>1;var h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var d=n?0:s-1;var m=n?1:-1;var w=e<0||e===0&&1/e<0?1:0;e=Math.abs(e);if(isNaN(e)||e===Infinity){a=isNaN(e)?1:0;o=c}else{o=Math.floor(Math.log(e)/Math.LN2);if(e*(u=Math.pow(2,-o))<1){o--;u*=2}if(o+l>=1){e+=h/u}else{e+=h*Math.pow(2,1-l)}if(e*u>=2){o++;u/=2}if(o+l>=c){a=0;o=c}else if(o+l>=1){a=(e*u-1)*Math.pow(2,i);o=o+l}else{a=e*Math.pow(2,l-1)*Math.pow(2,i);o=0}}for(;i>=8;t[r+d]=a&255,d+=m,a/=256,i-=8){}o=o<<i|a;f+=i;for(;f>0;t[r+d]=o&255,d+=m,o/=256,f-=8){}t[r+d-m]|=w*128}var nt={}.toString;var it=Array.isArray||function(t){return nt.call(t)=="[object Array]"};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */var st=50;ut.TYPED_ARRAY_SUPPORT=n.TYPED_ARRAY_SUPPORT!==undefined?n.TYPED_ARRAY_SUPPORT:true;function ot(){return ut.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function at(t,e){if(ot()<e){throw new RangeError("Invalid typed array length")}if(ut.TYPED_ARRAY_SUPPORT){t=new Uint8Array(e);t.__proto__=ut.prototype}else{if(t===null){t=new ut(e)}t.length=e}return t}function ut(t,e,r){if(!ut.TYPED_ARRAY_SUPPORT&&!(this instanceof ut)){return new ut(t,e,r)}if(typeof t==="number"){if(typeof e==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return ht(this,t)}return ft(this,t,e,r)}ut.poolSize=8192;ut._augment=function(t){t.__proto__=ut.prototype;return t};function ft(t,e,r,n){if(typeof e==="number"){throw new TypeError('"value" argument must not be a number')}if(typeof ArrayBuffer!=="undefined"&&e instanceof ArrayBuffer){return wt(t,e,r,n)}if(typeof e==="string"){return dt(t,e,r)}return vt(t,e)}ut.from=function(t,e,r){return ft(null,t,e,r)};if(ut.TYPED_ARRAY_SUPPORT){ut.prototype.__proto__=Uint8Array.prototype;ut.__proto__=Uint8Array}function ct(t){if(typeof t!=="number"){throw new TypeError('"size" argument must be a number')}else if(t<0){throw new RangeError('"size" argument must not be negative')}}function lt(t,e,r,n){ct(e);if(e<=0){return at(t,e)}if(r!==undefined){return typeof n==="string"?at(t,e).fill(r,n):at(t,e).fill(r)}return at(t,e)}ut.alloc=function(t,e,r){return lt(null,t,e,r)};function ht(t,e){ct(e);t=at(t,e<0?0:yt(e)|0);if(!ut.TYPED_ARRAY_SUPPORT){for(var r=0;r<e;++r){t[r]=0}}return t}ut.allocUnsafe=function(t){return ht(null,t)};ut.allocUnsafeSlow=function(t){return ht(null,t)};function dt(t,e,r){if(typeof r!=="string"||r===""){r="utf8"}if(!ut.isEncoding(r)){throw new TypeError('"encoding" must be a valid string encoding')}var n=pt(e,r)|0;t=at(t,n);var i=t.write(e,r);if(i!==n){t=t.slice(0,i)}return t}function mt(t,e){var r=e.length<0?0:yt(e.length)|0;t=at(t,r);for(var n=0;n<r;n+=1){t[n]=e[n]&255}return t}function wt(t,e,r,n){if(r<0||e.byteLength<r){throw new RangeError("'offset' is out of bounds")}if(e.byteLength<r+(n||0)){throw new RangeError("'length' is out of bounds")}if(r===undefined&&n===undefined){e=new Uint8Array(e)}else if(n===undefined){e=new Uint8Array(e,r)}else{e=new Uint8Array(e,r,n)}if(ut.TYPED_ARRAY_SUPPORT){t=e;t.__proto__=ut.prototype}else{t=mt(t,e)}return t}function vt(t,e){if(bt(e)){var r=yt(e.length)|0;t=at(t,r);if(t.length===0){return t}e.copy(t,0,0,r);return t}if(e){if(typeof ArrayBuffer!=="undefined"&&e.buffer instanceof ArrayBuffer||"length"in e){if(typeof e.length!=="number"||te(e.length)){return at(t,0)}return mt(t,e)}if(e.type==="Buffer"&&it(e.data)){return mt(t,e.data)}}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function yt(t){if(t>=ot()){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+ot().toString(16)+" bytes")}return t|0}ut.isBuffer=ee;function bt(t){return!!(t!=null&&t._isBuffer)}ut.compare=function t(e,r){if(!bt(e)||!bt(r)){throw new TypeError("Arguments must be Buffers")}if(e===r)return 0;var n=e.length;var i=r.length;for(var s=0,o=Math.min(n,i);s<o;++s){if(e[s]!==r[s]){n=e[s];i=r[s];break}}if(n<i)return-1;if(i<n)return 1;return 0};ut.isEncoding=function t(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};ut.concat=function t(e,r){if(!it(e)){throw new TypeError('"list" argument must be an Array of Buffers')}if(e.length===0){return ut.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<e.length;++n){r+=e[n].length}}var i=ut.allocUnsafe(r);var s=0;for(n=0;n<e.length;++n){var o=e[n];if(!bt(o)){throw new TypeError('"list" argument must be an Array of Buffers')}o.copy(i,s);s+=o.length}return i};function pt(t,e){if(bt(t)){return t.length}if(typeof ArrayBuffer!=="undefined"&&typeof ArrayBuffer.isView==="function"&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)){return t.byteLength}if(typeof t!=="string"){t=""+t}var r=t.length;if(r===0)return 0;var n=false;for(;;){switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return Kt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Xt(t).length;default:if(n)return Kt(t).length;e=(""+e).toLowerCase();n=true}}}ut.byteLength=pt;function Et(t,e,r){var n=false;if(e===undefined||e<0){e=0}if(e>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;e>>>=0;if(r<=e){return""}if(!t)t="utf8";while(true){switch(t){case"hex":return Ct(this,e,r);case"utf8":case"utf-8":return Dt(this,e,r);case"ascii":return It(this,e,r);case"latin1":case"binary":return Mt(this,e,r);case"base64":return Rt(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lt(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase();n=true}}}ut.prototype._isBuffer=true;function gt(t,e,r){var n=t[e];t[e]=t[r];t[r]=n}ut.prototype.swap16=function t(){var e=this.length;if(e%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<e;r+=2){gt(this,r,r+1)}return this};ut.prototype.swap32=function t(){var e=this.length;if(e%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<e;r+=4){gt(this,r,r+3);gt(this,r+1,r+2)}return this};ut.prototype.swap64=function t(){var e=this.length;if(e%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<e;r+=8){gt(this,r,r+7);gt(this,r+1,r+6);gt(this,r+2,r+5);gt(this,r+3,r+4)}return this};ut.prototype.toString=function t(){var e=this.length|0;if(e===0)return"";if(arguments.length===0)return Dt(this,0,e);return Et.apply(this,arguments)};ut.prototype.equals=function t(e){if(!bt(e))throw new TypeError("Argument must be a Buffer");if(this===e)return true;return ut.compare(this,e)===0};ut.prototype.inspect=function t(){var e="";var r=st;if(this.length>0){e=this.toString("hex",0,r).match(/.{2}/g).join(" ");if(this.length>r)e+=" ... "}return"<Buffer "+e+">"};ut.prototype.compare=function t(e,r,n,i,s){if(!bt(e)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=e?e.length:0}if(i===undefined){i=0}if(s===undefined){s=this.length}if(r<0||n>e.length||i<0||s>this.length){throw new RangeError("out of range index")}if(i>=s&&r>=n){return 0}if(i>=s){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;s>>>=0;if(this===e)return 0;var o=s-i;var a=n-r;var u=Math.min(o,a);var f=this.slice(i,s);var c=e.slice(r,n);for(var l=0;l<u;++l){if(f[l]!==c[l]){o=f[l];a=c[l];break}}if(o<a)return-1;if(a<o)return 1;return 0};function Pt(t,e,r,n,i){if(t.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(isNaN(r)){r=i?0:t.length-1}if(r<0)r=t.length+r;if(r>=t.length){if(i)return-1;else r=t.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof e==="string"){e=ut.from(e,n)}if(bt(e)){if(e.length===0){return-1}return St(t,e,r,n,i)}else if(typeof e==="number"){e=e&255;if(ut.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(t,e,r)}else{return Uint8Array.prototype.lastIndexOf.call(t,e,r)}}return St(t,[e],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function St(t,e,r,n,i){var s=1;var o=t.length;var a=e.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(t.length<2||e.length<2){return-1}s=2;o/=2;a/=2;r/=2}}function u(t,e){if(s===1){return t[e]}else{return t.readUInt16BE(e*s)}}var f;if(i){var c=-1;for(f=r;f<o;f++){if(u(t,f)===u(e,c===-1?0:f-c)){if(c===-1)c=f;if(f-c+1===a)return c*s}else{if(c!==-1)f-=f-c;c=-1}}}else{if(r+a>o)r=o-a;for(f=r;f>=0;f--){var l=true;for(var h=0;h<a;h++){if(u(t,f+h)!==u(e,h)){l=false;break}}if(l)return f}}return-1}ut.prototype.includes=function t(e,r,n){return this.indexOf(e,r,n)!==-1};ut.prototype.indexOf=function t(e,r,n){return Pt(this,e,r,n,true)};ut.prototype.lastIndexOf=function t(e,r,n){return Pt(this,e,r,n,false)};function Tt(t,e,r,n){r=Number(r)||0;var i=t.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var s=e.length;if(s%2!==0)throw new TypeError("Invalid hex string");if(n>s/2){n=s/2}for(var o=0;o<n;++o){var a=parseInt(e.substr(o*2,2),16);if(isNaN(a))return o;t[r+o]=a}return o}function $t(t,e,r,n){return Yt(Kt(e,t.length-r),t,r,n)}function kt(t,e,r,n){return Yt(Zt(e),t,r,n)}function Ot(t,e,r,n){return kt(t,e,r,n)}function _t(t,e,r,n){return Yt(Xt(e),t,r,n)}function At(t,e,r,n){return Yt(Jt(e,t.length-r),t,r,n)}ut.prototype.write=function t(e,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r|0;if(isFinite(n)){n=n|0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var s=this.length-r;if(n===undefined||n>s)n=s;if(e.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var o=false;for(;;){switch(i){case"hex":return Tt(this,e,r,n);case"utf8":case"utf-8":return $t(this,e,r,n);case"ascii":return kt(this,e,r,n);case"latin1":case"binary":return Ot(this,e,r,n);case"base64":return _t(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return At(this,e,r,n);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();o=true}}};ut.prototype.toJSON=function t(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Rt(t,e,r){if(e===0&&r===t.length){return tt(t)}else{return tt(t.slice(e,r))}}function Dt(t,e,r){r=Math.min(t.length,r);var n=[];var i=e;while(i<r){var s=t[i];var o=null;var a=s>239?4:s>223?3:s>191?2:1;if(i+a<=r){var u,f,c,l;switch(a){case 1:if(s<128){o=s}break;case 2:u=t[i+1];if((u&192)===128){l=(s&31)<<6|u&63;if(l>127){o=l}}break;case 3:u=t[i+1];f=t[i+2];if((u&192)===128&&(f&192)===128){l=(s&15)<<12|(u&63)<<6|f&63;if(l>2047&&(l<55296||l>57343)){o=l}}break;case 4:u=t[i+1];f=t[i+2];c=t[i+3];if((u&192)===128&&(f&192)===128&&(c&192)===128){l=(s&15)<<18|(u&63)<<12|(f&63)<<6|c&63;if(l>65535&&l<1114112){o=l}}}}if(o===null){o=65533;a=1}else if(o>65535){o-=65536;n.push(o>>>10&1023|55296);o=56320|o&1023}n.push(o);i+=a}return jt(n)}var Nt=4096;function jt(t){var e=t.length;if(e<=Nt){return String.fromCharCode.apply(String,t)}var r="";var n=0;while(n<e){r+=String.fromCharCode.apply(String,t.slice(n,n+=Nt))}return r}function It(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i){n+=String.fromCharCode(t[i]&127)}return n}function Mt(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i){n+=String.fromCharCode(t[i])}return n}function Ct(t,e,r){var n=t.length;if(!e||e<0)e=0;if(!r||r<0||r>n)r=n;var i="";for(var s=e;s<r;++s){i+=Qt(t[s])}return i}function Lt(t,e,r){var n=t.slice(e,r);var i="";for(var s=0;s<n.length;s+=2){i+=String.fromCharCode(n[s]+n[s+1]*256)}return i}ut.prototype.slice=function t(e,r){var n=this.length;e=~~e;r=r===undefined?n:~~r;if(e<0){e+=n;if(e<0)e=0}else if(e>n){e=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<e)r=e;var i;if(ut.TYPED_ARRAY_SUPPORT){i=this.subarray(e,r);i.__proto__=ut.prototype}else{var s=r-e;i=new ut(s,undefined);for(var o=0;o<s;++o){i[o]=this[o+e]}}return i};function xt(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}ut.prototype.readUIntLE=function t(e,r,n){e=e|0;r=r|0;if(!n)xt(e,r,this.length);var i=this[e];var s=1;var o=0;while(++o<r&&(s*=256)){i+=this[e+o]*s}return i};ut.prototype.readUIntBE=function t(e,r,n){e=e|0;r=r|0;if(!n){xt(e,r,this.length)}var i=this[e+--r];var s=1;while(r>0&&(s*=256)){i+=this[e+--r]*s}return i};ut.prototype.readUInt8=function t(e,r){if(!r)xt(e,1,this.length);return this[e]};ut.prototype.readUInt16LE=function t(e,r){if(!r)xt(e,2,this.length);return this[e]|this[e+1]<<8};ut.prototype.readUInt16BE=function t(e,r){if(!r)xt(e,2,this.length);return this[e]<<8|this[e+1]};ut.prototype.readUInt32LE=function t(e,r){if(!r)xt(e,4,this.length);return(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};ut.prototype.readUInt32BE=function t(e,r){if(!r)xt(e,4,this.length);return this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};ut.prototype.readIntLE=function t(e,r,n){e=e|0;r=r|0;if(!n)xt(e,r,this.length);var i=this[e];var s=1;var o=0;while(++o<r&&(s*=256)){i+=this[e+o]*s}s*=128;if(i>=s)i-=Math.pow(2,8*r);return i};ut.prototype.readIntBE=function t(e,r,n){e=e|0;r=r|0;if(!n)xt(e,r,this.length);var i=r;var s=1;var o=this[e+--i];while(i>0&&(s*=256)){o+=this[e+--i]*s}s*=128;if(o>=s)o-=Math.pow(2,8*r);return o};ut.prototype.readInt8=function t(e,r){if(!r)xt(e,1,this.length);if(!(this[e]&128))return this[e];return(255-this[e]+1)*-1};ut.prototype.readInt16LE=function t(e,r){if(!r)xt(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};ut.prototype.readInt16BE=function t(e,r){if(!r)xt(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};ut.prototype.readInt32LE=function t(e,r){if(!r)xt(e,4,this.length);return this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};ut.prototype.readInt32BE=function t(e,r){if(!r)xt(e,4,this.length);return this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};ut.prototype.readFloatLE=function t(e,r){if(!r)xt(e,4,this.length);return et(this,e,true,23,4)};ut.prototype.readFloatBE=function t(e,r){if(!r)xt(e,4,this.length);return et(this,e,false,23,4)};ut.prototype.readDoubleLE=function t(e,r){if(!r)xt(e,8,this.length);return et(this,e,true,52,8)};ut.prototype.readDoubleBE=function t(e,r){if(!r)xt(e,8,this.length);return et(this,e,false,52,8)};function Bt(t,e,r,n,i,s){if(!bt(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}ut.prototype.writeUIntLE=function t(e,r,n,i){e=+e;r=r|0;n=n|0;if(!i){var s=Math.pow(2,8*n)-1;Bt(this,e,r,n,s,0)}var o=1;var a=0;this[r]=e&255;while(++a<n&&(o*=256)){this[r+a]=e/o&255}return r+n};ut.prototype.writeUIntBE=function t(e,r,n,i){e=+e;r=r|0;n=n|0;if(!i){var s=Math.pow(2,8*n)-1;Bt(this,e,r,n,s,0)}var o=n-1;var a=1;this[r+o]=e&255;while(--o>=0&&(a*=256)){this[r+o]=e/a&255}return r+n};ut.prototype.writeUInt8=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,1,255,0);if(!ut.TYPED_ARRAY_SUPPORT)e=Math.floor(e);this[r]=e&255;return r+1};function Ft(t,e,r,n){if(e<0)e=65535+e+1;for(var i=0,s=Math.min(t.length-r,2);i<s;++i){t[r+i]=(e&255<<8*(n?i:1-i))>>>(n?i:1-i)*8}}ut.prototype.writeUInt16LE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,2,65535,0);if(ut.TYPED_ARRAY_SUPPORT){this[r]=e&255;this[r+1]=e>>>8}else{Ft(this,e,r,true)}return r+2};ut.prototype.writeUInt16BE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,2,65535,0);if(ut.TYPED_ARRAY_SUPPORT){this[r]=e>>>8;this[r+1]=e&255}else{Ft(this,e,r,false)}return r+2};function Ut(t,e,r,n){if(e<0)e=4294967295+e+1;for(var i=0,s=Math.min(t.length-r,4);i<s;++i){t[r+i]=e>>>(n?i:3-i)*8&255}}ut.prototype.writeUInt32LE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,4,4294967295,0);if(ut.TYPED_ARRAY_SUPPORT){this[r+3]=e>>>24;this[r+2]=e>>>16;this[r+1]=e>>>8;this[r]=e&255}else{Ut(this,e,r,true)}return r+4};ut.prototype.writeUInt32BE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,4,4294967295,0);if(ut.TYPED_ARRAY_SUPPORT){this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255}else{Ut(this,e,r,false)}return r+4};ut.prototype.writeIntLE=function t(e,r,n,i){e=+e;r=r|0;if(!i){var s=Math.pow(2,8*n-1);Bt(this,e,r,n,s-1,-s)}var o=0;var a=1;var u=0;this[r]=e&255;while(++o<n&&(a*=256)){if(e<0&&u===0&&this[r+o-1]!==0){u=1}this[r+o]=(e/a>>0)-u&255}return r+n};ut.prototype.writeIntBE=function t(e,r,n,i){e=+e;r=r|0;if(!i){var s=Math.pow(2,8*n-1);Bt(this,e,r,n,s-1,-s)}var o=n-1;var a=1;var u=0;this[r+o]=e&255;while(--o>=0&&(a*=256)){if(e<0&&u===0&&this[r+o+1]!==0){u=1}this[r+o]=(e/a>>0)-u&255}return r+n};ut.prototype.writeInt8=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,1,127,-128);if(!ut.TYPED_ARRAY_SUPPORT)e=Math.floor(e);if(e<0)e=255+e+1;this[r]=e&255;return r+1};ut.prototype.writeInt16LE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,2,32767,-32768);if(ut.TYPED_ARRAY_SUPPORT){this[r]=e&255;this[r+1]=e>>>8}else{Ft(this,e,r,true)}return r+2};ut.prototype.writeInt16BE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,2,32767,-32768);if(ut.TYPED_ARRAY_SUPPORT){this[r]=e>>>8;this[r+1]=e&255}else{Ft(this,e,r,false)}return r+2};ut.prototype.writeInt32LE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,4,2147483647,-2147483648);if(ut.TYPED_ARRAY_SUPPORT){this[r]=e&255;this[r+1]=e>>>8;this[r+2]=e>>>16;this[r+3]=e>>>24}else{Ut(this,e,r,true)}return r+4};ut.prototype.writeInt32BE=function t(e,r,n){e=+e;r=r|0;if(!n)Bt(this,e,r,4,2147483647,-2147483648);if(e<0)e=4294967295+e+1;if(ut.TYPED_ARRAY_SUPPORT){this[r]=e>>>24;this[r+1]=e>>>16;this[r+2]=e>>>8;this[r+3]=e&255}else{Ut(this,e,r,false)}return r+4};function qt(t,e,r,n,i,s){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function Wt(t,e,r,n,i){if(!i){qt(t,e,r,4)}rt(t,e,r,n,23,4);return r+4}ut.prototype.writeFloatLE=function t(e,r,n){return Wt(this,e,r,true,n)};ut.prototype.writeFloatBE=function t(e,r,n){return Wt(this,e,r,false,n)};function Gt(t,e,r,n,i){if(!i){qt(t,e,r,8)}rt(t,e,r,n,52,8);return r+8}ut.prototype.writeDoubleLE=function t(e,r,n){return Gt(this,e,r,true,n)};ut.prototype.writeDoubleBE=function t(e,r,n){return Gt(this,e,r,false,n)};ut.prototype.copy=function t(e,r,n,i){if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=e.length)r=e.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(e.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(e.length-r<i-n){i=e.length-r+n}var s=i-n;var o;if(this===e&&n<r&&r<i){for(o=s-1;o>=0;--o){e[o+r]=this[o+n]}}else if(s<1e3||!ut.TYPED_ARRAY_SUPPORT){for(o=0;o<s;++o){e[o+r]=this[o+n]}}else{Uint8Array.prototype.set.call(e,this.subarray(n,n+s),r)}return s};ut.prototype.fill=function t(e,r,n,i){if(typeof e==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(e.length===1){var s=e.charCodeAt(0);if(s<256){e=s}}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!ut.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}}else if(typeof e==="number"){e=e&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!e)e=0;var o;if(typeof e==="number"){for(o=r;o<n;++o){this[o]=e}}else{var a=bt(e)?e:Kt(new ut(e,i).toString());var u=a.length;for(o=0;o<n-r;++o){this[o+r]=a[o%u]}}return this};var zt=/[^+\/0-9A-Za-z-_]/g;function Ht(t){t=Vt(t).replace(zt,"");if(t.length<2)return"";while(t.length%4!==0){t=t+"="}return t}function Vt(t){if(t.trim)return t.trim();return t.replace(/^\s+|\s+$/g,"")}function Qt(t){if(t<16)return"0"+t.toString(16);return t.toString(16)}function Kt(t,e){e=e||Infinity;var r;var n=t.length;var i=null;var s=[];for(var o=0;o<n;++o){r=t.charCodeAt(o);if(r>55295&&r<57344){if(!i){if(r>56319){if((e-=3)>-1)s.push(239,191,189);continue}else if(o+1===n){if((e-=3)>-1)s.push(239,191,189);continue}i=r;continue}if(r<56320){if((e-=3)>-1)s.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((e-=3)>-1)s.push(239,191,189)}i=null;if(r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return s}function Zt(t){var e=[];for(var r=0;r<t.length;++r){e.push(t.charCodeAt(r)&255)}return e}function Jt(t,e){var r,n,i;var s=[];for(var o=0;o<t.length;++o){if((e-=2)<0)break;r=t.charCodeAt(o);n=r>>8;i=r%256;s.push(i);s.push(n)}return s}function Xt(t){return J(Ht(t))}function Yt(t,e,r,n){for(var i=0;i<n;++i){if(i+r>=e.length||i>=t.length)break;e[i+r]=t[i]}return i}function te(t){return t!==t}function ee(t){return t!=null&&(!!t._isBuffer||re(t)||ne(t))}function re(t){return!!t.constructor&&typeof t.constructor.isBuffer==="function"&&t.constructor.isBuffer(t)}function ne(t){return typeof t.readFloatLE==="function"&&typeof t.slice==="function"&&re(t.slice(0,0))}var ie=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};function se(t,e,r){return r={path:e,exports:{},require:function(t,e){return ae()}},t(r,r.exports),r.exports}function oe(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:true});Object.keys(t).forEach((function(r){var n=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(e,r,n.get?n:{enumerable:true,get:function(){return t[r]}})}));return e}function ae(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}function ue(t,e){var r=0;for(var n=t.length-1;n>=0;n--){var i=t[n];if(i==="."){t.splice(n,1)}else if(i===".."){t.splice(n,1);r++}else if(r){t.splice(n,1);r--}}if(e){for(;r--;r){t.unshift("..")}}return t}var fe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;var ce=function(t){return fe.exec(t).slice(1)};function le(){var t="",e=false;for(var r=arguments.length-1;r>=-1&&!e;r--){var n=r>=0?arguments[r]:"/";if(typeof n!=="string"){throw new TypeError("Arguments to path.resolve must be strings")}else if(!n){continue}t=n+"/"+t;e=n.charAt(0)==="/"}t=ue(Pe(t.split("/"),(function(t){return!!t})),!e).join("/");return(e?"/":"")+t||"."}function he(t){var e=de(t),r=Se(t,-1)==="/";t=ue(Pe(t.split("/"),(function(t){return!!t})),!e).join("/");if(!t&&!e){t="."}if(t&&r){t+="/"}return(e?"/":"")+t}function de(t){return t.charAt(0)==="/"}function me(){var t=Array.prototype.slice.call(arguments,0);return he(Pe(t,(function(t,e){if(typeof t!=="string"){throw new TypeError("Arguments to path.join must be strings")}return t})).join("/"))}function we(t,e){t=le(t).substr(1);e=le(e).substr(1);function r(t){var e=0;for(;e<t.length;e++){if(t[e]!=="")break}var r=t.length-1;for(;r>=0;r--){if(t[r]!=="")break}if(e>r)return[];return t.slice(e,r-e+1)}var n=r(t.split("/"));var i=r(e.split("/"));var s=Math.min(n.length,i.length);var o=s;for(var a=0;a<s;a++){if(n[a]!==i[a]){o=a;break}}var u=[];for(var a=o;a<n.length;a++){u.push("..")}u=u.concat(i.slice(o));return u.join("/")}var ve="/";var ye=":";function be(t){var e=ce(t),r=e[0],n=e[1];if(!r&&!n){return"."}if(n){n=n.substr(0,n.length-1)}return r+n}function pe(t,e){var r=ce(t)[2];if(e&&r.substr(-1*e.length)===e){r=r.substr(0,r.length-e.length)}return r}function Ee(t){return ce(t)[3]}const ge={extname:Ee,basename:pe,dirname:be,sep:ve,delimiter:ye,relative:we,join:me,isAbsolute:de,normalize:he,resolve:le};function Pe(t,e){if(t.filter)return t.filter(e);var r=[];for(var n=0;n<t.length;n++){if(e(t[n],n,t))r.push(t[n])}return r}var Se="ab".substr(-1)==="b"?function(t,e,r){return t.substr(e,r)}:function(t,e,r){if(e<0)e=t.length+e;return t.substr(e,r)};const Te=Object.freeze({__proto__:null,resolve:le,normalize:he,isAbsolute:de,join:me,relative:we,sep:ve,delimiter:ye,dirname:be,basename:pe,extname:Ee,default:ge});const $e={};const ke=Object.freeze({__proto__:null,default:$e});const Oe=oe(Te);const _e=oe(ke);var Ae=se((function(t,e){var r=undefined;var n=function(e){if(r){return r}r=new Promise((function(r,n){var i=typeof e!=="undefined"?e:{};var s=i["onAbort"];i["onAbort"]=function(t){n(new Error(t));if(s){s(t)}};i["postRun"]=i["postRun"]||[];i["postRun"].push((function(){r(i)}));t=undefined;var o;o||(o=typeof i!=="undefined"?i:{});o.onRuntimeInitialized=function(){function t(t,e){switch(typeof e){case"boolean":K(t,e?1:0);break;case"number":z(t,e);break;case"string":V(t,e,-1,-1);break;case"object":if(null===e)H(t);else if(null!=e.length){var r=Ne(e);Q(t,r,e.length,-1);xe(r)}else Z(t,"Wrong API use : tried to return a value of an unknown type ("+e+").",-1);break;default:H(t)}}function e(t,e){for(var r=[],n=0;n<t;n+=1){var i=rt(e+4*n,"i32"),s=F(i);if(1===s||2===s)i=G(i);else if(3===s)i=q(i);else if(4===s){s=i;i=U(s);s=W(s);for(var o=new Uint8Array(i),a=0;a<i;a+=1)o[a]=R[s+a];i=o}else i=null;r.push(i)}return r}function r(t,e){this.La=t;this.db=e;this.Ja=1;this.fb=[]}function n(t,e){this.db=e;e=_(t)+1;this.Ya=Le(e);if(null===this.Ya)throw Error("Unable to allocate memory for the SQL string");O(t,D,this.Ya,e);this.eb=this.Ya;this.Ua=this.ib=null}function i(t){this.filename="dbfile_"+(4294967295*Math.random()>>>0);if(null!=t){var e=this.filename,r="/",n=e;r&&(r="string"==typeof r?r:Ot(r),n=e?st(r+"/"+e):r);e=ae(!0,!0);n=qt(n,(void 0!==e?e:438)&4095|32768,0);if(t){if("string"==typeof t){r=Array(t.length);for(var i=0,o=t.length;i<o;++i)r[i]=t.charCodeAt(i);t=r}Jt(n,e|146);r=Yt(n,577);ne(r,t,0,t.length,0);te(r);Jt(n,e)}}this.handleError(u(this.filename,s));this.db=rt(s,"i32");X(this.db);this.Za={};this.Na={}}var s=qe(4),a=o.cwrap,u=a("sqlite3_open","number",["string","number"]),f=a("sqlite3_close_v2","number",["number"]),c=a("sqlite3_exec","number",["number","string","number","number","number"]),l=a("sqlite3_changes","number",["number"]),h=a("sqlite3_prepare_v2","number",["number","string","number","number","number"]),d=a("sqlite3_sql","string",["number"]),m=a("sqlite3_normalized_sql","string",["number"]),w=a("sqlite3_prepare_v2","number",["number","number","number","number","number"]),v=a("sqlite3_bind_text","number",["number","number","number","number","number"]),y=a("sqlite3_bind_blob","number",["number","number","number","number","number"]),b=a("sqlite3_bind_double","number",["number","number","number"]),p=a("sqlite3_bind_int","number",["number","number","number"]),E=a("sqlite3_bind_parameter_index","number",["number","string"]),g=a("sqlite3_step","number",["number"]),P=a("sqlite3_errmsg","string",["number"]),S=a("sqlite3_column_count","number",["number"]),T=a("sqlite3_data_count","number",["number"]),$=a("sqlite3_column_double","number",["number","number"]),A=a("sqlite3_column_text","string",["number","number"]),N=a("sqlite3_column_blob","number",["number","number"]),j=a("sqlite3_column_bytes","number",["number","number"]),I=a("sqlite3_column_type","number",["number","number"]),M=a("sqlite3_column_name","string",["number","number"]),C=a("sqlite3_reset","number",["number"]),L=a("sqlite3_clear_bindings","number",["number"]),x=a("sqlite3_finalize","number",["number"]),B=a("sqlite3_create_function_v2","number","number string number number number number number number number".split(" ")),F=a("sqlite3_value_type","number",["number"]),U=a("sqlite3_value_bytes","number",["number"]),q=a("sqlite3_value_text","string",["number"]),W=a("sqlite3_value_blob","number",["number"]),G=a("sqlite3_value_double","number",["number"]),z=a("sqlite3_result_double","",["number","number"]),H=a("sqlite3_result_null","",["number"]),V=a("sqlite3_result_text","",["number","string","number","number"]),Q=a("sqlite3_result_blob","",["number","number","number","number"]),K=a("sqlite3_result_int","",["number","number"]),Z=a("sqlite3_result_error","",["number","string","number"]),J=a("sqlite3_aggregate_context","number",["number","number"]),X=a("RegisterExtensionFunctions","number",["number"]);r.prototype.bind=function(t){if(!this.La)throw"Statement closed";this.reset();return Array.isArray(t)?this.xb(t):null!=t&&"object"===typeof t?this.yb(t):!0};r.prototype.step=function(){if(!this.La)throw"Statement closed";this.Ja=1;var t=g(this.La);switch(t){case 100:return!0;case 101:return!1;default:throw this.db.handleError(t)}};r.prototype.sb=function(t){null==t&&(t=this.Ja,this.Ja+=1);return $(this.La,t)};r.prototype.Cb=function(t){null==t&&(t=this.Ja,this.Ja+=1);t=A(this.La,t);if("function"!==typeof BigInt)throw Error("BigInt is not supported");return BigInt(t)};r.prototype.Db=function(t){null==t&&(t=this.Ja,this.Ja+=1);return A(this.La,t)};r.prototype.getBlob=function(t){null==t&&(t=this.Ja,this.Ja+=1);var e=j(this.La,t);t=N(this.La,t);for(var r=new Uint8Array(e),n=0;n<e;n+=1)r[n]=R[t+n];return r};r.prototype.get=function(t,e){e=e||{};null!=t&&this.bind(t)&&this.step();t=[];for(var r=T(this.La),n=0;n<r;n+=1)switch(I(this.La,n)){case 1:var i=e.useBigInt?this.Cb(n):this.sb(n);t.push(i);break;case 2:t.push(this.sb(n));break;case 3:t.push(this.Db(n));break;case 4:t.push(this.getBlob(n));break;default:t.push(null)}return t};r.prototype.getColumnNames=function(){for(var t=[],e=S(this.La),r=0;r<e;r+=1)t.push(M(this.La,r));return t};r.prototype.getAsObject=function(t,e){t=this.get(t,e);e=this.getColumnNames();for(var r={},n=0;n<e.length;n+=1)r[e[n]]=t[n];return r};r.prototype.getSQL=function(){return d(this.La)};r.prototype.getNormalizedSQL=function(){return m(this.La)};r.prototype.run=function(t){null!=t&&this.bind(t);this.step();return this.reset()};r.prototype.nb=function(t,e){null==e&&(e=this.Ja,this.Ja+=1);t=lt(t);var r=Ne(t);this.fb.push(r);this.db.handleError(v(this.La,e,r,t.length-1,0))};r.prototype.wb=function(t,e){null==e&&(e=this.Ja,this.Ja+=1);var r=Ne(t);this.fb.push(r);this.db.handleError(y(this.La,e,r,t.length,0))};r.prototype.mb=function(t,e){null==e&&(e=this.Ja,this.Ja+=1);this.db.handleError((t===(t|0)?p:b)(this.La,e,t))};r.prototype.zb=function(t){null==t&&(t=this.Ja,this.Ja+=1);y(this.La,t,0,0,0)};r.prototype.ob=function(t,e){null==e&&(e=this.Ja,this.Ja+=1);switch(typeof t){case"string":this.nb(t,e);return;case"number":this.mb(t,e);return;case"bigint":this.nb(t.toString(),e);return;case"boolean":this.mb(t+0,e);return;case"object":if(null===t){this.zb(e);return}if(null!=t.length){this.wb(t,e);return}}throw"Wrong API use : tried to bind a value of an unknown type ("+t+")."};r.prototype.yb=function(t){var e=this;Object.keys(t).forEach((function(r){var n=E(e.La,r);0!==n&&e.ob(t[r],n)}));return!0};r.prototype.xb=function(t){for(var e=0;e<t.length;e+=1)this.ob(t[e],e+1);return!0};r.prototype.reset=function(){this.freemem();return 0===L(this.La)&&0===C(this.La)};r.prototype.freemem=function(){for(var t;void 0!==(t=this.fb.pop());)xe(t)};r.prototype.free=function(){this.freemem();var t=0===x(this.La);delete this.db.Za[this.La];this.La=0;return t};n.prototype.next=function(){if(null===this.Ya)return{done:!0};null!==this.Ua&&(this.Ua.free(),this.Ua=null);if(!this.db.db)throw this.gb(),Error("Database closed");var t=Fe(),e=qe(4);nt(s);nt(e);try{this.db.handleError(w(this.db.db,this.eb,-1,s,e));this.eb=rt(e,"i32");var n=rt(s,"i32");if(0===n)return this.gb(),{done:!0};this.Ua=new r(n,this.db);this.db.Za[n]=this.Ua;return{value:this.Ua,done:!1}}catch(t){throw this.ib=k(this.eb),this.gb(),t}finally{Ue(t)}};n.prototype.gb=function(){xe(this.Ya);this.Ya=null};n.prototype.getRemainingSQL=function(){return null!==this.ib?this.ib:k(this.eb)};"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator&&(n.prototype[Symbol.iterator]=function(){return this});i.prototype.run=function(t,e){if(!this.db)throw"Database closed";if(e){t=this.prepare(t,e);try{t.step()}finally{t.free()}}else this.handleError(c(this.db,t,0,0,s));return this};i.prototype.exec=function(t,e,n){if(!this.db)throw"Database closed";var i=Fe(),o=null;try{var a=_(t)+1,u=qe(a);O(t,R,u,a);var f=u;var c=qe(4);for(t=[];0!==rt(f,"i8");){nt(s);nt(c);this.handleError(w(this.db,f,-1,s,c));var l=rt(s,"i32");f=rt(c,"i32");if(0!==l){a=null;o=new r(l,this);for(null!=e&&o.bind(e);o.step();)null===a&&(a={columns:o.getColumnNames(),values:[]},t.push(a)),a.values.push(o.get(null,n));o.free()}}return t}catch(t){throw o&&o.free(),t}finally{Ue(i)}};i.prototype.each=function(t,e,r,n,i){"function"===typeof e&&(n=r,r=e,e=void 0);t=this.prepare(t,e);try{for(;t.step();)r(t.getAsObject(null,i))}finally{t.free()}if("function"===typeof n)return n()};i.prototype.prepare=function(t,e){nt(s);this.handleError(h(this.db,t,-1,s,0));t=rt(s,"i32");if(0===t)throw"Nothing to prepare";var n=new r(t,this);null!=e&&n.bind(e);return this.Za[t]=n};i.prototype.iterateStatements=function(t){return new n(t,this)};i.prototype["export"]=function(){Object.values(this.Za).forEach((function(t){t.free()}));Object.values(this.Na).forEach(De);this.Na={};this.handleError(f(this.db));var t=ie(this.filename);this.handleError(u(this.filename,s));this.db=rt(s,"i32");return t};i.prototype.close=function(){null!==this.db&&(Object.values(this.Za).forEach((function(t){t.free()})),Object.values(this.Na).forEach(De),this.Na={},this.handleError(f(this.db)),Vt("/"+this.filename),this.db=null)};i.prototype.handleError=function(t){if(0===t)return null;t=P(this.db);throw Error(t)};i.prototype.getRowsModified=function(){return l(this.db)};i.prototype.create_function=function(r,n){Object.prototype.hasOwnProperty.call(this.Na,r)&&(De(this.Na[r]),delete this.Na[r]);var i=Re((function(r,i,s){i=e(i,s);try{var o=n.apply(null,i)}catch(t){Z(r,t,-1);return}t(r,o)}),"viii");this.Na[r]=i;this.handleError(B(this.db,r,n.length,1,0,i,0,0,0));return this};i.prototype.create_aggregate=function(r,n){var i=n.init||function(){return null},s=n.finalize||function(t){return t},o=n.step;if(!o)throw"An aggregate function must have a step function in "+r;var a={};Object.hasOwnProperty.call(this.Na,r)&&(De(this.Na[r]),delete this.Na[r]);n=r+"__finalize";Object.hasOwnProperty.call(this.Na,n)&&(De(this.Na[n]),delete this.Na[n]);var u=Re((function(t,r,n){var s=J(t,1);Object.hasOwnProperty.call(a,s)||(a[s]=i());r=e(r,n);r=[a[s]].concat(r);try{a[s]=o.apply(null,r)}catch(e){delete a[s],Z(t,e,-1)}}),"viii"),f=Re((function(e){var r=J(e,1);try{var n=s(a[r])}catch(t){delete a[r];Z(e,t,-1);return}t(e,n);delete a[r]}),"vi");this.Na[r]=u;this.Na[n]=f;this.handleError(B(this.db,r,o.length-1,1,0,0,u,f,0));return this};o.Database=i};var a=Object.assign({},o),u="./this.program",f="object"==typeof window,c="function"==typeof importScripts,l="object"==typeof G&&"object"==typeof G.versions&&"string"==typeof G.versions.node,h="",d,m,w,v,y,b;if(l)h=c?Oe.dirname(h)+"/":z+"/",b=()=>{y||(v=_e,y=Oe)},d=function(t,e){b();t=y.normalize(t);return v.readFileSync(t,e?void 0:"utf8")},w=t=>{t=d(t,!0);t.buffer||(t=new Uint8Array(t));return t},m=(t,e,r)=>{b();t=y.normalize(t);v.readFile(t,(function(t,n){t?r(t):e(n.buffer)}))},1<G.argv.length&&(u=G.argv[1].replace(/\\/g,"/")),G.argv.slice(2),t.exports=o,o.inspect=function(){return"[Emscripten Module object]"};else if(f||c)c?h=self.location.href:"undefined"!=typeof document&&document.currentScript&&(h=document.currentScript.src),h=0!==h.indexOf("blob:")?h.substr(0,h.replace(/[?#].*/,"").lastIndexOf("/")+1):"",d=t=>{var e=new XMLHttpRequest;e.open("GET",t,!1);e.send(null);return e.responseText},c&&(w=t=>{var e=new XMLHttpRequest;e.open("GET",t,!1);e.responseType="arraybuffer";e.send(null);return new Uint8Array(e.response)}),m=(t,e,r)=>{var n=new XMLHttpRequest;n.open("GET",t,!0);n.responseType="arraybuffer";n.onload=()=>{200==n.status||0==n.status&&n.response?e(n.response):r()};n.onerror=r;n.send(null)};var p=o.print||console.log.bind(console),E=o.printErr||console.warn.bind(console);Object.assign(o,a);a=null;o.thisProgram&&(u=o.thisProgram);var g;o.wasmBinary&&(g=o.wasmBinary);"object"!=typeof WebAssembly&&V("no native wasm support detected");var P,S=!1,T="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function $(t,e,r){var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.buffer&&T)return T.decode(t.subarray(e,r));for(n="";e<r;){var i=t[e++];if(i&128){var s=t[e++]&63;if(192==(i&224))n+=String.fromCharCode((i&31)<<6|s);else{var o=t[e++]&63;i=224==(i&240)?(i&15)<<12|s<<6|o:(i&7)<<18|s<<12|o<<6|t[e++]&63;65536>i?n+=String.fromCharCode(i):(i-=65536,n+=String.fromCharCode(55296|i>>10,56320|i&1023))}}else n+=String.fromCharCode(i)}return n}function k(t,e){return t?$(D,t,e):""}function O(t,e,r,n){if(!(0<n))return 0;var i=r;n=r+n-1;for(var s=0;s<t.length;++s){var o=t.charCodeAt(s);if(55296<=o&&57343>=o){var a=t.charCodeAt(++s);o=65536+((o&1023)<<10)|a&1023}if(127>=o){if(r>=n)break;e[r++]=o}else{if(2047>=o){if(r+1>=n)break;e[r++]=192|o>>6}else{if(65535>=o){if(r+2>=n)break;e[r++]=224|o>>12}else{if(r+3>=n)break;e[r++]=240|o>>18;e[r++]=128|o>>12&63}e[r++]=128|o>>6&63}e[r++]=128|o&63}}e[r]=0;return r-i}function _(t){for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);127>=n?e++:2047>=n?e+=2:55296<=n&&57343>=n?(e+=4,++r):e+=3}return e}var A,R,D,N,j,I,M,C;function L(){var t=P.buffer;A=t;o.HEAP8=R=new Int8Array(t);o.HEAP16=N=new Int16Array(t);o.HEAP32=j=new Int32Array(t);o.HEAPU8=D=new Uint8Array(t);o.HEAPU16=new Uint16Array(t);o.HEAPU32=I=new Uint32Array(t);o.HEAPF32=M=new Float32Array(t);o.HEAPF64=C=new Float64Array(t)}var x,B=[],F=[],U=[];function q(){var t=o.preRun.shift();B.unshift(t)}var W=0,H=null;function V(t){if(o.onAbort)o.onAbort(t);t="Aborted("+t+")";E(t);S=!0;throw new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info.")}function Q(){return K.startsWith("data:application/octet-stream;base64,")}var K;K="sql-wasm.wasm";if(!Q()){var Z=K;K=o.locateFile?o.locateFile(Z,h):h+Z}function J(){var t=K;try{if(t==K&&g)return new Uint8Array(g);if(w)return w(t);throw"both async and sync fetching of the wasm failed"}catch(t){V(t)}}function X(){if(!g&&(f||c)){if("function"==typeof fetch&&!K.startsWith("file://"))return fetch(K,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+K+"'";return t.arrayBuffer()})).catch((function(){return J()}));if(m)return new Promise((function(t,e){m(K,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return J()}))}var Y,tt;function et(t){for(;0<t.length;)t.shift()(o)}function rt(t,e="i8"){e.endsWith("*")&&(e="*");switch(e){case"i1":return R[t>>0];case"i8":return R[t>>0];case"i16":return N[t>>1];case"i32":return j[t>>2];case"i64":return j[t>>2];case"float":return M[t>>2];case"double":return C[t>>3];case"*":return I[t>>2];default:V("invalid type for getValue: "+e)}return null}function nt(t){var e="i32";e.endsWith("*")&&(e="*");switch(e){case"i1":R[t>>0]=0;break;case"i8":R[t>>0]=0;break;case"i16":N[t>>1]=0;break;case"i32":j[t>>2]=0;break;case"i64":tt=[0,(Y=0,1<=+Math.abs(Y)?0<Y?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)];j[t>>2]=tt[0];j[t+4>>2]=tt[1];break;case"float":M[t>>2]=0;break;case"double":C[t>>3]=0;break;case"*":I[t>>2]=0;break;default:V("invalid type for setValue: "+e)}}var it=(t,e)=>{for(var r=0,n=t.length-1;0<=n;n--){var i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r;r--)t.unshift("..");return t},st=t=>{var e="/"===t.charAt(0),r="/"===t.substr(-1);(t=it(t.split("/").filter((t=>!!t)),!e).join("/"))||e||(t=".");t&&r&&(t+="/");return(e?"/":"")+t},ot=t=>{var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);t=e[0];e=e[1];if(!t&&!e)return".";e&&(e=e.substr(0,e.length-1));return t+e},at=t=>{if("/"===t)return"/";t=st(t);t=t.replace(/\/$/,"");var e=t.lastIndexOf("/");return-1===e?t:t.substr(e+1)};function ft(){if("object"==typeof crypto&&"function"==typeof crypto.getRandomValues){var t=new Uint8Array(1);return()=>{crypto.getRandomValues(t);return t[0]}}if(l)try{var e=_e;return()=>e.randomBytes(1)[0]}catch(t){}return()=>V("randomDevice")}function ct(){for(var t="",e=!1,r=arguments.length-1;-1<=r&&!e;r--){e=0<=r?arguments[r]:"/";if("string"!=typeof e)throw new TypeError("Arguments to path.resolve must be strings");if(!e)return"";t=e+"/"+t;e="/"===e.charAt(0)}t=it(t.split("/").filter((t=>!!t)),!e).join("/");return(e?"/":"")+t||"."}function lt(t,e){var r=Array(_(t)+1);t=O(t,r,0,r.length);e&&(r.length=t);return r}var ht=[];function dt(t,e){ht[t]={input:[],output:[],Xa:e};Ft(t,mt)}var mt={open:function(t){var e=ht[t.node.rdev];if(!e)throw new Tt(43);t.tty=e;t.seekable=!1},close:function(t){t.tty.Xa.fsync(t.tty)},fsync:function(t){t.tty.Xa.fsync(t.tty)},read:function(t,e,r,n){if(!t.tty||!t.tty.Xa.tb)throw new Tt(60);for(var i=0,s=0;s<n;s++){try{var o=t.tty.Xa.tb(t.tty)}catch(t){throw new Tt(29)}if(void 0===o&&0===i)throw new Tt(6);if(null===o||void 0===o)break;i++;e[r+s]=o}i&&(t.node.timestamp=Date.now());return i},write:function(t,e,r,n){if(!t.tty||!t.tty.Xa.jb)throw new Tt(60);try{for(var i=0;i<n;i++)t.tty.Xa.jb(t.tty,e[r+i])}catch(t){throw new Tt(29)}n&&(t.node.timestamp=Date.now());return i}},wt={tb:function(t){if(!t.input.length){var e=null;if(l){var r=ut.alloc(256),n=0;try{n=v.readSync(G.stdin.fd,r,0,256,-1)}catch(t){if(t.toString().includes("EOF"))n=0;else throw t}0<n?e=r.slice(0,n).toString("utf-8"):e=null}else"undefined"!=typeof window&&"function"==typeof window.prompt?(e=window.prompt("Input: "),null!==e&&(e+="\n")):"function"==typeof readline&&(e=readline(),null!==e&&(e+="\n"));if(!e)return null;t.input=lt(e,!0)}return t.input.shift()},jb:function(t,e){null===e||10===e?(p($(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},fsync:function(t){t.output&&0<t.output.length&&(p($(t.output,0)),t.output=[])}},vt={jb:function(t,e){null===e||10===e?(E($(t.output,0)),t.output=[]):0!=e&&t.output.push(e)},fsync:function(t){t.output&&0<t.output.length&&(E($(t.output,0)),t.output=[])}},yt={Qa:null,Ra:function(){return yt.createNode(null,"/",16895,0)},createNode:function(t,e,r,n){if(24576===(r&61440)||4096===(r&61440))throw new Tt(63);yt.Qa||(yt.Qa={dir:{node:{Pa:yt.Ga.Pa,Oa:yt.Ga.Oa,lookup:yt.Ga.lookup,ab:yt.Ga.ab,rename:yt.Ga.rename,unlink:yt.Ga.unlink,rmdir:yt.Ga.rmdir,readdir:yt.Ga.readdir,symlink:yt.Ga.symlink},stream:{Ta:yt.Ha.Ta}},file:{node:{Pa:yt.Ga.Pa,Oa:yt.Ga.Oa},stream:{Ta:yt.Ha.Ta,read:yt.Ha.read,write:yt.Ha.write,lb:yt.Ha.lb,bb:yt.Ha.bb,cb:yt.Ha.cb}},link:{node:{Pa:yt.Ga.Pa,Oa:yt.Ga.Oa,readlink:yt.Ga.readlink},stream:{}},pb:{node:{Pa:yt.Ga.Pa,Oa:yt.Ga.Oa},stream:Bt}});r=Dt(t,e,r,n);16384===(r.mode&61440)?(r.Ga=yt.Qa.dir.node,r.Ha=yt.Qa.dir.stream,r.Ia={}):32768===(r.mode&61440)?(r.Ga=yt.Qa.file.node,r.Ha=yt.Qa.file.stream,r.Ma=0,r.Ia=null):40960===(r.mode&61440)?(r.Ga=yt.Qa.link.node,r.Ha=yt.Qa.link.stream):8192===(r.mode&61440)&&(r.Ga=yt.Qa.pb.node,r.Ha=yt.Qa.pb.stream);r.timestamp=Date.now();t&&(t.Ia[e]=r,t.timestamp=r.timestamp);return r},Jb:function(t){return t.Ia?t.Ia.subarray?t.Ia.subarray(0,t.Ma):new Uint8Array(t.Ia):new Uint8Array(0)},qb:function(t,e){var r=t.Ia?t.Ia.length:0;r>=e||(e=Math.max(e,r*(1048576>r?2:1.125)>>>0),0!=r&&(e=Math.max(e,256)),r=t.Ia,t.Ia=new Uint8Array(e),0<t.Ma&&t.Ia.set(r.subarray(0,t.Ma),0))},Gb:function(t,e){if(t.Ma!=e)if(0==e)t.Ia=null,t.Ma=0;else{var r=t.Ia;t.Ia=new Uint8Array(e);r&&t.Ia.set(r.subarray(0,Math.min(e,t.Ma)));t.Ma=e}},Ga:{Pa:function(t){var e={};e.dev=8192===(t.mode&61440)?t.id:1;e.ino=t.id;e.mode=t.mode;e.nlink=1;e.uid=0;e.gid=0;e.rdev=t.rdev;16384===(t.mode&61440)?e.size=4096:32768===(t.mode&61440)?e.size=t.Ma:40960===(t.mode&61440)?e.size=t.link.length:e.size=0;e.atime=new Date(t.timestamp);e.mtime=new Date(t.timestamp);e.ctime=new Date(t.timestamp);e.Ab=4096;e.blocks=Math.ceil(e.size/e.Ab);return e},Oa:function(t,e){void 0!==e.mode&&(t.mode=e.mode);void 0!==e.timestamp&&(t.timestamp=e.timestamp);void 0!==e.size&&yt.Gb(t,e.size)},lookup:function(){throw $t[44]},ab:function(t,e,r,n){return yt.createNode(t,e,r,n)},rename:function(t,e,r){if(16384===(t.mode&61440)){try{var n=Rt(e,r)}catch(t){}if(n)for(var i in n.Ia)throw new Tt(55)}delete t.parent.Ia[t.name];t.parent.timestamp=Date.now();t.name=r;e.Ia[r]=t;e.timestamp=t.parent.timestamp;t.parent=e},unlink:function(t,e){delete t.Ia[e];t.timestamp=Date.now()},rmdir:function(t,e){var r=Rt(t,e),n;for(n in r.Ia)throw new Tt(55);delete t.Ia[e];t.timestamp=Date.now()},readdir:function(t){var e=[".",".."],r;for(r in t.Ia)t.Ia.hasOwnProperty(r)&&e.push(r);return e},symlink:function(t,e,r){t=yt.createNode(t,e,41471,0);t.link=r;return t},readlink:function(t){if(40960!==(t.mode&61440))throw new Tt(28);return t.link}},Ha:{read:function(t,e,r,n,i){var s=t.node.Ia;if(i>=t.node.Ma)return 0;t=Math.min(t.node.Ma-i,n);if(8<t&&s.subarray)e.set(s.subarray(i,i+t),r);else for(n=0;n<t;n++)e[r+n]=s[i+n];return t},write:function(t,e,r,n,i,s){e.buffer===R.buffer&&(s=!1);if(!n)return 0;t=t.node;t.timestamp=Date.now();if(e.subarray&&(!t.Ia||t.Ia.subarray)){if(s)return t.Ia=e.subarray(r,r+n),t.Ma=n;if(0===t.Ma&&0===i)return t.Ia=e.slice(r,r+n),t.Ma=n;if(i+n<=t.Ma)return t.Ia.set(e.subarray(r,r+n),i),n}yt.qb(t,i+n);if(t.Ia.subarray&&e.subarray)t.Ia.set(e.subarray(r,r+n),i);else for(s=0;s<n;s++)t.Ia[i+s]=e[r+s];t.Ma=Math.max(t.Ma,i+n);return n},Ta:function(t,e,r){1===r?e+=t.position:2===r&&32768===(t.node.mode&61440)&&(e+=t.node.Ma);if(0>e)throw new Tt(28);return e},lb:function(t,e,r){yt.qb(t.node,e+r);t.node.Ma=Math.max(t.node.Ma,e+r)},bb:function(t,e,r,n,i){if(32768!==(t.node.mode&61440))throw new Tt(43);t=t.node.Ia;if(i&2||t.buffer!==A){if(0<r||r+e<t.length)t.subarray?t=t.subarray(r,r+e):t=Array.prototype.slice.call(t,r,r+e);r=!0;e=65536*Math.ceil(e/65536);(i=Be(65536,e))?(D.fill(0,i,i+e),e=i):e=0;if(!e)throw new Tt(48);R.set(t,e)}else r=!1,e=t.byteOffset;return{Fb:e,vb:r}},cb:function(t,e,r,n,i){if(32768!==(t.node.mode&61440))throw new Tt(43);if(i&2)return 0;yt.Ha.write(t,e,0,n,r,!1);return 0}}},bt=null,pt={},Et=[],gt=1,Pt=null,St=!0,Tt=null,$t={},kt=(t,e={})=>{t=ct("/",t);if(!t)return{path:"",node:null};e=Object.assign({rb:!0,kb:0},e);if(8<e.kb)throw new Tt(32);t=it(t.split("/").filter((t=>!!t)),!1);for(var r=bt,n="/",i=0;i<t.length;i++){var s=i===t.length-1;if(s&&e.parent)break;r=Rt(r,t[i]);n=st(n+"/"+t[i]);r.Va&&(!s||s&&e.rb)&&(r=r.Va.root);if(!s||e.Sa)for(s=0;40960===(r.mode&61440);)if(r=Qt(n),n=ct(ot(n),r),r=kt(n,{kb:e.kb+1}).node,40<s++)throw new Tt(32)}return{path:n,node:r}},Ot=t=>{for(var e;;){if(t===t.parent)return t=t.Ra.ub,e?"/"!==t[t.length-1]?t+"/"+e:t+e:t;e=e?t.name+"/"+e:t.name;t=t.parent}},_t=(t,e)=>{for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n)|0;return(t+r>>>0)%Pt.length},At=t=>{var e=_t(t.parent.id,t.name);if(Pt[e]===t)Pt[e]=t.Wa;else for(e=Pt[e];e;){if(e.Wa===t){e.Wa=t.Wa;break}e=e.Wa}},Rt=(t,e)=>{var r;if(r=(r=It(t,"x"))?r:t.Ga.lookup?0:2)throw new Tt(r,t);for(r=Pt[_t(t.id,e)];r;r=r.Wa){var n=r.name;if(r.parent.id===t.id&&n===e)return r}return t.Ga.lookup(t,e)},Dt=(t,e,r,n)=>{t=new Ie(t,e,r,n);e=_t(t.parent.id,t.name);t.Wa=Pt[e];return Pt[e]=t},Nt={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},jt=t=>{var e=["r","w","rw"][t&3];t&512&&(e+="w");return e},It=(t,e)=>{if(St)return 0;if(!e.includes("r")||t.mode&292){if(e.includes("w")&&!(t.mode&146)||e.includes("x")&&!(t.mode&73))return 2}else return 2;return 0},Mt=(t,e)=>{try{return Rt(t,e),20}catch(t){}return It(t,"wx")},Ct=(t,e,r)=>{try{var n=Rt(t,e)}catch(t){return t.Ka}if(t=It(t,"wx"))return t;if(r){if(16384!==(n.mode&61440))return 54;if(n===n.parent||"/"===Ot(n))return 10}else if(16384===(n.mode&61440))return 31;return 0},Lt=(t=0)=>{for(;4096>=t;t++)if(!Et[t])return t;throw new Tt(33)},xt=(t,e)=>{le||(le=function(){this.$a={}},le.prototype={},Object.defineProperties(le.prototype,{object:{get:function(){return this.node},set:function(t){this.node=t}},flags:{get:function(){return this.$a.flags},set:function(t){this.$a.flags=t}},position:{get:function(){return this.$a.position},set:function(t){this.$a.position=t}}}));t=Object.assign(new le,t);e=Lt(e);t.fd=e;return Et[e]=t},Bt={open:t=>{t.Ha=pt[t.node.rdev].Ha;t.Ha.open&&t.Ha.open(t)},Ta:()=>{throw new Tt(70)}},Ft=(t,e)=>{pt[t]={Ha:e}},Ut=(t,e)=>{var r="/"===e,n=!e;if(r&&bt)throw new Tt(10);if(!r&&!n){var i=kt(e,{rb:!1});e=i.path;i=i.node;if(i.Va)throw new Tt(10);if(16384!==(i.mode&61440))throw new Tt(54)}e={type:t,Kb:{},ub:e,Eb:[]};t=t.Ra(e);t.Ra=e;e.root=t;r?bt=t:i&&(i.Va=e,i.Ra&&i.Ra.Eb.push(e))},qt=(t,e,r)=>{var n=kt(t,{parent:!0}).node;t=at(t);if(!t||"."===t||".."===t)throw new Tt(28);var i=Mt(n,t);if(i)throw new Tt(i);if(!n.Ga.ab)throw new Tt(63);return n.Ga.ab(n,t,e,r)},Wt=(t,e)=>qt(t,(void 0!==e?e:511)&1023|16384,0),Gt=(t,e,r)=>{"undefined"==typeof r&&(r=e,e=438);qt(t,e|8192,r)},zt=(t,e)=>{if(!ct(t))throw new Tt(44);var r=kt(e,{parent:!0}).node;if(!r)throw new Tt(44);e=at(e);var n=Mt(r,e);if(n)throw new Tt(n);if(!r.Ga.symlink)throw new Tt(63);r.Ga.symlink(r,e,t)},Ht=t=>{var e=kt(t,{parent:!0}).node;t=at(t);var r=Rt(e,t),n=Ct(e,t,!0);if(n)throw new Tt(n);if(!e.Ga.rmdir)throw new Tt(63);if(r.Va)throw new Tt(10);e.Ga.rmdir(e,t);At(r)},Vt=t=>{var e=kt(t,{parent:!0}).node;if(!e)throw new Tt(44);t=at(t);var r=Rt(e,t),n=Ct(e,t,!1);if(n)throw new Tt(n);if(!e.Ga.unlink)throw new Tt(63);if(r.Va)throw new Tt(10);e.Ga.unlink(e,t);At(r)},Qt=t=>{t=kt(t).node;if(!t)throw new Tt(44);if(!t.Ga.readlink)throw new Tt(28);return ct(Ot(t.parent),t.Ga.readlink(t))},Kt=(t,e)=>{t=kt(t,{Sa:!e}).node;if(!t)throw new Tt(44);if(!t.Ga.Pa)throw new Tt(63);return t.Ga.Pa(t)},Zt=t=>Kt(t,!0),Jt=(t,e)=>{t="string"==typeof t?kt(t,{Sa:!0}).node:t;if(!t.Ga.Oa)throw new Tt(63);t.Ga.Oa(t,{mode:e&4095|t.mode&-4096,timestamp:Date.now()})},Xt=(t,e)=>{if(0>e)throw new Tt(28);t="string"==typeof t?kt(t,{Sa:!0}).node:t;if(!t.Ga.Oa)throw new Tt(63);if(16384===(t.mode&61440))throw new Tt(31);if(32768!==(t.mode&61440))throw new Tt(28);var r=It(t,"w");if(r)throw new Tt(r);t.Ga.Oa(t,{size:e,timestamp:Date.now()})},Yt=(t,e,r)=>{if(""===t)throw new Tt(44);if("string"==typeof e){var n=Nt[e];if("undefined"==typeof n)throw Error("Unknown file open mode: "+e);e=n}r=e&64?("undefined"==typeof r?438:r)&4095|32768:0;if("object"==typeof t)var i=t;else{t=st(t);try{i=kt(t,{Sa:!(e&131072)}).node}catch(t){}}n=!1;if(e&64)if(i){if(e&128)throw new Tt(20)}else i=qt(t,r,0),n=!0;if(!i)throw new Tt(44);8192===(i.mode&61440)&&(e&=-513);if(e&65536&&16384!==(i.mode&61440))throw new Tt(54);if(!n&&(r=i?40960===(i.mode&61440)?32:16384===(i.mode&61440)&&("r"!==jt(e)||e&512)?31:It(i,jt(e)):44))throw new Tt(r);e&512&&!n&&Xt(i,0);e&=-131713;i=xt({node:i,path:Ot(i),flags:e,seekable:!0,position:0,Ha:i.Ha,Ib:[],error:!1});i.Ha.open&&i.Ha.open(i);!o.logReadFiles||e&1||(he||(he={}),t in he||(he[t]=1));return i},te=t=>{if(null===t.fd)throw new Tt(8);t.hb&&(t.hb=null);try{t.Ha.close&&t.Ha.close(t)}catch(t){throw t}finally{Et[t.fd]=null}t.fd=null},ee=(t,e,r)=>{if(null===t.fd)throw new Tt(8);if(!t.seekable||!t.Ha.Ta)throw new Tt(70);if(0!=r&&1!=r&&2!=r)throw new Tt(28);t.position=t.Ha.Ta(t,e,r);t.Ib=[]},re=(t,e,r,n,i)=>{if(0>n||0>i)throw new Tt(28);if(null===t.fd)throw new Tt(8);if(1===(t.flags&2097155))throw new Tt(8);if(16384===(t.node.mode&61440))throw new Tt(31);if(!t.Ha.read)throw new Tt(28);var s="undefined"!=typeof i;if(!s)i=t.position;else if(!t.seekable)throw new Tt(70);e=t.Ha.read(t,e,r,n,i);s||(t.position+=e);return e},ne=(t,e,r,n,i)=>{if(0>n||0>i)throw new Tt(28);if(null===t.fd)throw new Tt(8);if(0===(t.flags&2097155))throw new Tt(8);if(16384===(t.node.mode&61440))throw new Tt(31);if(!t.Ha.write)throw new Tt(28);t.seekable&&t.flags&1024&&ee(t,0,2);var s="undefined"!=typeof i;if(!s)i=t.position;else if(!t.seekable)throw new Tt(70);e=t.Ha.write(t,e,r,n,i,void 0);s||(t.position+=e);return e},ie=t=>{var e;var r=Yt(t,r||0);t=Kt(t).size;var n=new Uint8Array(t);re(r,n,0,t,0);e=n;te(r);return e},se=()=>{Tt||(Tt=function(t,e){this.node=e;this.Hb=function(t){this.Ka=t};this.Hb(t);this.message="FS error"},Tt.prototype=Error(),Tt.prototype.constructor=Tt,[44].forEach((t=>{$t[t]=new Tt(t);$t[t].stack="<generic error, no stack>"})))},oe,ae=(t,e)=>{var r=0;t&&(r|=365);e&&(r|=146);return r},ue=(t,e,r)=>{t=st("/dev/"+t);var n=ae(!!e,!!r);fe||(fe=64);var i=fe++<<8|0;Ft(i,{open:t=>{t.seekable=!1},close:()=>{r&&r.buffer&&r.buffer.length&&r(10)},read:(t,r,n,i)=>{for(var s=0,o=0;o<i;o++){try{var a=e()}catch(t){throw new Tt(29)}if(void 0===a&&0===s)throw new Tt(6);if(null===a||void 0===a)break;s++;r[n+o]=a}s&&(t.node.timestamp=Date.now());return s},write:(t,e,n,i)=>{for(var s=0;s<i;s++)try{r(e[n+s])}catch(t){throw new Tt(29)}i&&(t.node.timestamp=Date.now());return s}});Gt(t,n,i)},fe,ce={},le,he;function de(t,e,r){if("/"===e.charAt(0))return e;t=-100===t?"/":ye(t).path;if(0==e.length){if(!r)throw new Tt(44);return t}return st(t+"/"+e)}function me(t,e,r){try{var n=t(e)}catch(t){if(t&&t.node&&st(e)!==st(Ot(t.node)))return-54;throw t}j[r>>2]=n.dev;j[r+8>>2]=n.ino;j[r+12>>2]=n.mode;I[r+16>>2]=n.nlink;j[r+20>>2]=n.uid;j[r+24>>2]=n.gid;j[r+28>>2]=n.rdev;tt=[n.size>>>0,(Y=n.size,1<=+Math.abs(Y)?0<Y?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)];j[r+40>>2]=tt[0];j[r+44>>2]=tt[1];j[r+48>>2]=4096;j[r+52>>2]=n.blocks;tt=[Math.floor(n.atime.getTime()/1e3)>>>0,(Y=Math.floor(n.atime.getTime()/1e3),1<=+Math.abs(Y)?0<Y?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)];j[r+56>>2]=tt[0];j[r+60>>2]=tt[1];I[r+64>>2]=0;tt=[Math.floor(n.mtime.getTime()/1e3)>>>0,(Y=Math.floor(n.mtime.getTime()/1e3),1<=+Math.abs(Y)?0<Y?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)];j[r+72>>2]=tt[0];j[r+76>>2]=tt[1];I[r+80>>2]=0;tt=[Math.floor(n.ctime.getTime()/1e3)>>>0,(Y=Math.floor(n.ctime.getTime()/1e3),1<=+Math.abs(Y)?0<Y?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)];j[r+88>>2]=tt[0];j[r+92>>2]=tt[1];I[r+96>>2]=0;tt=[n.ino>>>0,(Y=n.ino,1<=+Math.abs(Y)?0<Y?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)];j[r+104>>2]=tt[0];j[r+108>>2]=tt[1];return 0}var we=void 0;function ve(){we+=4;return j[we-4>>2]}function ye(t){t=Et[t];if(!t)throw new Tt(8);return t}function be(t){return I[t>>2]+4294967296*j[t+4>>2]}function pe(t){var e=_(t)+1,r=Le(e);r&&O(t,R,r,e);return r}function Ee(t,e,r){function n(t){return(t=t.toTimeString().match(/\(([A-Za-z ]+)\)$/))?t[1]:"GMT"}var i=(new Date).getFullYear(),s=new Date(i,0,1),o=new Date(i,6,1);i=s.getTimezoneOffset();var a=o.getTimezoneOffset();j[t>>2]=60*Math.max(i,a);j[e>>2]=Number(i!=a);t=n(s);e=n(o);t=pe(t);e=pe(e);a<i?(I[r>>2]=t,I[r+4>>2]=e):(I[r>>2]=e,I[r+4>>2]=t)}function ge(t,e,r){ge.Bb||(ge.Bb=!0,Ee(t,e,r))}var Pe;Pe=l?()=>{var t=G.hrtime();return 1e3*t[0]+t[1]/1e6}:()=>performance.now();var Se={};function Te(){if(!$e){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:u||"./this.program"},e;for(e in Se)void 0===Se[e]?delete t[e]:t[e]=Se[e];var r=[];for(e in t)r.push(e+"="+t[e]);$e=r}return $e}var $e,ke=void 0,Ae=[];function Re(t,e){if(!ke){ke=new WeakMap;var r=x.length;if(ke)for(var n=0;n<0+r;n++){var i=x.get(n);i&&ke.set(i,n)}}if(ke.has(t))return ke.get(t);if(Ae.length)r=Ae.pop();else{try{x.grow(1)}catch(t){if(!(t instanceof RangeError))throw t;throw"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH."}r=x.length-1}try{x.set(r,t)}catch(a){if(!(a instanceof TypeError))throw a;if("function"==typeof WebAssembly.Function){n=WebAssembly.Function;i={i:"i32",j:"i64",f:"f32",d:"f64",p:"i32"};for(var s={parameters:[],results:"v"==e[0]?[]:[i[e[0]]]},o=1;o<e.length;++o)s.parameters.push(i[e[o]]);e=new n(s,t)}else{n=[1,96];i=e.slice(0,1);e=e.slice(1);s={i:127,p:127,j:126,f:125,d:124};o=e.length;128>o?n.push(o):n.push(o%128|128,o>>7);for(o=0;o<e.length;++o)n.push(s[e[o]]);"v"==i?n.push(0):n.push(1,s[i]);e=[0,97,115,109,1,0,0,0,1];i=n.length;128>i?e.push(i):e.push(i%128|128,i>>7);e.push.apply(e,n);e.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);e=new WebAssembly.Module(new Uint8Array(e));e=new WebAssembly.Instance(e,{e:{f:t}}).exports.f}x.set(r,e)}ke.set(t,r);return r}function De(t){ke.delete(x.get(t));Ae.push(t)}function Ne(t){var e=Le(t.length);t.subarray||t.slice||(t=new Uint8Array(t));D.set(t,e);return e}function je(t,e,r,n){var i={string:t=>{var e=0;if(null!==t&&void 0!==t&&0!==t){var r=(t.length<<2)+1;e=qe(r);O(t,D,e,r)}return e},array:t=>{var e=qe(t.length);R.set(t,e);return e}};t=o["_"+t];var s=[],a=0;if(n)for(var u=0;u<n.length;u++){var f=i[r[u]];f?(0===a&&(a=Fe()),s[u]=f(n[u])):s[u]=n[u]}r=t.apply(null,s);return r=function(t){0!==a&&Ue(a);return"string"===e?k(t):"boolean"===e?!!t:t}(r)}function Ie(t,e,r,n){t||(t=this);this.parent=t;this.Ra=t.Ra;this.Va=null;this.id=gt++;this.name=e;this.mode=r;this.Ga={};this.Ha={};this.rdev=n}Object.defineProperties(Ie.prototype,{read:{get:function(){return 365===(this.mode&365)},set:function(t){t?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146===(this.mode&146)},set:function(t){t?this.mode|=146:this.mode&=-147}}});se();Pt=Array(4096);Ut(yt,"/");Wt("/tmp");Wt("/home");Wt("/home/web_user");(()=>{Wt("/dev");Ft(259,{read:()=>0,write:(t,e,r,n)=>n});Gt("/dev/null",259);dt(1280,wt);dt(1536,vt);Gt("/dev/tty",1280);Gt("/dev/tty1",1536);var t=ft();ue("random",t);ue("urandom",t);Wt("/dev/shm");Wt("/dev/shm/tmp")})();(()=>{Wt("/proc");var t=Wt("/proc/self");Wt("/proc/self/fd");Ut({Ra:()=>{var e=Dt(t,"fd",16895,73);e.Ga={lookup:(t,e)=>{var r=Et[+e];if(!r)throw new Tt(8);t={parent:null,Ra:{ub:"fake"},Ga:{readlink:()=>r.path}};return t.parent=t}};return e}},"/proc/self/fd")})();var Me={a:function(t,e,r,n){V("Assertion failed: "+k(t)+", at: "+[e?k(e):"unknown filename",r,n?k(n):"unknown function"])},h:function(t,e){try{return t=k(t),Jt(t,e),0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},H:function(t,e,r){try{e=k(e);e=de(t,e);if(r&-8)return-28;var n=kt(e,{Sa:!0}).node;if(!n)return-44;t="";r&4&&(t+="r");r&2&&(t+="w");r&1&&(t+="x");return t&&It(n,t)?-2:0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},i:function(t,e){try{var r=Et[t];if(!r)throw new Tt(8);Jt(r.node,e);return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},g:function(t){try{var e=Et[t];if(!e)throw new Tt(8);var r=e.node;var n="string"==typeof r?kt(r,{Sa:!0}).node:r;if(!n.Ga.Oa)throw new Tt(63);n.Ga.Oa(n,{timestamp:Date.now()});return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},b:function(t,e,r){we=r;try{var n=ye(t);switch(e){case 0:var i=ve();return 0>i?-28:xt(n,i).fd;case 1:case 2:return 0;case 3:return n.flags;case 4:return i=ve(),n.flags|=i,0;case 5:return i=ve(),N[i+0>>1]=2,0;case 6:case 7:return 0;case 16:case 8:return-28;case 9:return j[Ce()>>2]=28,-1;default:return-28}}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},G:function(t,e){try{var r=ye(t);return me(Kt,r.path,e)}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},l:function(t,e,r){try{e=r+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*r:NaN;if(isNaN(e))return-61;var n=Et[t];if(!n)throw new Tt(8);if(0===(n.flags&2097155))throw new Tt(28);Xt(n.node,e);return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},B:function(t,e){try{if(0===e)return-28;var r=_("/")+1;if(e<r)return-68;O("/",D,t,e);return r}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},E:function(t,e){try{return t=k(t),me(Zt,t,e)}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},y:function(t,e,r){try{return e=k(e),e=de(t,e),e=st(e),"/"===e[e.length-1]&&(e=e.substr(0,e.length-1)),Wt(e,r),0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},D:function(t,e,r,n){try{e=k(e);var i=n&256;e=de(t,e,n&4096);return me(i?Zt:Kt,e,r)}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},v:function(t,e,r,n){we=n;try{e=k(e);e=de(t,e);var i=n?ve():0;return Yt(e,r,i).fd}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},t:function(t,e,r,n){try{e=k(e);e=de(t,e);if(0>=n)return-28;var i=Qt(e),s=Math.min(n,_(i)),o=R[r+s];O(i,D,r,n+1);R[r+s]=o;return s}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},s:function(t){try{return t=k(t),Ht(t),0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},F:function(t,e){try{return t=k(t),me(Kt,t,e)}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},p:function(t,e,r){try{return e=k(e),e=de(t,e),0===r?Vt(e):512===r?Ht(e):V("Invalid flags passed to unlinkat"),0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},o:function(t,e,r){try{e=k(e);e=de(t,e,!0);if(r){var n=be(r),i=j[r+8>>2];s=1e3*n+i/1e6;r+=16;n=be(r);i=j[r+8>>2];o=1e3*n+i/1e6}else var s=Date.now(),o=s;t=s;var a=kt(e,{Sa:!0}).node;a.Ga.Oa(a,{timestamp:Math.max(t,o)});return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},e:function(){return Date.now()},j:function(t,e){t=new Date(1e3*be(t));j[e>>2]=t.getSeconds();j[e+4>>2]=t.getMinutes();j[e+8>>2]=t.getHours();j[e+12>>2]=t.getDate();j[e+16>>2]=t.getMonth();j[e+20>>2]=t.getFullYear()-1900;j[e+24>>2]=t.getDay();var r=new Date(t.getFullYear(),0,1);j[e+28>>2]=(t.getTime()-r.getTime())/864e5|0;j[e+36>>2]=-(60*t.getTimezoneOffset());var n=new Date(t.getFullYear(),6,1).getTimezoneOffset();r=r.getTimezoneOffset();j[e+32>>2]=(n!=r&&t.getTimezoneOffset()==Math.min(r,n))|0},w:function(t,e,r,n,i,s){try{var o=ye(n);if(0!==(e&2)&&0===(r&2)&&2!==(o.flags&2097155))throw new Tt(2);if(1===(o.flags&2097155))throw new Tt(2);if(!o.Ha.bb)throw new Tt(43);var a=o.Ha.bb(o,t,i,e,r);var u=a.Fb;j[s>>2]=a.vb;return u}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},x:function(t,e,r,n,i,s){try{var o=ye(i);if(r&2){var a=D.slice(t,t+e);o&&o.Ha.cb&&o.Ha.cb(o,a,s,e,n)}}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return-t.Ka}},n:ge,q:function(){return 2147483648},d:Pe,c:function(t){var e=D.length;t>>>=0;if(2147483648<t)return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296);var i=Math;n=Math.max(t,n);i=i.min.call(i,2147483648,n+(65536-n%65536)%65536);t:{try{P.grow(i-A.byteLength+65535>>>16);L();var s=1;break t}catch(t){}s=void 0}if(s)return!0}return!1},z:function(t,e){var r=0;Te().forEach((function(n,i){var s=e+r;i=I[t+4*i>>2]=s;for(s=0;s<n.length;++s)R[i++>>0]=n.charCodeAt(s);R[i>>0]=0;r+=n.length+1}));return 0},A:function(t,e){var r=Te();I[t>>2]=r.length;var n=0;r.forEach((function(t){n+=t.length+1}));I[e>>2]=n;return 0},f:function(t){try{var e=ye(t);te(e);return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return t.Ka}},m:function(t,e){try{var r=ye(t);R[e>>0]=r.tty?2:16384===(r.mode&61440)?3:40960===(r.mode&61440)?7:4;return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return t.Ka}},u:function(t,e,r,n){try{t:{var i=ye(t);t=e;for(var s=e=0;s<r;s++){var o=I[t>>2],a=I[t+4>>2];t+=8;var u=re(i,R,o,a);if(0>u){var f=-1;break t}e+=u;if(u<a)break}f=e}I[n>>2]=f;return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return t.Ka}},k:function(t,e,r,n,i){try{e=r+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*r:NaN;if(isNaN(e))return 61;var s=ye(t);ee(s,e,n);tt=[s.position>>>0,(Y=s.position,1<=+Math.abs(Y)?0<Y?(Math.min(+Math.floor(Y/4294967296),4294967295)|0)>>>0:~~+Math.ceil((Y-+(~~Y>>>0))/4294967296)>>>0:0)];j[i>>2]=tt[0];j[i+4>>2]=tt[1];s.hb&&0===e&&0===n&&(s.hb=null);return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return t.Ka}},C:function(t){try{var e=ye(t);return e.Ha&&e.Ha.fsync?e.Ha.fsync(e):0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return t.Ka}},r:function(t,e,r,n){try{t:{var i=ye(t);t=e;for(var s=e=0;s<r;s++){var o=I[t>>2],a=I[t+4>>2];t+=8;var u=ne(i,R,o,a);if(0>u){var f=-1;break t}e+=u}f=e}I[n>>2]=f;return 0}catch(t){if("undefined"==typeof ce||!(t instanceof Tt))throw t;return t.Ka}}};(function(){function t(t){o.asm=t.exports;P=o.asm.I;L();x=o.asm.Aa;F.unshift(o.asm.J);W--;o.monitorRunDependencies&&o.monitorRunDependencies(W);0==W&&(H&&(t=H,H=null,t()))}function e(e){t(e.instance)}function r(t){return X().then((function(t){return WebAssembly.instantiate(t,n)})).then((function(t){return t})).then(t,(function(t){E("failed to asynchronously prepare wasm: "+t);V(t)}))}var n={a:Me};W++;o.monitorRunDependencies&&o.monitorRunDependencies(W);if(o.instantiateWasm)try{return o.instantiateWasm(n,t)}catch(t){return E("Module.instantiateWasm callback failed with error: "+t),!1}(function(){return g||"function"!=typeof WebAssembly.instantiateStreaming||Q()||K.startsWith("file://")||l||"function"!=typeof fetch?r(e):fetch(K,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,n).then(e,(function(t){E("wasm streaming compile failed: "+t);E("falling back to ArrayBuffer instantiation");return r(e)}))}))})();return{}})();o.___wasm_call_ctors=function(){return(o.___wasm_call_ctors=o.asm.J).apply(null,arguments)};o._sqlite3_free=function(){return(o._sqlite3_free=o.asm.K).apply(null,arguments)};o._sqlite3_value_double=function(){return(o._sqlite3_value_double=o.asm.L).apply(null,arguments)};o._sqlite3_value_text=function(){return(o._sqlite3_value_text=o.asm.M).apply(null,arguments)};var Ce=o.___errno_location=function(){return(Ce=o.___errno_location=o.asm.N).apply(null,arguments)};o._sqlite3_prepare_v2=function(){return(o._sqlite3_prepare_v2=o.asm.O).apply(null,arguments)};o._sqlite3_step=function(){return(o._sqlite3_step=o.asm.P).apply(null,arguments)};o._sqlite3_finalize=function(){return(o._sqlite3_finalize=o.asm.Q).apply(null,arguments)};o._sqlite3_reset=function(){return(o._sqlite3_reset=o.asm.R).apply(null,arguments)};o._sqlite3_value_int=function(){return(o._sqlite3_value_int=o.asm.S).apply(null,arguments)};o._sqlite3_clear_bindings=function(){return(o._sqlite3_clear_bindings=o.asm.T).apply(null,arguments)};o._sqlite3_value_blob=function(){return(o._sqlite3_value_blob=o.asm.U).apply(null,arguments)};o._sqlite3_value_bytes=function(){return(o._sqlite3_value_bytes=o.asm.V).apply(null,arguments)};o._sqlite3_value_type=function(){return(o._sqlite3_value_type=o.asm.W).apply(null,arguments)};o._sqlite3_result_blob=function(){return(o._sqlite3_result_blob=o.asm.X).apply(null,arguments)};o._sqlite3_result_double=function(){return(o._sqlite3_result_double=o.asm.Y).apply(null,arguments)};o._sqlite3_result_error=function(){return(o._sqlite3_result_error=o.asm.Z).apply(null,arguments)};o._sqlite3_result_int=function(){return(o._sqlite3_result_int=o.asm._).apply(null,arguments)};o._sqlite3_result_int64=function(){return(o._sqlite3_result_int64=o.asm.$).apply(null,arguments)};o._sqlite3_result_null=function(){return(o._sqlite3_result_null=o.asm.aa).apply(null,arguments)};o._sqlite3_result_text=function(){return(o._sqlite3_result_text=o.asm.ba).apply(null,arguments)};o._sqlite3_sql=function(){return(o._sqlite3_sql=o.asm.ca).apply(null,arguments)};o._sqlite3_aggregate_context=function(){return(o._sqlite3_aggregate_context=o.asm.da).apply(null,arguments)};o._sqlite3_column_count=function(){return(o._sqlite3_column_count=o.asm.ea).apply(null,arguments)};o._sqlite3_data_count=function(){return(o._sqlite3_data_count=o.asm.fa).apply(null,arguments)};o._sqlite3_column_blob=function(){return(o._sqlite3_column_blob=o.asm.ga).apply(null,arguments)};o._sqlite3_column_bytes=function(){return(o._sqlite3_column_bytes=o.asm.ha).apply(null,arguments)};o._sqlite3_column_double=function(){return(o._sqlite3_column_double=o.asm.ia).apply(null,arguments)};o._sqlite3_column_text=function(){return(o._sqlite3_column_text=o.asm.ja).apply(null,arguments)};o._sqlite3_column_type=function(){return(o._sqlite3_column_type=o.asm.ka).apply(null,arguments)};o._sqlite3_column_name=function(){return(o._sqlite3_column_name=o.asm.la).apply(null,arguments)};o._sqlite3_bind_blob=function(){return(o._sqlite3_bind_blob=o.asm.ma).apply(null,arguments)};o._sqlite3_bind_double=function(){return(o._sqlite3_bind_double=o.asm.na).apply(null,arguments)};o._sqlite3_bind_int=function(){return(o._sqlite3_bind_int=o.asm.oa).apply(null,arguments)};o._sqlite3_bind_text=function(){return(o._sqlite3_bind_text=o.asm.pa).apply(null,arguments)};o._sqlite3_bind_parameter_index=function(){return(o._sqlite3_bind_parameter_index=o.asm.qa).apply(null,arguments)};o._sqlite3_normalized_sql=function(){return(o._sqlite3_normalized_sql=o.asm.ra).apply(null,arguments)};o._sqlite3_errmsg=function(){return(o._sqlite3_errmsg=o.asm.sa).apply(null,arguments)};o._sqlite3_exec=function(){return(o._sqlite3_exec=o.asm.ta).apply(null,arguments)};o._sqlite3_changes=function(){return(o._sqlite3_changes=o.asm.ua).apply(null,arguments)};o._sqlite3_close_v2=function(){return(o._sqlite3_close_v2=o.asm.va).apply(null,arguments)};o._sqlite3_create_function_v2=function(){return(o._sqlite3_create_function_v2=o.asm.wa).apply(null,arguments)};o._sqlite3_open=function(){return(o._sqlite3_open=o.asm.xa).apply(null,arguments)};var Le=o._malloc=function(){return(Le=o._malloc=o.asm.ya).apply(null,arguments)},xe=o._free=function(){return(xe=o._free=o.asm.za).apply(null,arguments)};o._RegisterExtensionFunctions=function(){return(o._RegisterExtensionFunctions=o.asm.Ba).apply(null,arguments)};var Be=o._emscripten_builtin_memalign=function(){return(Be=o._emscripten_builtin_memalign=o.asm.Ca).apply(null,arguments)},Fe=o.stackSave=function(){return(Fe=o.stackSave=o.asm.Da).apply(null,arguments)},Ue=o.stackRestore=function(){return(Ue=o.stackRestore=o.asm.Ea).apply(null,arguments)},qe=o.stackAlloc=function(){return(qe=o.stackAlloc=o.asm.Fa).apply(null,arguments)};o.UTF8ToString=k;o.stackAlloc=qe;o.stackSave=Fe;o.stackRestore=Ue;o.cwrap=function(t,e,r,n){r=r||[];var i=r.every((t=>"number"===t||"boolean"===t));return"string"!==e&&i&&!n?o["_"+t]:function(){return je(t,e,r,arguments)}};var We;H=function t(){We||Ge();We||(H=t)};function Ge(){function t(){if(!We&&(We=!0,o.calledRun=!0,!S)){o.noFSInit||oe||(oe=!0,se(),o.stdin=o.stdin,o.stdout=o.stdout,o.stderr=o.stderr,o.stdin?ue("stdin",o.stdin):zt("/dev/tty","/dev/stdin"),o.stdout?ue("stdout",null,o.stdout):zt("/dev/tty","/dev/stdout"),o.stderr?ue("stderr",null,o.stderr):zt("/dev/tty1","/dev/stderr"),Yt("/dev/stdin",0),Yt("/dev/stdout",1),Yt("/dev/stderr",1));St=!1;et(F);if(o.onRuntimeInitialized)o.onRuntimeInitialized();if(o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;){var t=o.postRun.shift();U.unshift(t)}et(U)}}if(!(0<W)){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)q();et(B);0<W||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1);t()}),1)):t())}}if(o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);0<o.preInit.length;)o.preInit.pop()();Ge();return i}));return r};{t.exports=n;t.exports.default=n}}));class Re{static async getDBFromStore(t,e){try{const r=await e.getItem(t);return Promise.resolve(r)}catch(t){return Promise.reject(`GetDBFromStore: ${t.message}`)}}static async setInitialDBToStore(t,e){try{const r=null;await e.setItem(t,r);return Promise.resolve()}catch(t){return Promise.reject(`SetInitialDBToStore: ${t.message}`)}}static async setDBToStore(t,e,r){try{const n=t.export();await Re.saveDBToStore(e,n,r);return Promise.resolve()}catch(t){return Promise.reject(`SetDBToStore: ${t.message}`)}}static async saveDBToStore(t,e,r){try{await r.setItem(t,e);return Promise.resolve()}catch(t){return Promise.reject(`SaveDBToStore: ${t.message}`)}}static async removeDBFromStore(t,e){try{await e.removeItem(t);return Promise.resolve()}catch(t){return Promise.reject(`RemoveDBFromStore: ${t.message}`)}}static async isDBInStore(t,e){try{const r=await e.getItem(t);if(r!=null&&r.length>0){return Promise.resolve(true)}else{return Promise.resolve(false)}}catch(t){return Promise.reject(`IsDBInStore: ${t}`)}}static async restoreDBFromStore(t,e,r){const n=`${e}-${t}`;try{const e=await Re.isDBInStore(n,r);if(e){const e=await Re.isDBInStore(t,r);if(e){const e=await Re.getDBFromStore(n,r);await Re.saveDBToStore(t,e,r);await Re.removeDBFromStore(n,r);return Promise.resolve()}else{return Promise.reject(new Error(`RestoreDBFromStore: ${t} does not exist`))}}else{return Promise.reject(new Error(`RestoreDBFromStore: ${n} does not exist`))}}catch(t){return Promise.reject(`RestoreDBFromStore: ${t.message}`)}}static async copyDBToStore(t,e,r){try{const n=await Re.isDBInStore(t,r);if(n){const n=await Re.getDBFromStore(t,r);await Re.saveDBToStore(e,n,r);return Promise.resolve()}else{return Promise.reject(new Error(`CopyDBToStore: ${t} does not exist`))}}catch(t){return Promise.reject(`CopyDBToStore: ${t.message}`)}}static async getDBListFromStore(t){try{const e=await t.keys();return Promise.resolve(e)}catch(t){return Promise.reject(`GetDBListFromStore: ${t.message}`)}}}class De{static async getTablesNames(t){let e="SELECT name FROM sqlite_master WHERE ";e+="type='table' AND name NOT LIKE 'sync_table' ";e+="AND name NOT LIKE '_temp_%' ";e+="AND name NOT LIKE 'sqlite_%' ";e+="ORDER BY rootpage DESC;";const r=[];try{const n=await Ce.queryAll(t,e,[]);for(const t of n){r.push(t.name)}return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`GetTablesNames: ${t.message}`))}}static async getViewsNames(t){let e="SELECT name FROM sqlite_master WHERE ";e+="type='view' AND name NOT LIKE 'sqlite_%' ";e+="ORDER BY rootpage DESC;";const r=[];try{const n=await Ce.queryAll(t,e,[]);for(const t of n){r.push(t.name)}return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`getViewsNames: ${t.message}`))}}static async dropElements(t,e){let r="";let n=`AND name NOT LIKE ('sqlite_%')`;switch(e){case"index":r="DropIndexes";break;case"trigger":r="DropTriggers";break;case"table":r="DropTables";n+=` AND name NOT IN ('sync_table')`;break;case"view":r="DropViews";break;default:return Promise.reject(new Error(`DropElements: ${e} `+"not found"))}let i="SELECT name FROM sqlite_master WHERE ";i+=`type = '${e}' ${n};`;try{const n=await Ce.queryAll(t,i,[]);if(n.length>0){const i=e.toUpperCase();const s=[];for(const t of n){let e=`DROP ${i} IF EXISTS `;e+=`${t.name};`;s.push(e)}for(const e of s){const n=await Ce.run(t,e,[],false,"no");if(n<0){return Promise.reject(new Error(`DropElements: ${r}: lastId < 0`))}}}return Promise.resolve()}catch(t){return Promise.reject(new Error(`DropElements: ${r}: ${t.message}`))}}static async dropAll(t){try{await De.dropElements(t,"table");await De.dropElements(t,"index");await De.dropElements(t,"trigger");await De.dropElements(t,"view");await Ce.run(t,"VACUUM;",[],false,"no");return Promise.resolve()}catch(t){return Promise.reject(new Error(`DropAll: ${t.message}`))}}static async dropTempTables(t,e){const r=Object.keys(e);const n=[];for(const t of r){let e="DROP TABLE IF EXISTS ";e+=`_temp_${t};`;n.push(e)}try{const e=await Ce.execute(t,n.join("\n"),false);if(e<0){return Promise.reject(new Error("DropTempTables: changes < 0"))}return Promise.resolve()}catch(t){return Promise.reject(new Error(`DropTempTables: ${t.message}`))}}}class Ne{static async isJsonSQLite(t){const e=["database","version","overwrite","encrypted","mode","tables","views"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return false;for(const r of Object.keys(t)){if(e.indexOf(r)===-1)return false;if(r==="database"&&typeof t[r]!="string")return false;if(r==="version"&&typeof t[r]!="number")return false;if(r==="overwrite"&&typeof t[r]!="boolean")return false;if(r==="encrypted"&&typeof t[r]!="boolean")return false;if(r==="mode"&&typeof t[r]!="string")return false;if(r==="tables"&&typeof t[r]!="object")return false;if(r==="tables"){for(const e of t[r]){const t=await Ne.isTable(e);if(!t)return false}}if(r==="views"&&typeof t[r]!="object")return false;if(r==="views"){for(const e of t[r]){const t=await Ne.isView(e);if(!t)return false}}}return true}static async isTable(t){const e=["name","schema","indexes","triggers","values"];let r=0;if(t==null||Object.keys(t).length===0&&t.constructor===Object)return false;for(const n of Object.keys(t)){if(e.indexOf(n)===-1)return false;if(n==="name"&&typeof t[n]!="string")return false;if(n==="schema"&&typeof t[n]!="object")return false;if(n==="indexes"&&typeof t[n]!="object")return false;if(n==="triggers"&&typeof t[n]!="object")return false;if(n==="values"&&typeof t[n]!="object")return false;if(n==="schema"){t["schema"].forEach((t=>{if(t.column){r++}}));for(let e=0;e<r;e++){const r=await Ne.isSchema(t[n][e]);if(!r)return false}}if(n==="indexes"){for(const e of t[n]){const t=await Ne.isIndexes(e);if(!t)return false}}if(n==="triggers"){for(const e of t[n]){const t=await Ne.isTriggers(e);if(!t)return false}}if(n==="values"){if(r>0){for(const e of t[n]){if(typeof e!="object"||e.length!=r)return false}}}}return true}static async isSchema(t){const e=["column","value","foreignkey","primarykey","constraint"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return false;for(const r of Object.keys(t)){if(e.indexOf(r)===-1)return false;if(r==="column"&&typeof t[r]!="string")return false;if(r==="value"&&typeof t[r]!="string")return false;if(r==="foreignkey"&&typeof t[r]!="string")return false;if(r==="primarykey"&&typeof t[r]!="string")return false;if(r==="constraint"&&typeof t[r]!="string")return false}return true}static async isIndexes(t){const e=["name","value","mode"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return false;for(const r of Object.keys(t)){if(e.indexOf(r)===-1)return false;if(r==="name"&&typeof t[r]!="string")return false;if(r==="value"&&typeof t[r]!="string")return false;if(r==="mode"&&(typeof t[r]!="string"||t[r].toUpperCase()!="UNIQUE"))return false}return true}static async isTriggers(t){const e=["name","timeevent","condition","logic"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return false;for(const r of Object.keys(t)){if(e.indexOf(r)===-1)return false;if(r==="name"&&typeof t[r]!="string")return false;if(r==="timeevent"&&typeof t[r]!="string")return false;if(r==="condition"&&typeof t[r]!="string")return false;if(r==="logic"&&typeof t[r]!="string")return false}return true}static async isView(t){const e=["name","value"];if(t==null||Object.keys(t).length===0&&t.constructor===Object)return false;for(const r of Object.keys(t)){if(e.indexOf(r)===-1)return false;if(r==="name"&&typeof t[r]!="string")return false;if(r==="value"&&typeof t[r]!="string")return false}return true}static async checkSchemaValidity(t){for(let e=0;e<t.length;e++){const r={};const n=Object.keys(t[e]);if(n.includes("column")){r.column=t[e].column}if(n.includes("value")){r.value=t[e].value}if(n.includes("foreignkey")){r.foreignkey=t[e].foreignkey}if(n.includes("constraint")){r.constraint=t[e].constraint}const i=await Ne.isSchema(r);if(!i){return Promise.reject(new Error(`CheckSchemaValidity: schema[${e}] not valid`))}}return Promise.resolve()}static async checkIndexesValidity(t){for(let e=0;e<t.length;e++){const r={};const n=Object.keys(t[e]);if(n.includes("value")){r.value=t[e].value}if(n.includes("name")){r.name=t[e].name}if(n.includes("mode")){r.mode=t[e].mode}const i=await Ne.isIndexes(r);if(!i){return Promise.reject(new Error(`CheckIndexesValidity: indexes[${e}] not valid`))}}return Promise.resolve()}static async checkTriggersValidity(t){for(let e=0;e<t.length;e++){const r={};const n=Object.keys(t[e]);if(n.includes("logic")){r.logic=t[e].logic}if(n.includes("name")){r.name=t[e].name}if(n.includes("timeevent")){r.timeevent=t[e].timeevent}if(n.includes("condition")){r.condition=t[e].condition}const i=await Ne.isTriggers(r);if(!i){return Promise.reject(new Error(`CheckTriggersValidity: triggers[${e}] not valid`))}}return Promise.resolve()}static async checkViewsValidity(t){for(let e=0;e<t.length;e++){const r={};const n=Object.keys(t[e]);if(n.includes("value")){r.value=t[e].value}if(n.includes("name")){r.name=t[e].name}const i=await Ne.isView(r);if(!i){return Promise.reject(new Error(`CheckViewsValidity: views[${e}] not valid`))}}return Promise.resolve()}static async getTableColumnNamesTypes(t,e){let r=[];const n=[];const i=[];const s=`PRAGMA table_info('${e}');`;try{r=await Ce.queryAll(t,s,[]);if(r.length>0){for(const t of r){n.push(t.name);i.push(t.type)}}return Promise.resolve({names:n,types:i})}catch(t){return Promise.reject(new Error("GetTableColumnNamesTypes: "+`${t.message}`))}}static async getValues(t,e,r){const n=[];try{const i=await Ne.getTableColumnNamesTypes(t,r);let s=[];if(Object.keys(i).includes("names")){s=i.names}else{return Promise.reject(new Error(`GetValues: Table ${r} no names`))}const o=await Ce.queryAll(t,e,[]);for(const t of o){const e=[];for(const r of s){if(Object.keys(t).includes(r)){e.push(t[r])}else{e.push(null)}}n.push(e)}return Promise.resolve(n)}catch(t){return Promise.reject(new Error(`GetValues: ${t.message}`))}}}class je{static extractTableName(t){const e=/(?:INSERT\s+INTO|UPDATE|DELETE\s+FROM)\s+([^\s]+)/i;const r=t.match(e);if(r&&r[1]){const t=r[1];return t}return null}static extractWhereClause(t){const e=/WHERE(.+?)(?:ORDER\s+BY|LIMIT|$)/i;const r=t.match(e);if(r&&r[1]){const t=r[1].trim();return t}return null}static addPrefixToWhereClause(t,e,r,n){let i;if(t.includes("AND")){const e=t.split("AND");i=e.map((t=>t.trim()))}else{i=[t]}const s=i.map((t=>{const i=t.match(/(\w+)\s*(=|<|<=|<>|>|>=|IN|BETWEEN|LIKE)\s*(.+)/);if(!i){return t}const s=i[1].trim();const o=i[2].trim();let a=i[3].trim();let u=s;const f=je.findIndexOfStringInArray(s,r);if(f!==-1){u=je.getStringAtIndex(e,f)}const c=`${n}${u}`;const l=`${c} ${o} ${a}`;return l}));return s.join(" AND ")}static findIndexOfStringInArray(t,e){return e.indexOf(t)}static getStringAtIndex(t,e){if(e>=0&&e<t.length){return t[e]}else{return undefined}}static extractForeignKeyInfo(t){const e=/\bFOREIGN\s+KEY\s*\(([^)]+)\)\s+REFERENCES\s+(\w+)\s*\(([^)]+)\)\s+(ON\s+DELETE\s+(RESTRICT|CASCADE|SET\s+NULL|SET\s+DEFAULT|NO\s+ACTION))?/;const r=t.match(e);if(r){const t={forKeys:r[1].split(",").map((t=>t.trim())),tableName:r[2],refKeys:r[3].split(",").map((t=>t.trim())),action:r[5]?r[5]:"NO ACTION"};return t}else{throw new Error("extractForeignKeyInfo: No FOREIGN KEY found")}}static extractColumnNames(t){const e=new Set(["AND","OR","IN","VALUES","LIKE","BETWEEN","NOT"]);const r=/\b[a-zA-Z]\w*\b(?=\s*(?:<=?|>=?|<>?|=|AND|OR|BETWEEN|NOT|IN|LIKE))|\b[a-zA-Z]\w*\b\s+BETWEEN\s+'[^']+'\s+AND\s+'[^']+'|\(([^)]+)\)\s+IN\s+\(?\s*VALUES\s*\(/g;let n;const i=[];while((n=r.exec(t))!==null){const t=n[1];if(t){const e=t.split(",");for(const t of e){i.push(t.trim())}}else{const t=n[0];if(!e.has(t.trim().toUpperCase())){i.push(t.trim())}}}return i}static flattenMultilineString(t){const e=t.split(/\r?\n/);return e.join(" ")}static getStmtAndRetColNames(t,e){const r="RETURNING";const n={stmt:t,names:""};const i=t.toUpperCase().indexOf(r);if(i!==-1){const s=t.substring(0,i);n.stmt=`${s};`;if(e.substring(0,2)==="wA"){const e=t.substring(i+r.length);const s=e.trim();if(s.endsWith(";")){n.names=s.substring(0,s.length-1)}else{n.names=s}}}return n}static extractCombinedPrimaryKey(t){const e=/WHERE\s*\((.+?)\)\s*(?:=|IN)\s*\((.+?)\)/g;const r=new RegExp(e);const n=t.matchAll(r);const i=[];for(const t of n){const e=t[1].trim();const r=e.split(",").map((t=>t.trim()));i.push(r)}return i.length===0?null:i}static getWhereStmtForCombinedPK(t,e,r,n){let i=t;for(const t of n){const n=t.join(",")===e.join(",")?r:e;for(const[e,r]of t.entries()){i=je.replaceAllString(i,r,n[e])}}return i}static replaceAllString(t,e,r){return t.split(e).join(r)}static indicesOf(t,e,r=0){const n=[];let i=t.indexOf(e,r);while(i!==-1){n.push(i);i=t.indexOf(e,i+1)}return n}static getWhereStmtForNonCombinedPK(t,e,r){let n="";let i=t.substring(6);for(let t=0;t<e.length;t++){let s="withRefsNames";let o=je.indicesOf(i,e[t]);if(o.length===0){o=je.indicesOf(i,r[t]);s="colNames"}if(o.length>0){let a="";const u=je.indicesOf(i,"=",o[0]);if(u.length>0){const o=je.indicesOf(i,"AND",u[0]);if(o.length>0){a=i.substring(u[0]+1,o[0]-1);i=i.substring(o[0]+3)}else{a=i.substring(u[0]+1)}if(t>0){n+=" AND "}if(s==="withRefsNames"){n+=r[t]+" = "+a}else{n+=e[t]+" = "+a}}}}n="WHERE "+n;return n}static updateWhere(t,e,r){let n="";if(t.length<=0){return n}if(t.toUpperCase().substring(0,5)!=="WHERE"){return n}if(e.length===r.length){const i=je.extractCombinedPrimaryKey(t);if(i){n=je.getWhereStmtForCombinedPK(t,e,r,i)}else{n=je.getWhereStmtForNonCombinedPK(t,e,r)}}return n}}je.replaceString=(t,e,r)=>{const n=t.indexOf(e);if(n!==-1){const i=t.substring(0,n)+r+t.substring(n+e.length);return i}return t};class Ie{static findReferencesAndUpdate(t){return new Ie(t)}static getRefs(t){return new Ie(t)}static getReferences(t){return new Ie(t)}static searchForRelatedItems(t){return new Ie(t)}static upDateWhereForDefault(t){return new Ie(t)}static upDateWhereForRestrict(t){return new Ie(t)}static upDateWhereForCascade(t){return new Ie(t)}static executeUpdateForDelete(t){return new Ie(t)}constructor(t){this.message=t}}class Me{static async findReferencesAndUpdate(t,e,r,n,i){try{let s=true;const o=await Me.getReferences(t,e);const a=o.retRefs;const u=o.tableWithRefs;if(a.length<=0){return s}if(e===u){return s}for(const s of a){const o=je.extractForeignKeyInfo(s);const a=o.tableName;if(a===""||a!==e){continue}const f=o.forKeys;const c=o.refKeys;if(c.length!==f.length){const t="findReferencesAndUpdate: mismatch length";throw Ie.findReferencesAndUpdate(t)}const l=o.action;if(l==="NO_ACTION"){continue}let h=u;let d=f;let m={uWhereStmt:"",setStmt:""};if(!Me.checkValuesMatch(f,n)){const n=await Me.searchForRelatedItems(t,h,e,r,f,c,i);if(n.relatedItems.length===0&&n.key.length<=0){continue}if(h!==e){switch(l){case"RESTRICT":m=await Me.upDateWhereForRestrict(n);break;case"CASCADE":m=await Me.upDateWhereForCascade(n);break;default:m=await Me.upDateWhereForDefault(f,n);break}}}else{throw Ie.findReferencesAndUpdate("Not implemented. Please transfer your example to the maintener")}if(m.setStmt.length>0&&m.uWhereStmt.length>0){Me.executeUpdateForDelete(t,h,m.uWhereStmt,m.setStmt,d,i)}}return s}catch(t){const e=t.message?t.message:t;if(t instanceof Ie){throw Ie.findReferencesAndUpdate(e)}else{throw t}}}static async getReferences(t,e){const r="SELECT sql FROM sqlite_master "+"WHERE sql LIKE('%FOREIGN KEY%') AND sql LIKE('%REFERENCES%') AND "+"sql LIKE('%"+e+"%') AND sql LIKE('%ON DELETE%');";try{const e=await Ce.queryAll(t,r,[]);let n=[];let i="";if(e.length>0){let t=Me.getRefs(e[0].sql);n=t.foreignKeys;i=t.tableName}return Promise.resolve({tableWithRefs:i,retRefs:n})}catch(t){const e=t.message?t.message:t;const r=`getReferences: ${e}`;throw Ie.getReferences(r)}}static getRefs(t){let e="";const r=[];const n=je.flattenMultilineString(t);try{const t=/CREATE\s+TABLE\s+(\w+)\s+\(/;const i=n.match(t);if(i){e=i[1]}const s=/FOREIGN\s+KEY\s+\([^)]+\)\s+REFERENCES\s+(\w+)\s*\([^)]+\)\s+ON\s+DELETE\s+(CASCADE|RESTRICT|SET\s+DEFAULT|SET\s+NULL|NO\s+ACTION)/g;const o=n.matchAll(s);for(const t of o){const e=t[0];r.push(e)}}catch(t){const e=`getRefs: Error creating regular expression: ${t}`;throw Ie.getRefs(e)}return{tableName:e,foreignKeys:r}}static async getReferencedTableName(t){var e="";if(t.length>0){const r=t.split(new RegExp("REFERENCES","i"));if(r.length===2){const t=r[1].indexOf("(");e=r[1].substring(0,t).trim()}}return e}static async searchForRelatedItems(t,e,r,n,i,s,o){const a=[];let u="";const f=i.map((t=>`t1.${t}`));const c=s.map((t=>`t2.${t}`));try{let l=je.addPrefixToWhereClause(n,s,i,"t2.");if(l.endsWith(";")){l=l.slice(0,-1)}const h=f.map(((t,e)=>`${t} = ${c[e]}`)).join(" AND ");const d=`SELECT t1.rowid FROM ${e} t1 `+`JOIN ${r} t2 ON ${h} `+`WHERE ${l} AND t1.sql_deleted = 0;`;const m=await Ce.queryAll(t,d,o);if(m.length>0){u=Object.keys(m[0])[0];a.push(...m)}return{key:u,relatedItems:a}}catch(t){const e=t.message?t.message:t;throw Ie.searchForRelatedItems(e)}}static async upDateWhereForDefault(t,e){let r="";let n="";try{const i=e.key;const s=[];for(const t of e.relatedItems){const e=t[i];if(e!==undefined){s.push(e)}}for(const e of t){r+=`${e} = NULL, `}r+="sql_deleted = 0";n=`WHERE ${i} IN (`;for(const t of s){n+=`${t},`}if(n.endsWith(",")){n=n.slice(0,-1)}n+=");"}catch(t){const e=t.message?t.message:t;throw Ie.upDateWhereForDefault(e)}return{setStmt:r,uWhereStmt:n}}static async upDateWhereForRestrict(t){try{const e="";const r="";if(t.relatedItems.length>0){const t="Restrict mode related items exist, please delete them first";throw Ie.upDateWhereForRestrict(t)}return{setStmt:e,uWhereStmt:r}}catch(t){const e=t.message?t.message:t;throw Ie.upDateWhereForRestrict(e)}}static async upDateWhereForCascade(t){let e="";let r="";try{const n=t.key;const i=[];for(const e of t.relatedItems){const t=e[n];if(t!==undefined){i.push(t)}}e+="sql_deleted = 1";r=`WHERE ${n} IN (`;for(const t of i){r+=`${t},`}if(r.endsWith(",")){r=r.slice(0,-1)}r+=");"}catch(t){const e=t.message?t.message:t;throw Ie.upDateWhereForCascade(e)}return{setStmt:e,uWhereStmt:r}}static executeUpdateForDelete(t,e,r,n,i,s){try{let o=-1;const a=`UPDATE ${e} SET ${n} ${r}`;const u=[];if(s.length>0){const t=r.split("?");if(t[t.length-1]===";"){t.pop()}for(let e=0;e<t.length;e++){for(const r of i){const n=je.indicesOf(t[e],r);if(n.length>0){u.push(s[e])}}}}const f=Ce.run(t,a,u,false,"no");o=f["lastId"];if(o===-1){const t=`UPDATE sql_deleted failed for table: ${e}`;throw Ie.executeUpdateForDelete(t)}}catch(t){const e=t.message?t.message:t;throw Ie.executeUpdateForDelete(e)}}static getCurrentTimeAsInteger(){const t=Math.floor(Date.now()/1e3);return t}static checkValuesMatch(t,e){for(const r of t){if(!e.includes(r)){return false}}return true}}class Ce{static async beginTransaction(t,e){const r="BeginTransaction: ";if(!e){return Promise.reject(new Error(`${r}database not opened`))}try{t.exec("BEGIN");return Promise.resolve()}catch(t){return Promise.reject(new Error(`${r}${t.message}`))}}static async rollbackTransaction(t,e){const r="RollbackTransaction: ";if(!e){return Promise.reject(new Error(`${r}database not opened`))}try{t.exec("ROLLBACK");return Promise.resolve()}catch(t){return Promise.reject(new Error(`${r}${t.message}`))}}static commitTransaction(t,e){const r="CommitTransaction: ";if(!e){return Promise.reject(new Error(`${r}database not opened`))}const n="COMMIT";try{t.exec(n);return Promise.resolve()}catch(t){return Promise.reject(new Error(`${r}${t.message}`))}}static async dbChanges(t){const e="SELECT total_changes()";let r=0;try{const n=t.exec(e);r=n[0].values[0][0];return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`DbChanges failed: ${t.message}`))}}static async getLastId(t){const e="SELECT last_insert_rowid()";let r=-1;try{const n=t.exec(e);r=n[0].values[0][0];return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`GetLastId failed: ${t.message}`))}}static async setForeignKeyConstraintsEnabled(t,e){let r="PRAGMA foreign_keys=OFF";if(e){r="PRAGMA foreign_keys=ON"}try{t.run(r);return Promise.resolve()}catch(t){const e=t.message?t.message:t;return Promise.reject(new Error(`SetForeignKey: ${e}`))}}static async getVersion(t){let e=0;try{const r=t.exec("PRAGMA user_version;");e=r[0].values[0][0];return Promise.resolve(e)}catch(t){return Promise.reject(new Error(`GetVersion: ${t.message}`))}}static async setVersion(t,e){try{t.exec(`PRAGMA user_version = ${e}`);return Promise.resolve()}catch(t){return Promise.reject(new Error(`SetVersion: ${t.message}`))}}static async execute(t,e,r){try{var n=e;if(!r&&e.toLowerCase().includes("DELETE FROM".toLowerCase())){n=e.replace(/\n/g,"");let r=n.split(";");var i=[];for(const e of r){const r=e.trim().substring(0,11).toUpperCase();if(r==="DELETE FROM"&&e.toLowerCase().includes("WHERE".toLowerCase())){const r=e.trim();const n=await Ce.deleteSQL(t,r,[]);i.push(n)}else{i.push(e)}}n=i.join(";")}t.exec(n);const s=await Ce.dbChanges(t);return Promise.resolve(s)}catch(t){return Promise.reject(new Error(`Execute: ${t.message}`))}}static async executeSet(t,e,r,n){const i=[];let s=-1;let o={};for(let a=0;a<e.length;a++){const u="statement"in e[a]?e[a].statement:null;const f="values"in e[a]&&e[a].values.length>0?e[a].values:[];if(u==null){let t="ExecuteSet: Error No statement";t+=` for index ${a}`;return Promise.reject(new Error(t))}try{if(Array.isArray(f[0])){for(const e of f){const a=await Ce.replaceUndefinedByNull(e);o=await Ce.run(t,u,a,r,n);s=o["lastId"];if(Object.keys(o).includes("values")&&o["values"].length>0){i.push(o["values"])}}}else{const e=await Ce.replaceUndefinedByNull(f);o=await Ce.run(t,u,e,r,n);s=o["lastId"];if(Object.keys(o).includes("values")&&o["values"].length>0){i.push(o["values"])}}}catch(t){return Promise.reject(new Error(`ExecuteSet: ${t.message}`))}}o["lastId"]=s;o["values"]=n==="all"?i:n==="one"?i[0]:[];return Promise.resolve(o)}static async queryAll(t,e,r){try{let n=[];if(r!=null&&r.length>0){n=t.exec(e,r)}else{n=t.exec(e)}if(n.length==0)return Promise.resolve([]);const i=n[0].values.map((t=>{const e={};n[0].columns.forEach(((r,n)=>{e[r]=t[n]}));return e}));return Promise.resolve(i)}catch(t){return Promise.reject(new Error(`queryAll: ${t.message}`))}}static async run(t,e,r,n,i){let s=e.replace(/\n/g,"").trim().substring(0,6).toUpperCase();let o=e;let a=[];let u={};try{if(!n&&s==="DELETE"){o=await Ce.deleteSQL(t,e,r)}const f=r?r:[];if(f.length>0){const e=await Ce.replaceUndefinedByNull(f);const r=t.exec(o,e);if(i==="all"||i==="one"){if(r&&r.length>0){a=Ce.getReturnedValues(r[0],i)}else{return Promise.reject(new Error(`run: ${o} does not returned any change`))}}}else{const e=t.exec(o);if(i==="all"||i==="one"){if(e&&e.length>0){a=Ce.getReturnedValues(e[0],i)}else{return Promise.reject(new Error(`run: ${o} does not returned any change`))}}}const c=await Ce.getLastId(t);u["lastId"]=c;if(a!=null&&a.length>0)u["values"]=a;return Promise.resolve(u)}catch(t){return Promise.reject(new Error(`run: ${t.message}`))}}static getReturnedValues(t,e){const r=[];for(let n=0;n<t.values.length;n++){let i={};for(let e=0;e<t.columns.length;e++){i[t.columns[e]]=t.values[n][e]}r.push(i);if(e==="one")break}return r}static async deleteSQL(t,e,r){let n=e;try{const e=await Ce.isLastModified(t,true);const i=await Ce.isSqlDeleted(t,true);if(!e||!i){return n}const s=je.extractWhereClause(n);if(!s){const t="deleteSQL: cannot find a WHERE clause";return Promise.reject(new Error(`${t}`))}const o=je.extractTableName(n);if(!o){const t="deleteSQL: cannot find a WHERE clause";return Promise.reject(new Error(`${t}`))}const a=je.extractColumnNames(s);if(a.length===0){const t="deleteSQL: Did not find column names in the WHERE Statement";return Promise.reject(new Error(`${t}`))}const u="sql_deleted = 1";const f=await Me.findReferencesAndUpdate(t,o,s,a,r);if(f){const t=s.endsWith(";")?s.slice(0,-1):s;n=`UPDATE ${o} SET ${u} WHERE ${t} AND sql_deleted = 0;`}else{n=""}return Promise.resolve(n)}catch(t){let e=t.message?t.message:t;return Promise.reject(new Error(`deleteSQL: ${e}`))}}static async getTableList(t){try{const e=await De.getTablesNames(t);return Promise.resolve(e)}catch(t){return Promise.reject(new Error(`getTableList: ${t.message}`))}}static async isTableExists(t,e){try{let r="SELECT name FROM sqlite_master WHERE ";r+=`type='table' AND name='${e}';`;const n=await Ce.queryAll(t,r,[]);const i=n.length>0?true:false;return Promise.resolve(i)}catch(t){return Promise.reject(new Error(`isTableExists: ${t.message}`))}}static async isLastModified(t,e){if(!e){return Promise.reject("isLastModified: database not opened")}try{const e=await De.getTablesNames(t);for(const r of e){const e=await Ne.getTableColumnNamesTypes(t,r);const n=e.names;if(n.includes("last_modified")){return Promise.resolve(true)}}}catch(t){return Promise.reject(`isLastModified: ${t}`)}}static async isSqlDeleted(t,e){if(!e){return Promise.reject("isSqlDeleted: database not opened")}try{const e=await De.getTablesNames(t);for(const r of e){const e=await Ne.getTableColumnNamesTypes(t,r);const n=e.names;if(n.includes("sql_deleted")){return Promise.resolve(true)}}}catch(t){return Promise.reject(`isSqlDeleted: ${t}`)}}static async replaceUndefinedByNull(t){const e=[];for(const r of t){let t=r;if(typeof r==="undefined")t=null;e.push(t)}return Promise.resolve(e)}static async backupTables(t){const e="BackupTables: ";let r={};try{const n=await De.getTablesNames(t);for(const i of n){try{const e=await Ce.backupTable(t,i);r[`${i}`]=e}catch(t){return Promise.reject(new Error(`${e}table ${i}: `+`${t.message}`))}}return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`BackupTables: ${t.message}`))}}static async backupTable(t,e){try{await Ce.beginTransaction(t,true);const r=await Ce.getTableColumnNames(t,e);const n=`_temp_${e}`;const i=`DROP TABLE IF EXISTS ${n};`;await Ce.run(t,i,[],false,"no");let s=`ALTER TABLE ${e} RENAME `;s+=`TO ${n};`;const o=await Ce.run(t,s,[],false,"no");if(o<0){let e="BackupTable: lastId < 0";try{await Ce.rollbackTransaction(t,true)}catch(t){e+=`: ${t.message}`}return Promise.reject(new Error(`${e}`))}else{try{await Ce.commitTransaction(t,true);return Promise.resolve(r)}catch(t){return Promise.reject(new Error("BackupTable: "+`${t.message}`))}}}catch(t){return Promise.reject(new Error(`BackupTable: ${t.message}`))}}static async getTableColumnNames(t,e){let r=[];const n=[];const i=`PRAGMA table_info('${e}');`;try{r=await Ce.queryAll(t,i,[]);if(r.length>0){for(const t of r){n.push(t.name)}}return Promise.resolve(n)}catch(t){return Promise.reject(new Error("GetTableColumnNames: "+`${t.message}`))}}static async findCommonColumns(t,e){let r={};try{const n=await De.getTablesNames(t);if(n.length===0){return Promise.reject(new Error("FindCommonColumns: get "+"table's names failed"))}for(const i of n){const n=await Ce.getTableColumnNames(t,i);const s=Object.keys(e);if(s.includes(i)){r[i]=Ce.arraysIntersection(e[i],n)}}return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`FindCommonColumns: ${t.message}`))}}static arraysIntersection(t,e){if(t!=null&&e!=null){const r=new Set(t);const n=new Set(e);return[...r].filter((t=>n.has(t)))}else{return[]}}static async updateNewTablesData(t,e){try{await Ce.beginTransaction(t,true);const r=[];const n=Object.keys(e);n.forEach((t=>{const n=e[t].join(",");let i=`INSERT INTO ${t} `;i+=`(${n}) `;i+=`SELECT ${n} FROM _temp_${t};`;r.push(i)}));const i=await Ce.execute(t,r.join("\n"),false);if(i<0){let e="updateNewTablesData: "+"changes < 0";try{await Ce.rollbackTransaction(t,true)}catch(t){e+=`: ${t.message}`}return Promise.reject(new Error(`${e}`))}else{try{await Ce.commitTransaction(t,true);return Promise.resolve()}catch(t){return Promise.reject(new Error("updateNewTablesData: "+`${t.message}`))}}}catch(t){return Promise.reject(new Error("updateNewTablesData: "+`${t.message}`))}}}class Le{static async createDatabaseSchema(t,e){let r=-1;const n=e.version;try{await Ce.setVersion(t.mDb,n);if(e.mode==="full"){await De.dropAll(t.mDb)}r=await Le.createSchema(t,e);return Promise.resolve(r)}catch(t){return Promise.reject(new Error("CreateDatabaseSchema: "+`${t.message}`))}}static async createSchema(t,e){let r=0;const n=t.mDb;try{await Ce.beginTransaction(n,true);t.setIsTransActive(true)}catch(t){return Promise.reject(new Error(`CreateSchema: ${t.message}`))}const i=await Le.createSchemaStatement(e);if(i.length>0){const e=i.join("\n");try{r=await Ce.execute(n,e,true);if(r<0){try{await Ce.rollbackTransaction(n,true);t.setIsTransActive(false)}catch(t){return Promise.reject(new Error("CreateSchema: changes < 0 "+`${t.message}`))}}}catch(e){const r=e.message;try{await Ce.rollbackTransaction(n,true);t.setIsTransActive(false);return Promise.reject(new Error(`CreateSchema: ${r}`))}catch(t){return Promise.reject(new Error("CreateSchema: changes < 0 "+`${t.message}: ${r}`))}}}try{await Ce.commitTransaction(n,true);t.setIsTransActive(false);return Promise.resolve(r)}catch(t){return Promise.reject(new Error("CreateSchema: commit "+`${t.message}`))}}static async createSchemaStatement(t){const e=[];let r=false;let n=false;try{for(const i of t.tables){if(i.schema!=null&&i.schema.length>=1){e.push("CREATE TABLE IF NOT EXISTS "+`${i.name} (`);for(let t=0;t<i.schema.length;t++){if(t===i.schema.length-1){if(i.schema[t].column){e.push(`${i.schema[t].column} ${i.schema[t].value}`);if(i.schema[t].column==="last_modified"){r=true}if(i.schema[t].column==="sql_deleted"){n=true}}else if(i.schema[t].foreignkey){e.push(`FOREIGN KEY (${i.schema[t].foreignkey}) ${i.schema[t].value}`)}else if(i.schema[t].constraint){e.push(`CONSTRAINT ${i.schema[t].constraint} ${i.schema[t].value}`)}}else{if(i.schema[t].column){e.push(`${i.schema[t].column} ${i.schema[t].value},`)}else if(i.schema[t].foreignkey){e.push(`FOREIGN KEY (${i.schema[t].foreignkey}) ${i.schema[t].value},`)}else if(i.schema[t].primarykey){e.push(`FOREIGN KEY ${i.schema[t].value},`)}else if(i.schema[t].constraint){e.push(`CONSTRAINT ${i.schema[t].constraint} ${i.schema[t].value},`)}}}e.push(");");if(r&&n){let t="CREATE TRIGGER IF NOT EXISTS ";t+=`${i.name}`;t+=`_trigger_last_modified `;t+=`AFTER UPDATE ON ${i.name} `;t+="FOR EACH ROW WHEN NEW.last_modified < ";t+="OLD.last_modified BEGIN UPDATE ";t+=`${i.name} `;t+=`SET last_modified = `;t+="(strftime('%s','now')) WHERE id=OLD.id; END;";e.push(t)}}if(i.indexes!=null&&i.indexes.length>=1){for(const t of i.indexes){const r=i.name;let n=`CREATE ${Object.keys(t).includes("mode")?t.mode+" ":""} INDEX IF NOT EXISTS `;n+=`${t.name} ON ${r} (${t.value});`;e.push(n)}}if(i.triggers!=null&&i.triggers.length>=1){for(const t of i.triggers){const r=i.name;if(t.timeevent.toUpperCase().endsWith(" ON")){t.timeevent=t.timeevent.substring(0,t.timeevent.length-3)}let n=`CREATE TRIGGER IF NOT EXISTS `;n+=`${t.name} ${t.timeevent} ON ${r} `;if(t.condition)n+=`${t.condition} `;n+=`${t.logic};`;e.push(n)}}}return Promise.resolve(e)}catch(t){return Promise.reject(t)}}static async createTablesData(t,e,r){let n=0;let i=false;let s=-1;let o="";let a=-1;const u=t.mDb;try{a=await Ce.dbChanges(u);await Ce.beginTransaction(u,true);t.setIsTransActive(true)}catch(t){return Promise.reject(new Error(`createTablesData: ${t.message}`))}for(const t of e.tables){if(t.values!=null&&t.values.length>=1){try{s=await Le.createTableData(u,t,e.mode);const n=`create table data ${t.name}`;r.emit({progress:n});if(s<0)break;i=true}catch(t){o=t.message;i=false;break}}}if(i){try{await Ce.commitTransaction(u,true);t.setIsTransActive(false);n=await Ce.dbChanges(u)-a;return Promise.resolve(n)}catch(t){return Promise.reject(new Error("CreateTablesData: "+`${t.message}`))}}else{if(o.length>0){try{await Ce.rollbackTransaction(u,true);t.setIsTransActive(false);return Promise.reject(new Error(`CreateTablesData: ${o}`))}catch(t){return Promise.reject(new Error("CreateTablesData: "+`${t.message}: ${o}`))}}else{return Promise.resolve(0)}}}static async createTableData(t,e,r){let n=-1;try{const i=await Ce.isTableExists(t,e.name);if(!i){return Promise.reject(new Error("CreateTableData: Table "+`${e.name} does not exist`))}const s=await Ne.getTableColumnNamesTypes(t,e.name);const o=s.types;const a=s.names;if(o.length===0){return Promise.reject(new Error("CreateTableData: Table "+`${e.name} info does not exist`))}for(let i=0;i<e.values.length;i++){let s=e.values[i];let o=true;const u=await Le.createRowStatement(t,a,s,i,e.name,r);o=await Le.checkUpdate(t,u,s,e.name,a);if(o){if(u.substring(0,6).toUpperCase()==="DELETE"){s=[]}n=await Ce.run(t,u,s,true,"no");if(n<0){return Promise.reject(new Error("CreateTableData: lastId < 0"))}}else{n=0}}return Promise.resolve(n)}catch(t){return Promise.reject(new Error(`CreateTableData: ${t.message}`))}}static async createRowStatement(t,e,r,n,i,s){if(r.length!=e.length||r.length===0||e.length===0){return Promise.reject(new Error(`CreateRowStatement: Table ${i} `+`values row ${n} not correct length`))}try{const o=await Le.isIdExists(t,i,e[0],r[0]);let a;if(s==="full"||s==="partial"&&!o){const t=e.join();const r=await Le.createQuestionMarkString(e.length);a=`INSERT INTO ${i} (${t}) VALUES (`;a+=`${r});`}else{let t=true;const s=t=>t===`sql_deleted`;const o=e.findIndex(s);if(o>=0){if(r[o]===1){t=false;a=`DELETE FROM ${i} WHERE `;if(typeof r[0]=="string"){a+=`${e[0]} = '${r[0]}';`}else{a+=`${e[0]} = ${r[0]};`}}}if(t){const t=await Le.setNameForUpdate(e);if(t.length===0){return Promise.reject(new Error(`CreateRowStatement: Table ${i} `+`values row ${n} not set to String`))}a=`UPDATE ${i} SET ${t} WHERE `;if(typeof r[0]=="string"){a+=`${e[0]} = '${r[0]}';`}else{a+=`${e[0]} = ${r[0]};`}}}return Promise.resolve(a)}catch(t){return Promise.reject(new Error(`CreateRowStatement: ${t.message}`))}}static async checkUpdate(t,e,r,n,i){let s=true;if(e.substring(0,6)==="UPDATE"){try{let e=`SELECT * FROM ${n} WHERE `;if(typeof r[0]=="string"){e+=`${i[0]} = '${r[0]}';`}else{e+=`${i[0]} = ${r[0]};`}const s=await Ne.getValues(t,e,n);let o=[];if(s.length>0){o=s[0]}if(r.length>0&&o.length>0&&r.length===o.length){for(let t=0;t<r.length;t++){if(r[t]!==o[t]){return Promise.resolve(true)}}return Promise.resolve(false)}else{const t="Both arrays not the same length";return Promise.reject(new Error(`CheckUpdate: ${t}`))}}catch(t){return Promise.reject(new Error(`CheckUpdate: ${t.message}`))}}else{return Promise.resolve(s)}}static async isIdExists(t,e,r,n){let i=false;let s=`SELECT ${r} FROM `+`${e} WHERE ${r} = `;if(typeof n==="number")s+=`${n};`;if(typeof n==="string")s+=`'${n}';`;try{const e=await Ce.queryAll(t,s,[]);if(e.length===1)i=true;return Promise.resolve(i)}catch(t){return Promise.reject(new Error(`IsIdExists: ${t.message}`))}}static async isType(t,e){let r=false;if(t==="NULL"&&typeof e==="object")r=true;if(t==="TEXT"&&typeof e==="string")r=true;if(t==="INTEGER"&&typeof e==="number")r=true;if(t==="REAL"&&typeof e==="number")r=true;if(t==="BLOB"&&typeof e==="string")r=true;if(r){return Promise.resolve()}else{return Promise.reject(new Error("IsType: not a SQL Type"))}}static async checkColumnTypes(t,e){for(let r=0;r<e.length;r++){if(e[r]!=null){try{await Le.isType(t[r],e[r])}catch(t){return Promise.reject(new Error("CheckColumnTypes: Type not found"))}}}return Promise.resolve()}static async createQuestionMarkString(t){let e="";for(let r=0;r<t;r++){e+="?,"}if(e.length>1){e=e.slice(0,-1);return Promise.resolve(e)}else{return Promise.reject(new Error("CreateQuestionMarkString: length = 0"))}}static async setNameForUpdate(t){let e="";for(const r of t){e+=`${r} = ? ,`}if(e.length>1){e=e.slice(0,-1);return Promise.resolve(e)}else{return Promise.reject(new Error("SetNameForUpdate: length = 0"))}}static async createView(t,e){const r=`CREATE VIEW IF NOT EXISTS ${e.name} AS ${e.value};`;try{const n=await Ce.execute(t,r,true);if(n<0){return Promise.reject(new Error(`CreateView: ${e.name} failed`))}return Promise.resolve()}catch(t){return Promise.reject(new Error(`CreateView: ${t.message}`))}}static async createViews(t,e){const r=t.mDb;let n=false;let i="";let s=-1;let o=-1;try{s=await Ce.dbChanges(r);await Ce.beginTransaction(r,true);t.setIsTransActive(true)}catch(t){return Promise.reject(new Error(`createViews: ${t.message}`))}for(const t of e.views){if(t.value!=null){try{await Le.createView(r,t);n=true}catch(t){i=t.message;n=false;break}}}if(n){try{await Ce.commitTransaction(r,true);t.setIsTransActive(false);o=await Ce.dbChanges(r)-s;return Promise.resolve(o)}catch(t){return Promise.reject(new Error("createViews: "+`${t.message}`))}}else{if(i.length>0){try{await Ce.rollbackTransaction(r,true);t.setIsTransActive(false);return Promise.reject(new Error(`createViews: ${i}`))}catch(t){return Promise.reject(new Error("createViews: "+`${t.message}: ${i}`))}}else{return Promise.resolve(0)}}}}class xe{static async createExportObject(t,e,r){const n={};let i=[];let s=[];let o="";try{s=await xe.getViewsName(t);const a=await xe.getTablesNameSQL(t);if(a.length===0){return Promise.reject(new Error("createExportObject: table's names failed"))}else{const u=await Ce.isTableExists(t,"sync_table");if(!u&&e.mode==="partial"){return Promise.reject(new Error("No sync_table available"))}switch(e.mode){case"partial":{i=await xe.getTablesPartial(t,a,r);break}case"full":{i=await xe.getTablesFull(t,a,r);break}default:{o="createExportObject: expMode "+e.mode+" not defined";break}}if(o.length>0){return Promise.reject(new Error(o))}if(i.length>0){n.database=e.database;n.version=e.version;n.encrypted=e.encrypted;n.mode=e.mode;n.tables=i;if(s.length>0){n.views=s}}return Promise.resolve(n)}}catch(t){return Promise.reject(new Error("createExportObject: "+t.message))}}static async getViewsName(t){const e=[];let r="SELECT name,sql FROM sqlite_master WHERE ";r+="type='view' AND name NOT LIKE 'sqlite_%';";let n=[];try{n=await Ce.queryAll(t,r,[]);for(const t of n){const r={};r.name=t.name;r.value=t.sql.substring(t.sql.indexOf("AS ")+3);e.push(r)}return Promise.resolve(e)}catch(t){return Promise.reject(new Error(`getViewsName: ${t.message}`))}}static async getTablesFull(t,e,r){const n=[];let i="";try{for(const s of e){let e;let o;if(s.name){e=s.name}else{i="GetTablesFull: no name";break}if(s.sql){o=s.sql}else{i="GetTablesFull: no sql";break}const a={};const u=await xe.getSchema(o);if(u.length===0){i="GetTablesFull: no Schema returned";break}await Ne.checkSchemaValidity(u);const f=await xe.getIndexes(t,e);if(f.length>0){await Ne.checkIndexesValidity(f)}const c=await xe.getTriggers(t,e);if(c.length>0){await Ne.checkTriggersValidity(c)}let l=`Full: Table ${e} schema export completed ...`;r.emit({progress:l});const h=`SELECT * FROM ${e};`;const d=await Ne.getValues(t,h,e);a.name=e;if(u.length>0){a.schema=u}else{i=`GetTablesFull: must contain schema`;break}if(f.length>0){a.indexes=f}if(c.length>0){a.triggers=c}if(d.length>0){a.values=d}if(Object.keys(a).length<=1){i=`GetTablesFull: table ${e} is not a jsonTable`;break}l=`Full: Table ${e} table data export completed ...`;r.emit({progress:l});n.push(a)}if(i.length>0){return Promise.reject(new Error(i))}return Promise.resolve(n)}catch(t){return Promise.reject(new Error(`GetTablesFull: ${t.message}`))}}static async getSchema(t){const e=[];const r=t.indexOf("(");const n=t.lastIndexOf(")");let i=t.substring(r+1,n);try{i=await xe.modEmbeddedParentheses(i);const t=i.split(",");for(let r=0;r<t.length;r++){let n=[];const i=t[r].replace(/\n/g,"").trim();n[0]=i.substring(0,i.indexOf(" "));n[1]=i.substring(i.indexOf(" ")+1);const s={};if(n[0].toUpperCase()==="FOREIGN"){const t=i.indexOf("(");const e=i.indexOf(")");const r=i.substring(t+1,e);const o=r.split("§");n[0]=o.join(",");n[0]=n[0].replace(/, /g,",");n[1]=i.substring(e+2);s["foreignkey"]=n[0]}else if(n[0].toUpperCase()==="PRIMARY"){const t=i.indexOf("(");const e=i.indexOf(")");const r=i.substring(t+1,e);const o=r.split("§");n[0]="CPK_"+o.join("_");n[0]=n[0].replace(/_ /g,"_");n[1]=i;s["constraint"]=n[0]}else if(n[0].toUpperCase()==="CONSTRAINT"){let t=[];const e=n[1].trim();t[0]=e.substring(0,e.indexOf(" "));t[1]=e.substring(e.indexOf(" ")+1);n[0]=t[0];s["constraint"]=n[0];n[1]=t[1]}else{s["column"]=n[0]}s["value"]=n[1].replace(/§/g,",");e.push(s)}return Promise.resolve(e)}catch(t){return Promise.reject(new Error(t.message))}}static async getIndexes(t,e){const r=[];let n="";try{let i="SELECT name,tbl_name,sql FROM sqlite_master WHERE ";i+=`type = 'index' AND tbl_name = '${e}' `;i+=`AND sql NOTNULL;`;const s=await Ce.queryAll(t,i,[]);if(s.length>0){for(const t of s){const i=Object.keys(t);if(i.length===3){if(t["tbl_name"]===e){const e=t["sql"];const n=e.includes("UNIQUE")?"UNIQUE":"";const i=e.lastIndexOf("(");const s=e.lastIndexOf(")");const o={};o.name=t["name"];o.value=e.slice(i+1,s);if(n.length>0)o.mode=n;r.push(o)}else{n=`GetIndexes: Table ${e} doesn't match`;break}}else{n=`GetIndexes: Table ${e} creating indexes`;break}}if(n.length>0){return Promise.reject(new Error(n))}}return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`GetIndexes: ${t.message}`))}}static async getTriggers(t,e){const r=[];try{let n="SELECT name,tbl_name,sql FROM sqlite_master WHERE ";n+=`type = 'trigger' AND tbl_name = '${e}' `;n+=`AND sql NOT NULL;`;const i=await Ce.queryAll(t,n,[]);if(i.length>0){for(const t of i){const n=Object.keys(t);if(n.length===3){if(t["tbl_name"]===e){const n=t["sql"];const i=t["name"];let s=n.split(i);if(s.length!=2){return Promise.reject(new Error(`GetTriggers: sql split name does not return 2 values`))}if(!s[1].includes(e)){return Promise.reject(new Error(`GetTriggers: sql split does not contains ${e}`))}const o=s[1].split(e,1)[0].trim();s=s[1].split(o+" "+e);if(s.length!=2){return Promise.reject(new Error(`GetTriggers: sql split tableName does not return 2 values`))}let a="";let u="";if(s[1].trim().substring(0,5).toUpperCase()!=="BEGIN"){s=s[1].trim().split("BEGIN");if(s.length!=2){return Promise.reject(new Error(`GetTriggers: sql split BEGIN does not return 2 values`))}a=s[0].trim();u="BEGIN"+s[1]}else{u=s[1].trim()}const f={};f.name=i;f.logic=u;if(a.length>0)f.condition=a;f.timeevent=o;r.push(f)}else{return Promise.reject(new Error(`GetTriggers: Table ${e} doesn't match`))}}else{return Promise.reject(new Error(`GetTriggers: Table ${e} creating indexes`))}}}return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`GetTriggers: ${t.message}`))}}static async getTablesPartial(t,e,r){const n=[];let i={};let s=0;let o=[];let a="";try{const u=await xe.getPartialModeData(t,e);if(Object.keys(u).includes("syncDate")){s=u.syncDate}if(Object.keys(u).includes("modTables")){i=u.modTables;o=Object.keys(i)}for(const u of e){let e="";let f="";if(u.name){e=u.name}else{a="GetTablesFull: no name";break}if(u.sql){f=u.sql}else{a="GetTablesFull: no sql";break}if(o.length==0||o.indexOf(e)===-1||i[e]=="No"){continue}const c={};let l=[];let h=[];let d=[];c.name=u;if(i[c.name]==="Create"){l=await xe.getSchema(f);if(l.length>0){await Ne.checkSchemaValidity(l)}h=await xe.getIndexes(t,e);if(h.length>0){await Ne.checkIndexesValidity(h)}d=await xe.getTriggers(t,e);if(d.length>0){await Ne.checkTriggersValidity(d)}}let m=`Partial: Table ${e} schema export completed ...`;r.emit({progress:m});let w="";if(i[e]==="Create"){w=`SELECT * FROM ${e};`}else{w=`SELECT * FROM ${e} `+`WHERE last_modified > ${s};`}const v=await Ne.getValues(t,w,e);c.name=e;if(l.length>0){c.schema=l}if(h.length>0){c.indexes=h}if(d.length>0){c.triggers=d}if(v.length>0){c.values=v}if(Object.keys(c).length<=1){a=`GetTablesPartial: table ${e} is not a jsonTable`;break}m=`Partial: Table ${e} table data export completed ...`;r.emit({progress:m});n.push(c)}if(a.length>0){return Promise.reject(new Error(a))}return Promise.resolve(n)}catch(t){return Promise.reject(new Error(`GetTablesPartial: ${t.message}`))}}static async getPartialModeData(t,e){const r={};try{const n=await xe.getSynchroDate(t);if(n<=0){return Promise.reject(new Error(`GetPartialModeData: no syncDate`))}const i=await xe.getTablesModified(t,e,n);if(i.length<=0){return Promise.reject(new Error(`GetPartialModeData: no modTables`))}r.syncDate=n;r.modTables=i;return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`GetPartialModeData: ${t.message}`))}}static async getTablesNameSQL(t){let e="SELECT name,sql FROM sqlite_master WHERE ";e+="type='table' AND name NOT LIKE 'sync_table' ";e+="AND name NOT LIKE '_temp_%' ";e+="AND name NOT LIKE 'sqlite_%';";try{const r=await Ce.queryAll(t,e,[]);return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`getTablesNamesSQL: ${t.message}`))}}static async getTablesModified(t,e,r){let n="";try{const i={};for(const s of e){let e;let o="SELECT count(*) AS tcount  ";o+=`FROM ${s.name};`;let a=await Ce.queryAll(t,o,[]);if(a.length!=1){n="GetTableModified: total "+"count not returned";break}const u=a[0]["tcount"];o="SELECT count(*) AS mcount FROM ";o+=`${s.name} WHERE last_modified > `;o+=`${r};`;a=await Ce.queryAll(t,o,[]);if(a.length!=1)break;const f=a[0]["mcount"];if(f===0){e="No"}else if(u===f){e="Create"}else{e="Modified"}const c=s.name;i[c]=e}if(n.length>0){return Promise.reject(new Error(n))}return Promise.resolve(i)}catch(t){return Promise.reject(new Error(`GetTableModified: ${t.message}`))}}static async getSynchroDate(t){try{const e=`SELECT sync_date FROM sync_table WHERE id = 1;`;const r=await Ce.queryAll(t,e,[]);return Promise.resolve(r[0]["sync_date"])}catch(t){const e=`GetSynchroDate: ${t.message}`;return Promise.reject(new Error(e))}}static async getLastExportDate(t){try{const e=`SELECT sync_date FROM sync_table WHERE id = 2;`;const r=await Ce.queryAll(t,e,[]);if(r.length===0){return Promise.resolve(-1)}else{return Promise.resolve(r[0]["sync_date"])}}catch(t){const e=`getLastExport: ${t.message}`;return Promise.reject(new Error(e))}}static async setLastExportDate(t,e){try{const r=await Ce.isTableExists(t,"sync_table");if(!r){return Promise.reject(new Error("setLastExportDate: No sync_table available"))}const n=Math.round(new Date(e).getTime()/1e3);let i="";if(await xe.getLastExportDate(t)>0){i=`UPDATE sync_table SET sync_date = ${n} WHERE id = 2;`}else{i=`INSERT INTO sync_table (sync_date) VALUES (${n});`}const s=await Ce.execute(t,i,false);if(s<0){return{result:false,message:"setLastExportDate failed"}}else{return{result:true}}}catch(t){return{result:false,message:`setLastExportDate failed: ${t.message}`}}}static async delExportedRows(t){let e;try{const r=await Ce.isTableExists(t,"sync_table");if(!r){return Promise.reject(new Error("DelExportedRows: No sync_table available"))}e=await xe.getLastExportDate(t);if(e<0){return Promise.reject(new Error("DelExportedRows: no last exported date available"))}const n=await Ce.getTableList(t);if(n.length===0){return Promise.reject(new Error("DelExportedRows: No table's names returned"))}for(const r of n){let n=-1;const i=`DELETE FROM ${r}\n              WHERE sql_deleted = 1 AND last_modified < ${e};`;n=await Ce.run(t,i,[],true,"no");if(n<0){return Promise.reject(new Error("DelExportedRows: lastId < 0"))}}}catch(t){return Promise.reject(new Error(`DelExportedRows failed: ${t.message}`))}}static async modEmbeddedParentheses(t){const e=xe.indexOfChar(t,"(");const r=xe.indexOfChar(t,")");if(e.length!=r.length){return Promise.reject("ModEmbeddedParentheses: Not same number of '(' & ')'")}if(e.length===0){return Promise.resolve(t)}let n=t.substring(0,e[0]-1);for(let i=0;i<e.length;i++){let s;if(i<e.length-1){if(e[i+1]<r[i]){s=t.substring(e[i]-1,r[i+1]);i++}else{s=t.substring(e[i]-1,r[i])}}else{s=t.substring(e[i]-1,r[i])}const o=s.replace(/,/g,"§");n+=o;if(i<e.length-1){n+=t.substring(r[i],e[i+1]-1)}}n+=t.substring(r[r.length-1],t.length);return Promise.resolve(n)}static indexOfChar(t,e){let r=[...t];e=e.toLowerCase();return r.reduce(((t,r,n)=>r.toLowerCase()===e?[...t,n]:t),[])}}class Be{static async onUpgrade(t,e,r,n){let i=-1;const s=new Int32Array(Object.keys(e).map((t=>parseInt(t)))).sort();for(const o of s){if(o>r&&o<=n){const r=e[o].statements;if(r.length===0){return Promise.reject("onUpgrade: statements not given")}try{await Ce.setForeignKeyConstraintsEnabled(t.mDb,false);const e=await Ce.dbChanges(t.mDb);await Be.executeStatementsProcess(t,r);await Ce.setVersion(t.mDb,o);await Ce.setForeignKeyConstraintsEnabled(t.mDb,true);i=await Ce.dbChanges(t.mDb)-e}catch(t){return Promise.reject(new Error(`onUpgrade: ${t.message}`))}}}return Promise.resolve(i)}static async executeStatementsProcess(t,e){try{await Ce.beginTransaction(t.mDb,true);t.setIsTransActive(true);for(const r of e){await Ce.execute(t.mDb,r,false)}await Ce.commitTransaction(t.mDb,true);t.setIsTransActive(false);return Promise.resolve()}catch(e){await Ce.rollbackTransaction(t.mDb,true);t.setIsTransActive(false);return Promise.reject(`ExecuteStatementProcess: ${e}`)}}}class Fe{constructor(t,e,r,n,i,s){this.vUpgDict={};this.autoSave=false;this.wasmPath="/assets";this.isBackup=false;this.isTransactionActive=false;this.dbName=t;this.store=n;this.version=e;this.mDb=null;this.vUpgDict=r;this._isDBOpen=false;this.autoSave=i;this.wasmPath=s}async open(){const t={locateFile:t=>`${this.wasmPath}/${t}`};return new Promise(((e,r)=>{try{Ae(t).then((async t=>{const n=await Re.getDBFromStore(this.dbName,this.store);if(n!=null){this.mDb=new t.Database(n)}else{this.mDb=new t.Database;await Re.setInitialDBToStore(this.dbName,this.store)}this._isDBOpen=true;let i=await Ce.getVersion(this.mDb);if(this.version>i&&Object.keys(this.vUpgDict).length>0){try{const t=await Re.isDBInStore(this.dbName,this.store);if(t){await Re.copyDBToStore(this.dbName,`backup-${this.dbName}`,this.store);this.isBackup=true}const e=await Be.onUpgrade(this,this.vUpgDict,i,this.version);if(e===-1){try{if(this.isBackup){await Re.restoreDBFromStore(this.dbName,"backup",this.store)}}catch(t){return r(new Error(`Open: ${t.message}`))}}if(this.isBackup){await Re.removeDBFromStore(`backup-${this.dbName}`,this.store)}}catch(t){try{if(this.isBackup){await Re.restoreDBFromStore(this.dbName,"backup",this.store)}}catch(t){return r(new Error(`Open: ${t.message}`))}}}if(this.autoSave){try{await this.saveToStore()}catch(t){this._isDBOpen=false;return r(`Open: ${t}`)}}await Ce.setForeignKeyConstraintsEnabled(this.mDb,true);return e()}))}catch(t){this._isDBOpen=false;return r(`in open ${t}`)}}))}isDBOpen(){return this._isDBOpen}async close(){if(this.mDb!=null&&this._isDBOpen){try{await this.saveToStore(false);this.mDb.close();this._isDBOpen=false}catch(t){this._isDBOpen=false;return Promise.reject(`in close ${t}`)}}return Promise.resolve()}async saveToStore(t=true){if(this.mDb!=null&&this._isDBOpen){try{await Re.setDBToStore(this.mDb,this.dbName,this.store);if(t){await Ce.setForeignKeyConstraintsEnabled(this.mDb,true)}}catch(t){return Promise.reject(`in saveToStore ${t}`)}}return Promise.resolve()}async exportDB(){try{const t=this.mDb.export();return t}catch(t){const e=t.message?t.message:t;return Promise.reject(`exportDB: ${e}`)}}async getVersion(){if(this.mDb!=null&&this._isDBOpen){try{const t=await Ce.getVersion(this.mDb);return Promise.resolve(t)}catch(t){this._isDBOpen=false;return Promise.reject(`in getVersion ${t}`)}}}async isDBExists(t){try{const e=await Re.isDBInStore(t,this.store);return Promise.resolve(e)}catch(t){return Promise.reject(`in isDBExists ${t}`)}}async deleteDB(t){try{const e=await this.isDBExists(t);if(e&&!this._isDBOpen){await this.open()}await this.close();if(e){await Re.removeDBFromStore(t,this.store)}return Promise.resolve()}catch(t){return Promise.reject(new Error(`DeleteDB: ${t.message}`))}}async beginTransaction(){if(!this._isDBOpen){let t=`BeginTransaction: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}try{await Ce.beginTransaction(this.mDb,true);this.setIsTransActive(true);return 0}catch(t){let e=`BeginTransaction: ${t.message}`;return Promise.reject(new Error(`${e}`))}}async commitTransaction(){if(!this._isDBOpen){let t=`CommitTransaction: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}try{await Ce.commitTransaction(this.mDb,true);this.setIsTransActive(false);return 0}catch(t){let e=`CommitTransaction: ${t.message}`;return Promise.reject(new Error(`${e}`))}}async rollbackTransaction(){if(!this._isDBOpen){let t=`RollbackTransaction: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}try{await Ce.rollbackTransaction(this.mDb,true);this.setIsTransActive(false);return 0}catch(t){let e=`RollbackTransaction: ${t.message}`;return Promise.reject(new Error(`${e}`))}}isTransActive(){return this.isTransactionActive}setIsTransActive(t){this.isTransactionActive=t}async executeSQL(t,e=true){if(!this._isDBOpen){let t=`ExecuteSQL: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}let r=-1;try{r=await Ce.dbChanges(this.mDb);if(e&&!this.isTransactionActive){await this.beginTransaction()}}catch(t){let e=`executeSQL: ${t.message}`;return Promise.reject(new Error(`${e}`))}try{const n=await Ce.execute(this.mDb,t,false);if(n<0){return Promise.reject(new Error("ExecuteSQL: changes < 0"))}if(e&&this.isTransactionActive){await this.commitTransaction()}const i=await Ce.dbChanges(this.mDb)-r;return Promise.resolve(i)}catch(t){let r=`ExecuteSQL: ${t.message}`;try{if(e&&this.isTransactionActive)await this.rollbackTransaction()}catch(t){r+=` : ${t.message}`}return Promise.reject(new Error(`ExecuteSQL: ${r}`))}finally{if(e)this.isTransactionActive=false;if(this.autoSave){try{await this.saveToStore()}catch(t){this._isDBOpen=false;return Promise.reject(`ExecuteSQL: ${t}`)}}}}async execSet(t,e=true,r="no"){if(!this._isDBOpen){let t=`ExecSet: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}const n={changes:-1,lastId:-1};let i=-1;try{i=await Ce.dbChanges(this.mDb);if(e&&!this.isTransactionActive){await this.beginTransaction()}}catch(t){let e=`ExecSet: ${t.message}`;return Promise.reject(new Error(`${e}`))}try{const s=await Ce.executeSet(this.mDb,t,false,r);let o=s["lastId"];if(o<0){return Promise.reject(new Error("ExecSet: changes < 0"))}if(e&&this.isTransactionActive)await this.commitTransaction();const a=await Ce.dbChanges(this.mDb)-i;n.changes=a;n.lastId=o;n.values=s["values"]?s["values"]:[];return Promise.resolve(n)}catch(t){let r=`ExecSet: ${t.message}`;try{if(e&&this.isTransactionActive)await this.rollbackTransaction()}catch(t){r+=` : ${t.message}`}return Promise.reject(new Error(`ExecSet: ${r}`))}finally{if(e)this.isTransactionActive=false;if(this.autoSave){try{await this.saveToStore()}catch(t){this._isDBOpen=false;return Promise.reject(`ExecSet: ${t}`)}}}}async selectSQL(t,e){if(!this._isDBOpen){let t=`SelectSQL: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}try{let r=await Ce.queryAll(this.mDb,t,e);return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`SelectSQL: ${t.message}`))}}async runSQL(t,e,r=true,n){let i=-1;if(!this._isDBOpen){let t=`RunSQL: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}const s={changes:-1,lastId:-1};let o=-1;try{o=await Ce.dbChanges(this.mDb);if(r&&!this.isTransactionActive){await this.beginTransaction()}}catch(t){let e=`RunSQL: ${t.message}`;return Promise.reject(new Error(`${e}`))}try{const a=await Ce.run(this.mDb,t,e,false,n);i=a["lastId"];if(i<0){return Promise.reject(new Error("RunSQL: lastId < 0"))}if(r&&this.isTransactionActive){await this.commitTransaction()}const u=await Ce.dbChanges(this.mDb)-o;s.changes=u;s.lastId=i;s.values=a["values"]?a["values"]:[];return Promise.resolve(s)}catch(t){let e=`RunSQL: ${t.message}`;try{if(r&&this.isTransactionActive){await this.rollbackTransaction()}}catch(t){e+=` : ${t.message}`}return Promise.reject(new Error(`${e}`))}finally{if(r)this.setIsTransActive(false);if(this.autoSave){try{await this.saveToStore()}catch(t){this._isDBOpen=false;return Promise.reject(`ExecSet: ${t}`)}}}}async getTableNames(){if(!this._isDBOpen){let t=`GetTableNames: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}try{let t=await Ce.getTableList(this.mDb);return Promise.resolve(t)}catch(t){return Promise.reject(new Error(`GetTableNames: ${t.message}`))}}async isTable(t){if(!this._isDBOpen){let t=`isTable: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}try{const e=await Ce.isTableExists(this.mDb,t);return Promise.resolve(e)}catch(t){const e=`IsTable: ${t.message}`;return Promise.reject(new Error(e))}}async createSyncTable(){if(!this._isDBOpen){let t=`createSyncTable: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}let t=-1;try{const e=await Ce.isTableExists(this.mDb,"sync_table");if(!e){const e=await Ce.isLastModified(this.mDb,this._isDBOpen);const r=await Ce.isSqlDeleted(this.mDb,this._isDBOpen);if(e&&r){const e=Math.round((new Date).getTime()/1e3);let r=`\n                          CREATE TABLE IF NOT EXISTS sync_table (\n                              id INTEGER PRIMARY KEY NOT NULL,\n                              sync_date INTEGER\n                              );`;r+=`INSERT INTO sync_table (sync_date) VALUES (\n                              "${e}");`;t=await Ce.execute(this.mDb,r,false);return Promise.resolve(t)}else{return Promise.reject(new Error("No last_modified/sql_deleted columns in tables"))}}else{return Promise.resolve(0)}}catch(t){const e=`CreateSyncTable: ${t.message}`;return Promise.reject(new Error(e))}}async getSyncDate(){if(!this._isDBOpen){let t=`getSyncDate: Database ${this.dbName} `;t+=`not opened`;return Promise.reject(new Error(t))}try{const t=await Ce.isTableExists(this.mDb,"sync_table");if(!t){return Promise.reject(new Error("No sync_table available"))}const e=await xe.getSynchroDate(this.mDb);return Promise.resolve(e)}catch(t){const e=`getSyncDate: ${t.message}`;return Promise.reject(new Error(e))}}async setSyncDate(t){if(!this._isDBOpen){let t=`SetSyncDate: Database ${this.dbName} `;t+=`not opened`;return{result:false,message:t}}try{const e=await Ce.isTableExists(this.mDb,"sync_table");if(!e){return Promise.reject(new Error("No sync_table available"))}const r=Math.round(new Date(t).getTime()/1e3);let n=`UPDATE sync_table SET sync_date = `;n+=`${r} WHERE id = 1;`;const i=await Ce.execute(this.mDb,n,false);if(i<0){return{result:false,message:"setSyncDate failed"}}else{return{result:true}}}catch(t){return{result:false,message:`setSyncDate failed: ${t.message}`}}}async importJson(t,e){let r=0;if(this._isDBOpen){try{await Ce.setForeignKeyConstraintsEnabled(this.mDb,false);if(t.tables&&t.tables.length>0){r=await Le.createDatabaseSchema(this,t);let n=`Schema creation completed changes: ${r}`;e.emit({progress:n});if(r!=-1){r+=await Le.createTablesData(this,t,e);let n=`Tables data creation completed changes: ${r}`;e.emit({progress:n})}}if(t.views&&t.views.length>0){r+=await Le.createViews(this,t)}await Ce.setForeignKeyConstraintsEnabled(this.mDb,true);await this.saveToStore();return Promise.resolve(r)}catch(t){return Promise.reject(new Error(`ImportJson: ${t.message}`))}}else{return Promise.reject(new Error(`ImportJson: database is closed`))}}async exportJson(t,e){const r={};r.database=this.dbName.slice(0,-9);r.version=this.version;r.encrypted=false;r.mode=t;if(this._isDBOpen){try{const t=await Ce.isTableExists(this.mDb,"sync_table");if(t){await xe.setLastExportDate(this.mDb,(new Date).toISOString())}const n=await xe.createExportObject(this.mDb,r,e);const i=Object.keys(n);if(i.length===0){const t=`ExportJson: return Object is empty `+`No data to synchronize`;return Promise.reject(new Error(t))}const s=Ne.isJsonSQLite(n);if(s){return Promise.resolve(n)}else{return Promise.reject(new Error(`ExportJson: retJson not valid`))}}catch(t){return Promise.reject(new Error(`ExportJson: ${t.message}`))}}else{return Promise.reject(new Error(`ExportJson: database is closed`))}}async deleteExportedRows(){if(this._isDBOpen){try{await xe.delExportedRows(this.mDb);return Promise.resolve()}catch(t){return Promise.reject(new Error(`deleteExportedRows: ${t.message}`))}}else{return Promise.reject(new Error(`deleteExportedRows: database is closed`))}}}var Ue=se((function(t,e){
/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/
(function(e){{t.exports=e()}})((function(){return function t(e,r,n){function i(o,a){if(!r[o]){if(!e[o]){var u=typeof ae=="function"&&ae;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=r[o]={exports:{}};e[o][0].call(c.exports,(function(t){var r=e[o][1][t];return i(r?r:t)}),c,c.exports,t,e,r,n)}return r[o].exports}var s=typeof ae=="function"&&ae;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,e,r){(function(t){var r=t.MutationObserver||t.WebKitMutationObserver;var n;{if(r){var i=0;var s=new r(c);var o=t.document.createTextNode("");s.observe(o,{characterData:true});n=function(){o.data=i=++i%2}}else if(!t.setImmediate&&typeof t.MessageChannel!=="undefined"){var a=new t.MessageChannel;a.port1.onmessage=c;n=function(){a.port2.postMessage(0)}}else if("document"in t&&"onreadystatechange"in t.document.createElement("script")){n=function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c();e.onreadystatechange=null;e.parentNode.removeChild(e);e=null};t.document.documentElement.appendChild(e)}}else{n=function(){setTimeout(c,0)}}}var u;var f=[];function c(){u=true;var t,e;var r=f.length;while(r){e=f;f=[];t=-1;while(++t<r){e[t]()}r=f.length}u=false}e.exports=l;function l(t){if(f.push(t)===1&&!u){n()}}}).call(this,typeof ie!=="undefined"?ie:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(t,e,r){var n=t(1);function i(){}var s={};var o=["REJECTED"];var a=["FULFILLED"];var u=["PENDING"];e.exports=f;function f(t){if(typeof t!=="function"){throw new TypeError("resolver must be a function")}this.state=u;this.queue=[];this.outcome=void 0;if(t!==i){d(this,t)}}f.prototype["catch"]=function(t){return this.then(null,t)};f.prototype.then=function(t,e){if(typeof t!=="function"&&this.state===a||typeof e!=="function"&&this.state===o){return this}var r=new this.constructor(i);if(this.state!==u){var n=this.state===a?t:e;l(r,n,this.outcome)}else{this.queue.push(new c(r,t,e))}return r};function c(t,e,r){this.promise=t;if(typeof e==="function"){this.onFulfilled=e;this.callFulfilled=this.otherCallFulfilled}if(typeof r==="function"){this.onRejected=r;this.callRejected=this.otherCallRejected}}c.prototype.callFulfilled=function(t){s.resolve(this.promise,t)};c.prototype.otherCallFulfilled=function(t){l(this.promise,this.onFulfilled,t)};c.prototype.callRejected=function(t){s.reject(this.promise,t)};c.prototype.otherCallRejected=function(t){l(this.promise,this.onRejected,t)};function l(t,e,r){n((function(){var n;try{n=e(r)}catch(e){return s.reject(t,e)}if(n===t){s.reject(t,new TypeError("Cannot resolve promise with itself"))}else{s.resolve(t,n)}}))}s.resolve=function(t,e){var r=m(h,e);if(r.status==="error"){return s.reject(t,r.value)}var n=r.value;if(n){d(t,n)}else{t.state=a;t.outcome=e;var i=-1;var o=t.queue.length;while(++i<o){t.queue[i].callFulfilled(e)}}return t};s.reject=function(t,e){t.state=o;t.outcome=e;var r=-1;var n=t.queue.length;while(++r<n){t.queue[r].callRejected(e)}return t};function h(t){var e=t&&t.then;if(t&&(typeof t==="object"||typeof t==="function")&&typeof e==="function"){return function r(){e.apply(t,arguments)}}}function d(t,e){var r=false;function n(e){if(r){return}r=true;s.reject(t,e)}function i(e){if(r){return}r=true;s.resolve(t,e)}function o(){e(i,n)}var a=m(o);if(a.status==="error"){n(a.value)}}function m(t,e){var r={};try{r.value=t(e);r.status="success"}catch(t){r.status="error";r.value=t}return r}f.resolve=w;function w(t){if(t instanceof this){return t}return s.resolve(new this(i),t)}f.reject=v;function v(t){var e=new this(i);return s.reject(e,t)}f.all=y;function y(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]"){return this.reject(new TypeError("must be an array"))}var r=t.length;var n=false;if(!r){return this.resolve([])}var o=new Array(r);var a=0;var u=-1;var f=new this(i);while(++u<r){c(t[u],u)}return f;function c(t,i){e.resolve(t).then(u,(function(t){if(!n){n=true;s.reject(f,t)}}));function u(t){o[i]=t;if(++a===r&&!n){n=true;s.resolve(f,o)}}}}f.race=b;function b(t){var e=this;if(Object.prototype.toString.call(t)!=="[object Array]"){return this.reject(new TypeError("must be an array"))}var r=t.length;var n=false;if(!r){return this.resolve([])}var o=-1;var a=new this(i);while(++o<r){u(t[o])}return a;function u(t){e.resolve(t).then((function(t){if(!n){n=true;s.resolve(a,t)}}),(function(t){if(!n){n=true;s.reject(a,t)}}))}}},{1:1}],3:[function(t,e,r){(function(e){if(typeof e.Promise!=="function"){e.Promise=t(2)}}).call(this,typeof ie!=="undefined"?ie:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{2:2}],4:[function(t,e,r){var n=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function i(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function s(){try{if(typeof indexedDB!=="undefined"){return indexedDB}if(typeof webkitIndexedDB!=="undefined"){return webkitIndexedDB}if(typeof mozIndexedDB!=="undefined"){return mozIndexedDB}if(typeof OIndexedDB!=="undefined"){return OIndexedDB}if(typeof msIndexedDB!=="undefined"){return msIndexedDB}}catch(t){return}}var o=s();function a(){try{if(!o||!o.open){return false}var t=typeof openDatabase!=="undefined"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform);var e=typeof fetch==="function"&&fetch.toString().indexOf("[native code")!==-1;return(!t||e)&&typeof indexedDB!=="undefined"&&typeof IDBKeyRange!=="undefined"}catch(t){return false}}function u(t,e){t=t||[];e=e||{};try{return new Blob(t,e)}catch(s){if(s.name!=="TypeError"){throw s}var r=typeof BlobBuilder!=="undefined"?BlobBuilder:typeof MSBlobBuilder!=="undefined"?MSBlobBuilder:typeof MozBlobBuilder!=="undefined"?MozBlobBuilder:WebKitBlobBuilder;var n=new r;for(var i=0;i<t.length;i+=1){n.append(t[i])}return n.getBlob(e.type)}}if(typeof Promise==="undefined"){t(3)}var f=Promise;function c(t,e){if(e){t.then((function(t){e(null,t)}),(function(t){e(t)}))}}function l(t,e,r){if(typeof e==="function"){t.then(e)}if(typeof r==="function"){t["catch"](r)}}function h(t){if(typeof t!=="string"){console.warn(t+" used as a key, but it is not a string.");t=String(t)}return t}function d(){if(arguments.length&&typeof arguments[arguments.length-1]==="function"){return arguments[arguments.length-1]}}var m="local-forage-detect-blob-support";var w=void 0;var v={};var y=Object.prototype.toString;var b="readonly";var p="readwrite";function E(t){var e=t.length;var r=new ArrayBuffer(e);var n=new Uint8Array(r);for(var i=0;i<e;i++){n[i]=t.charCodeAt(i)}return r}function g(t){return new f((function(e){var r=t.transaction(m,p);var n=u([""]);r.objectStore(m).put(n,"key");r.onabort=function(t){t.preventDefault();t.stopPropagation();e(false)};r.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/);var r=navigator.userAgent.match(/Edge\//);e(r||!t||parseInt(t[1],10)>=43)}}))["catch"]((function(){return false}))}function P(t){if(typeof w==="boolean"){return f.resolve(w)}return g(t).then((function(t){w=t;return w}))}function S(t){var e=v[t.name];var r={};r.promise=new f((function(t,e){r.resolve=t;r.reject=e}));e.deferredOperations.push(r);if(!e.dbReady){e.dbReady=r.promise}else{e.dbReady=e.dbReady.then((function(){return r.promise}))}}function T(t){var e=v[t.name];var r=e.deferredOperations.pop();if(r){r.resolve();return r.promise}}function $(t,e){var r=v[t.name];var n=r.deferredOperations.pop();if(n){n.reject(e);return n.promise}}function k(t,e){return new f((function(r,n){v[t.name]=v[t.name]||C();if(t.db){if(e){S(t);t.db.close()}else{return r(t.db)}}var i=[t.name];if(e){i.push(t.version)}var s=o.open.apply(o,i);if(e){s.onupgradeneeded=function(e){var r=s.result;try{r.createObjectStore(t.storeName);if(e.oldVersion<=1){r.createObjectStore(m)}}catch(r){if(r.name==="ConstraintError"){console.warn('The database "'+t.name+'"'+" has been upgraded from version "+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}else{throw r}}}}s.onerror=function(t){t.preventDefault();n(s.error)};s.onsuccess=function(){var e=s.result;e.onversionchange=function(t){t.target.close()};r(e);T(t)}}))}function O(t){return k(t,false)}function _(t){return k(t,true)}function A(t,e){if(!t.db){return true}var r=!t.db.objectStoreNames.contains(t.storeName);var n=t.version<t.db.version;var i=t.version>t.db.version;if(n){if(t.version!==e){console.warn('The database "'+t.name+'"'+" can't be downgraded from version "+t.db.version+" to version "+t.version+".")}t.version=t.db.version}if(i||r){if(r){var s=t.db.version+1;if(s>t.version){t.version=s}}return true}return false}function R(t){return new f((function(e,r){var n=new FileReader;n.onerror=r;n.onloadend=function(r){var n=btoa(r.target.result||"");e({__local_forage_encoded_blob:true,data:n,type:t.type})};n.readAsBinaryString(t)}))}function D(t){var e=E(atob(t.data));return u([e],{type:t.type})}function N(t){return t&&t.__local_forage_encoded_blob}function j(t){var e=this;var r=e._initReady().then((function(){var t=v[e._dbInfo.name];if(t&&t.dbReady){return t.dbReady}}));l(r,t,t);return r}function I(t){S(t);var e=v[t.name];var r=e.forages;for(var n=0;n<r.length;n++){var i=r[n];if(i._dbInfo.db){i._dbInfo.db.close();i._dbInfo.db=null}}t.db=null;return O(t).then((function(e){t.db=e;if(A(t)){return _(t)}return e})).then((function(n){t.db=e.db=n;for(var i=0;i<r.length;i++){r[i]._dbInfo.db=n}}))["catch"]((function(e){$(t,e);throw e}))}function M(t,e,r,n){if(n===undefined){n=1}try{var i=t.db.transaction(t.storeName,e);r(null,i)}catch(i){if(n>0&&(!t.db||i.name==="InvalidStateError"||i.name==="NotFoundError")){return f.resolve().then((function(){if(!t.db||i.name==="NotFoundError"&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version){if(t.db){t.version=t.db.version+1}return _(t)}})).then((function(){return I(t).then((function(){M(t,e,r,n-1)}))}))["catch"](r)}r(i)}}function C(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function L(t){var e=this;var r={db:null};if(t){for(var n in t){r[n]=t[n]}}var i=v[r.name];if(!i){i=C();v[r.name]=i}i.forages.push(e);if(!e._initReady){e._initReady=e.ready;e.ready=j}var s=[];function o(){return f.resolve()}for(var a=0;a<i.forages.length;a++){var u=i.forages[a];if(u!==e){s.push(u._initReady()["catch"](o))}}var c=i.forages.slice(0);return f.all(s).then((function(){r.db=i.db;return O(r)})).then((function(t){r.db=t;if(A(r,e._defaultConfig.version)){return _(r)}return t})).then((function(t){r.db=i.db=t;e._dbInfo=r;for(var n=0;n<c.length;n++){var s=c[n];if(s!==e){s._dbInfo.db=r.db;s._dbInfo.version=r.version}}}))}function x(t,e){var r=this;t=h(t);var n=new f((function(e,n){r.ready().then((function(){M(r._dbInfo,b,(function(i,s){if(i){return n(i)}try{var o=s.objectStore(r._dbInfo.storeName);var a=o.get(t);a.onsuccess=function(){var t=a.result;if(t===undefined){t=null}if(N(t)){t=D(t)}e(t)};a.onerror=function(){n(a.error)}}catch(t){n(t)}}))}))["catch"](n)}));c(n,e);return n}function B(t,e){var r=this;var n=new f((function(e,n){r.ready().then((function(){M(r._dbInfo,b,(function(i,s){if(i){return n(i)}try{var o=s.objectStore(r._dbInfo.storeName);var a=o.openCursor();var u=1;a.onsuccess=function(){var r=a.result;if(r){var n=r.value;if(N(n)){n=D(n)}var i=t(n,r.key,u++);if(i!==void 0){e(i)}else{r["continue"]()}}else{e()}};a.onerror=function(){n(a.error)}}catch(t){n(t)}}))}))["catch"](n)}));c(n,e);return n}function F(t,e,r){var n=this;t=h(t);var i=new f((function(r,i){var s;n.ready().then((function(){s=n._dbInfo;if(y.call(e)==="[object Blob]"){return P(s.db).then((function(t){if(t){return e}return R(e)}))}return e})).then((function(e){M(n._dbInfo,p,(function(s,o){if(s){return i(s)}try{var a=o.objectStore(n._dbInfo.storeName);if(e===null){e=undefined}var u=a.put(e,t);o.oncomplete=function(){if(e===undefined){e=null}r(e)};o.onabort=o.onerror=function(){var t=u.error?u.error:u.transaction.error;i(t)}}catch(t){i(t)}}))}))["catch"](i)}));c(i,r);return i}function U(t,e){var r=this;t=h(t);var n=new f((function(e,n){r.ready().then((function(){M(r._dbInfo,p,(function(i,s){if(i){return n(i)}try{var o=s.objectStore(r._dbInfo.storeName);var a=o["delete"](t);s.oncomplete=function(){e()};s.onerror=function(){n(a.error)};s.onabort=function(){var t=a.error?a.error:a.transaction.error;n(t)}}catch(t){n(t)}}))}))["catch"](n)}));c(n,e);return n}function q(t){var e=this;var r=new f((function(t,r){e.ready().then((function(){M(e._dbInfo,p,(function(n,i){if(n){return r(n)}try{var s=i.objectStore(e._dbInfo.storeName);var o=s.clear();i.oncomplete=function(){t()};i.onabort=i.onerror=function(){var t=o.error?o.error:o.transaction.error;r(t)}}catch(t){r(t)}}))}))["catch"](r)}));c(r,t);return r}function W(t){var e=this;var r=new f((function(t,r){e.ready().then((function(){M(e._dbInfo,b,(function(n,i){if(n){return r(n)}try{var s=i.objectStore(e._dbInfo.storeName);var o=s.count();o.onsuccess=function(){t(o.result)};o.onerror=function(){r(o.error)}}catch(t){r(t)}}))}))["catch"](r)}));c(r,t);return r}function G(t,e){var r=this;var n=new f((function(e,n){if(t<0){e(null);return}r.ready().then((function(){M(r._dbInfo,b,(function(i,s){if(i){return n(i)}try{var o=s.objectStore(r._dbInfo.storeName);var a=false;var u=o.openKeyCursor();u.onsuccess=function(){var r=u.result;if(!r){e(null);return}if(t===0){e(r.key)}else{if(!a){a=true;r.advance(t)}else{e(r.key)}}};u.onerror=function(){n(u.error)}}catch(t){n(t)}}))}))["catch"](n)}));c(n,e);return n}function z(t){var e=this;var r=new f((function(t,r){e.ready().then((function(){M(e._dbInfo,b,(function(n,i){if(n){return r(n)}try{var s=i.objectStore(e._dbInfo.storeName);var o=s.openKeyCursor();var a=[];o.onsuccess=function(){var e=o.result;if(!e){t(a);return}a.push(e.key);e["continue"]()};o.onerror=function(){r(o.error)}}catch(t){r(t)}}))}))["catch"](r)}));c(r,t);return r}function H(t,e){e=d.apply(this,arguments);var r=this.config();t=typeof t!=="function"&&t||{};if(!t.name){t.name=t.name||r.name;t.storeName=t.storeName||r.storeName}var n=this;var i;if(!t.name){i=f.reject("Invalid arguments")}else{var s=t.name===r.name&&n._dbInfo.db;var a=s?f.resolve(n._dbInfo.db):O(t).then((function(e){var r=v[t.name];var n=r.forages;r.db=e;for(var i=0;i<n.length;i++){n[i]._dbInfo.db=e}return e}));if(!t.storeName){i=a.then((function(e){S(t);var r=v[t.name];var n=r.forages;e.close();for(var i=0;i<n.length;i++){var s=n[i];s._dbInfo.db=null}var a=new f((function(e,r){var n=o.deleteDatabase(t.name);n.onerror=function(){var t=n.result;if(t){t.close()}r(n.error)};n.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')};n.onsuccess=function(){var t=n.result;if(t){t.close()}e(t)}}));return a.then((function(t){r.db=t;for(var e=0;e<n.length;e++){var i=n[e];T(i._dbInfo)}}))["catch"]((function(e){($(t,e)||f.resolve())["catch"]((function(){}));throw e}))}))}else{i=a.then((function(e){if(!e.objectStoreNames.contains(t.storeName)){return}var r=e.version+1;S(t);var n=v[t.name];var i=n.forages;e.close();for(var s=0;s<i.length;s++){var a=i[s];a._dbInfo.db=null;a._dbInfo.version=r}var u=new f((function(e,n){var i=o.open(t.name,r);i.onerror=function(t){var e=i.result;e.close();n(t)};i.onupgradeneeded=function(){var e=i.result;e.deleteObjectStore(t.storeName)};i.onsuccess=function(){var t=i.result;t.close();e(t)}}));return u.then((function(t){n.db=t;for(var e=0;e<i.length;e++){var r=i[e];r._dbInfo.db=t;T(r._dbInfo)}}))["catch"]((function(e){($(t,e)||f.resolve())["catch"]((function(){}));throw e}))}))}}c(i,e);return i}var V={_driver:"asyncStorage",_initStorage:L,_support:a(),iterate:B,getItem:x,setItem:F,removeItem:U,clear:q,length:W,key:G,keys:z,dropInstance:H};function Q(){return typeof openDatabase==="function"}var K="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var Z="~~local_forage_type~";var J=/^~~local_forage_type~([^~]+)~/;var X="__lfsc__:";var Y=X.length;var tt="arbf";var et="blob";var rt="si08";var nt="ui08";var it="uic8";var st="si16";var ot="si32";var at="ur16";var ut="ui32";var ft="fl32";var ct="fl64";var lt=Y+tt.length;var ht=Object.prototype.toString;function dt(t){var e=t.length*.75;var r=t.length;var n;var i=0;var s,o,a,u;if(t[t.length-1]==="="){e--;if(t[t.length-2]==="="){e--}}var f=new ArrayBuffer(e);var c=new Uint8Array(f);for(n=0;n<r;n+=4){s=K.indexOf(t[n]);o=K.indexOf(t[n+1]);a=K.indexOf(t[n+2]);u=K.indexOf(t[n+3]);c[i++]=s<<2|o>>4;c[i++]=(o&15)<<4|a>>2;c[i++]=(a&3)<<6|u&63}return f}function mt(t){var e=new Uint8Array(t);var r="";var n;for(n=0;n<e.length;n+=3){r+=K[e[n]>>2];r+=K[(e[n]&3)<<4|e[n+1]>>4];r+=K[(e[n+1]&15)<<2|e[n+2]>>6];r+=K[e[n+2]&63]}if(e.length%3===2){r=r.substring(0,r.length-1)+"="}else if(e.length%3===1){r=r.substring(0,r.length-2)+"=="}return r}function wt(t,e){var r="";if(t){r=ht.call(t)}if(t&&(r==="[object ArrayBuffer]"||t.buffer&&ht.call(t.buffer)==="[object ArrayBuffer]")){var n;var i=X;if(t instanceof ArrayBuffer){n=t;i+=tt}else{n=t.buffer;if(r==="[object Int8Array]"){i+=rt}else if(r==="[object Uint8Array]"){i+=nt}else if(r==="[object Uint8ClampedArray]"){i+=it}else if(r==="[object Int16Array]"){i+=st}else if(r==="[object Uint16Array]"){i+=at}else if(r==="[object Int32Array]"){i+=ot}else if(r==="[object Uint32Array]"){i+=ut}else if(r==="[object Float32Array]"){i+=ft}else if(r==="[object Float64Array]"){i+=ct}else{e(new Error("Failed to get type for BinaryArray"))}}e(i+mt(n))}else if(r==="[object Blob]"){var s=new FileReader;s.onload=function(){var r=Z+t.type+"~"+mt(this.result);e(X+et+r)};s.readAsArrayBuffer(t)}else{try{e(JSON.stringify(t))}catch(r){console.error("Couldn't convert value into a JSON string: ",t);e(null,r)}}}function vt(t){if(t.substring(0,Y)!==X){return JSON.parse(t)}var e=t.substring(lt);var r=t.substring(Y,lt);var n;if(r===et&&J.test(e)){var i=e.match(J);n=i[1];e=e.substring(i[0].length)}var s=dt(e);switch(r){case tt:return s;case et:return u([s],{type:n});case rt:return new Int8Array(s);case nt:return new Uint8Array(s);case it:return new Uint8ClampedArray(s);case st:return new Int16Array(s);case at:return new Uint16Array(s);case ot:return new Int32Array(s);case ut:return new Uint32Array(s);case ft:return new Float32Array(s);case ct:return new Float64Array(s);default:throw new Error("Unkown type: "+r)}}var yt={serialize:wt,deserialize:vt,stringToBuffer:dt,bufferToString:mt};function bt(t,e,r,n){t.executeSql("CREATE TABLE IF NOT EXISTS "+e.storeName+" "+"(id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function pt(t){var e=this;var r={db:null};if(t){for(var n in t){r[n]=typeof t[n]!=="string"?t[n].toString():t[n]}}var i=new f((function(t,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(t){return n(t)}r.db.transaction((function(i){bt(i,r,(function(){e._dbInfo=r;t()}),(function(t,e){n(e)}))}),n)}));r.serializer=yt;return i}function Et(t,e,r,n,i,s){t.executeSql(r,n,i,(function(t,o){if(o.code===o.SYNTAX_ERR){t.executeSql("SELECT name FROM sqlite_master "+"WHERE type='table' AND name = ?",[e.storeName],(function(t,a){if(!a.rows.length){bt(t,e,(function(){t.executeSql(r,n,i,s)}),s)}else{s(t,o)}}),s)}else{s(t,o)}}),s)}function gt(t,e){var r=this;t=h(t);var n=new f((function(e,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){Et(r,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[t],(function(t,r){var n=r.rows.length?r.rows.item(0).value:null;if(n){n=i.serializer.deserialize(n)}e(n)}),(function(t,e){n(e)}))}))}))["catch"](n)}));c(n,e);return n}function Pt(t,e){var r=this;var n=new f((function(e,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){Et(r,i,"SELECT * FROM "+i.storeName,[],(function(r,n){var s=n.rows;var o=s.length;for(var a=0;a<o;a++){var u=s.item(a);var f=u.value;if(f){f=i.serializer.deserialize(f)}f=t(f,u.key,a+1);if(f!==void 0){e(f);return}}e()}),(function(t,e){n(e)}))}))}))["catch"](n)}));c(n,e);return n}function St(t,e,r,n){var i=this;t=h(t);var s=new f((function(s,o){i.ready().then((function(){if(e===undefined){e=null}var a=e;var u=i._dbInfo;u.serializer.serialize(e,(function(e,f){if(f){o(f)}else{u.db.transaction((function(r){Et(r,u,"INSERT OR REPLACE INTO "+u.storeName+" "+"(key, value) VALUES (?, ?)",[t,e],(function(){s(a)}),(function(t,e){o(e)}))}),(function(e){if(e.code===e.QUOTA_ERR){if(n>0){s(St.apply(i,[t,a,r,n-1]));return}o(e)}}))}}))}))["catch"](o)}));c(s,r);return s}function Tt(t,e,r){return St.apply(this,[t,e,r,1])}function $t(t,e){var r=this;t=h(t);var n=new f((function(e,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){Et(r,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[t],(function(){e()}),(function(t,e){n(e)}))}))}))["catch"](n)}));c(n,e);return n}function kt(t){var e=this;var r=new f((function(t,r){e.ready().then((function(){var n=e._dbInfo;n.db.transaction((function(e){Et(e,n,"DELETE FROM "+n.storeName,[],(function(){t()}),(function(t,e){r(e)}))}))}))["catch"](r)}));c(r,t);return r}function Ot(t){var e=this;var r=new f((function(t,r){e.ready().then((function(){var n=e._dbInfo;n.db.transaction((function(e){Et(e,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],(function(e,r){var n=r.rows.item(0).c;t(n)}),(function(t,e){r(e)}))}))}))["catch"](r)}));c(r,t);return r}function _t(t,e){var r=this;var n=new f((function(e,n){r.ready().then((function(){var i=r._dbInfo;i.db.transaction((function(r){Et(r,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[t+1],(function(t,r){var n=r.rows.length?r.rows.item(0).key:null;e(n)}),(function(t,e){n(e)}))}))}))["catch"](n)}));c(n,e);return n}function At(t){var e=this;var r=new f((function(t,r){e.ready().then((function(){var n=e._dbInfo;n.db.transaction((function(e){Et(e,n,"SELECT key FROM "+n.storeName,[],(function(e,r){var n=[];for(var i=0;i<r.rows.length;i++){n.push(r.rows.item(i).key)}t(n)}),(function(t,e){r(e)}))}))}))["catch"](r)}));c(r,t);return r}function Rt(t){return new f((function(e,r){t.transaction((function(n){n.executeSql("SELECT name FROM sqlite_master "+"WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(r,n){var i=[];for(var s=0;s<n.rows.length;s++){i.push(n.rows.item(s).name)}e({db:t,storeNames:i})}),(function(t,e){r(e)}))}),(function(t){r(t)}))}))}function Dt(t,e){e=d.apply(this,arguments);var r=this.config();t=typeof t!=="function"&&t||{};if(!t.name){t.name=t.name||r.name;t.storeName=t.storeName||r.storeName}var n=this;var i;if(!t.name){i=f.reject("Invalid arguments")}else{i=new f((function(e){var i;if(t.name===r.name){i=n._dbInfo.db}else{i=openDatabase(t.name,"","",0)}if(!t.storeName){e(Rt(i))}else{e({db:i,storeNames:[t.storeName]})}})).then((function(t){return new f((function(e,r){t.db.transaction((function(n){function i(t){return new f((function(e,r){n.executeSql("DROP TABLE IF EXISTS "+t,[],(function(){e()}),(function(t,e){r(e)}))}))}var s=[];for(var o=0,a=t.storeNames.length;o<a;o++){s.push(i(t.storeNames[o]))}f.all(s).then((function(){e()}))["catch"]((function(t){r(t)}))}),(function(t){r(t)}))}))}))}c(i,e);return i}var Nt={_driver:"webSQLStorage",_initStorage:pt,_support:Q(),iterate:Pt,getItem:gt,setItem:Tt,removeItem:$t,clear:kt,length:Ot,key:_t,keys:At,dropInstance:Dt};function jt(){try{return typeof localStorage!=="undefined"&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return false}}function It(t,e){var r=t.name+"/";if(t.storeName!==e.storeName){r+=t.storeName+"/"}return r}function Mt(){var t="_localforage_support_test";try{localStorage.setItem(t,true);localStorage.removeItem(t);return false}catch(t){return true}}function Ct(){return!Mt()||localStorage.length>0}function Lt(t){var e=this;var r={};if(t){for(var n in t){r[n]=t[n]}}r.keyPrefix=It(t,e._defaultConfig);if(!Ct()){return f.reject()}e._dbInfo=r;r.serializer=yt;return f.resolve()}function xt(t){var e=this;var r=e.ready().then((function(){var t=e._dbInfo.keyPrefix;for(var r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);if(n.indexOf(t)===0){localStorage.removeItem(n)}}}));c(r,t);return r}function Bt(t,e){var r=this;t=h(t);var n=r.ready().then((function(){var e=r._dbInfo;var n=localStorage.getItem(e.keyPrefix+t);if(n){n=e.serializer.deserialize(n)}return n}));c(n,e);return n}function Ft(t,e){var r=this;var n=r.ready().then((function(){var e=r._dbInfo;var n=e.keyPrefix;var i=n.length;var s=localStorage.length;var o=1;for(var a=0;a<s;a++){var u=localStorage.key(a);if(u.indexOf(n)!==0){continue}var f=localStorage.getItem(u);if(f){f=e.serializer.deserialize(f)}f=t(f,u.substring(i),o++);if(f!==void 0){return f}}}));c(n,e);return n}function Ut(t,e){var r=this;var n=r.ready().then((function(){var e=r._dbInfo;var n;try{n=localStorage.key(t)}catch(t){n=null}if(n){n=n.substring(e.keyPrefix.length)}return n}));c(n,e);return n}function qt(t){var e=this;var r=e.ready().then((function(){var t=e._dbInfo;var r=localStorage.length;var n=[];for(var i=0;i<r;i++){var s=localStorage.key(i);if(s.indexOf(t.keyPrefix)===0){n.push(s.substring(t.keyPrefix.length))}}return n}));c(r,t);return r}function Wt(t){var e=this;var r=e.keys().then((function(t){return t.length}));c(r,t);return r}function Gt(t,e){var r=this;t=h(t);var n=r.ready().then((function(){var e=r._dbInfo;localStorage.removeItem(e.keyPrefix+t)}));c(n,e);return n}function zt(t,e,r){var n=this;t=h(t);var i=n.ready().then((function(){if(e===undefined){e=null}var r=e;return new f((function(i,s){var o=n._dbInfo;o.serializer.serialize(e,(function(e,n){if(n){s(n)}else{try{localStorage.setItem(o.keyPrefix+t,e);i(r)}catch(t){if(t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED"){s(t)}s(t)}}}))}))}));c(i,r);return i}function Ht(t,e){e=d.apply(this,arguments);t=typeof t!=="function"&&t||{};if(!t.name){var r=this.config();t.name=t.name||r.name;t.storeName=t.storeName||r.storeName}var n=this;var i;if(!t.name){i=f.reject("Invalid arguments")}else{i=new f((function(e){if(!t.storeName){e(t.name+"/")}else{e(It(t,n._defaultConfig))}})).then((function(t){for(var e=localStorage.length-1;e>=0;e--){var r=localStorage.key(e);if(r.indexOf(t)===0){localStorage.removeItem(r)}}}))}c(i,e);return i}var Vt={_driver:"localStorageWrapper",_initStorage:Lt,_support:jt(),iterate:Ft,getItem:Bt,setItem:zt,removeItem:Gt,clear:xt,length:Wt,key:Ut,keys:qt,dropInstance:Ht};var Qt=function t(e,r){return e===r||typeof e==="number"&&typeof r==="number"&&isNaN(e)&&isNaN(r)};var Kt=function t(e,r){var n=e.length;var i=0;while(i<n){if(Qt(e[i],r)){return true}i++}return false};var Zt=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};var Jt={};var Xt={};var Yt={INDEXEDDB:V,WEBSQL:Nt,LOCALSTORAGE:Vt};var te=[Yt.INDEXEDDB._driver,Yt.WEBSQL._driver,Yt.LOCALSTORAGE._driver];var ee=["dropInstance"];var re=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ee);var ne={description:"",driver:te.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ie(t,e){t[e]=function(){var r=arguments;return t.ready().then((function(){return t[e].apply(t,r)}))}}function se(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e){for(var r in e){if(e.hasOwnProperty(r)){if(Zt(e[r])){arguments[0][r]=e[r].slice()}else{arguments[0][r]=e[r]}}}}}return arguments[0]}var oe=function(){function t(e){i(this,t);for(var r in Yt){if(Yt.hasOwnProperty(r)){var n=Yt[r];var s=n._driver;this[r]=s;if(!Jt[s]){this.defineDriver(n)}}}this._defaultConfig=se({},ne);this._config=se({},this._defaultConfig,e);this._driverSet=null;this._initDriver=null;this._ready=false;this._dbInfo=null;this._wrapLibraryMethodsWithReady();this.setDriver(this._config.driver)["catch"]((function(){}))}t.prototype.config=function t(e){if((typeof e==="undefined"?"undefined":n(e))==="object"){if(this._ready){return new Error("Can't call config() after localforage "+"has been used.")}for(var r in e){if(r==="storeName"){e[r]=e[r].replace(/\W/g,"_")}if(r==="version"&&typeof e[r]!=="number"){return new Error("Database version must be a number.")}this._config[r]=e[r]}if("driver"in e&&e.driver){return this.setDriver(this._config.driver)}return true}else if(typeof e==="string"){return this._config[e]}else{return this._config}};t.prototype.defineDriver=function t(e,r,n){var i=new f((function(t,r){try{var n=e._driver;var i=new Error("Custom driver not compliant; see "+"https://mozilla.github.io/localForage/#definedriver");if(!e._driver){r(i);return}var s=re.concat("_initStorage");for(var o=0,a=s.length;o<a;o++){var u=s[o];var l=!Kt(ee,u);if((l||e[u])&&typeof e[u]!=="function"){r(i);return}}var h=function t(){var r=function t(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver");var r=f.reject(t);c(r,arguments[arguments.length-1]);return r}};for(var n=0,i=ee.length;n<i;n++){var s=ee[n];if(!e[s]){e[s]=r(s)}}};h();var d=function r(i){if(Jt[n]){console.info("Redefining LocalForage driver: "+n)}Jt[n]=e;Xt[n]=i;t()};if("_support"in e){if(e._support&&typeof e._support==="function"){e._support().then(d,r)}else{d(!!e._support)}}else{d(true)}}catch(t){r(t)}}));l(i,r,n);return i};t.prototype.driver=function t(){return this._driver||null};t.prototype.getDriver=function t(e,r,n){var i=Jt[e]?f.resolve(Jt[e]):f.reject(new Error("Driver not found."));l(i,r,n);return i};t.prototype.getSerializer=function t(e){var r=f.resolve(yt);l(r,e);return r};t.prototype.ready=function t(e){var r=this;var n=r._driverSet.then((function(){if(r._ready===null){r._ready=r._initDriver()}return r._ready}));l(n,e,e);return n};t.prototype.setDriver=function t(e,r,n){var i=this;if(!Zt(e)){e=[e]}var s=this._getSupportedDrivers(e);function o(){i._config.driver=i.driver()}function a(t){i._extend(t);o();i._ready=i._initStorage(i._config);return i._ready}function u(t){return function(){var e=0;function r(){while(e<t.length){var n=t[e];e++;i._dbInfo=null;i._ready=null;return i.getDriver(n).then(a)["catch"](r)}o();var s=new Error("No available storage method found.");i._driverSet=f.reject(s);return i._driverSet}return r()}}var c=this._driverSet!==null?this._driverSet["catch"]((function(){return f.resolve()})):f.resolve();this._driverSet=c.then((function(){var t=s[0];i._dbInfo=null;i._ready=null;return i.getDriver(t).then((function(t){i._driver=t._driver;o();i._wrapLibraryMethodsWithReady();i._initDriver=u(s)}))}))["catch"]((function(){o();var t=new Error("No available storage method found.");i._driverSet=f.reject(t);return i._driverSet}));l(this._driverSet,r,n);return this._driverSet};t.prototype.supports=function t(e){return!!Xt[e]};t.prototype._extend=function t(e){se(this,e)};t.prototype._getSupportedDrivers=function t(e){var r=[];for(var n=0,i=e.length;n<i;n++){var s=e[n];if(this.supports(s)){r.push(s)}}return r};t.prototype._wrapLibraryMethodsWithReady=function t(){for(var e=0,r=re.length;e<r;e++){ie(this,re[e])}};t.prototype.createInstance=function e(r){return new t(r)};return t}();var ae=new oe;e.exports=ae},{3:3}]},{},[4])(4)}))}));var qe=se((function(t,e){
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/
!function(e){t.exports=e()}((function(){return function t(e,r,n){function i(o,a){if(!r[o]){if(!e[o]){var u="function"==typeof ae&&ae;if(!a&&u)return u(o,!0);if(s)return s(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var c=r[o]={exports:{}};e[o][0].call(c.exports,(function(t){var r=e[o][1][t];return i(r||t)}),c,c.exports,t,e,r,n)}return r[o].exports}for(var s="function"==typeof ae&&ae,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(t,e,r){var n=t("./utils"),i=t("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t){for(var e,r,i,o,a,u,f,c=[],l=0,h=t.length,d=h,m="string"!==n.getTypeOf(t);l<t.length;)d=h-l,i=m?(e=t[l++],r=l<h?t[l++]:0,l<h?t[l++]:0):(e=t.charCodeAt(l++),r=l<h?t.charCodeAt(l++):0,l<h?t.charCodeAt(l++):0),o=e>>2,a=(3&e)<<4|r>>4,u=1<d?(15&r)<<2|i>>6:64,f=2<d?63&i:64,c.push(s.charAt(o)+s.charAt(a)+s.charAt(u)+s.charAt(f));return c.join("")},r.decode=function(t){var e,r,n,o,a,u,f=0,c=0,l="data:";if(t.substr(0,l.length)===l)throw new Error("Invalid base64 input, it looks like a data url.");var h,d=3*(t=t.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(t.charAt(t.length-1)===s.charAt(64)&&d--,t.charAt(t.length-2)===s.charAt(64)&&d--,d%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=i.uint8array?new Uint8Array(0|d):new Array(0|d);f<t.length;)e=s.indexOf(t.charAt(f++))<<2|(o=s.indexOf(t.charAt(f++)))>>4,r=(15&o)<<4|(a=s.indexOf(t.charAt(f++)))>>2,n=(3&a)<<6|(u=s.indexOf(t.charAt(f++))),h[c++]=e,64!==a&&(h[c++]=r),64!==u&&(h[c++]=n);return h}},{"./support":30,"./utils":32}],2:[function(t,e,r){var n=t("./external"),i=t("./stream/DataWorker"),s=t("./stream/Crc32Probe"),o=t("./stream/DataLengthProbe");function a(t,e,r,n,i){this.compressedSize=t,this.uncompressedSize=e,this.crc32=r,this.compression=n,this.compressedContent=i}a.prototype={getContentWorker:function(){var t=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(t,e,r){return t.pipe(new s).pipe(new o("uncompressedSize")).pipe(e.compressWorker(r)).pipe(new o("compressedSize")).withStreamInfo("compression",e)},e.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,r){var n=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,r){var n=t("./utils");var i=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==n.getTypeOf(t)?function(t,e,r,n){var s=i,o=n+r;t^=-1;for(var a=n;a<o;a++)t=t>>>8^s[255&(t^e[a])];return-1^t}(0|e,t,t.length,0):function(t,e,r,n){var s=i,o=n+r;t^=-1;for(var a=n;a<o;a++)t=t>>>8^s[255&(t^e.charCodeAt(a))];return-1^t}(0|e,t,t.length,0):0}},{"./utils":32}],5:[function(t,e,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,e,r){var n=null;n="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:n}},{lie:37}],7:[function(t,e,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=t("pako"),s=t("./utils"),o=t("./stream/GenericWorker"),a=n?"uint8array":"array";function u(t,e){o.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}r.magic="\b\0",s.inherits(u,o),u.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(a,t.data),!1)},u.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},r.compressWorker=function(t){return new u("Deflate",t)},r.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,r){function n(t,e){var r,n="";for(r=0;r<e;r++)n+=String.fromCharCode(255&t),t>>>=8;return n}function i(t,e,r,i,o,c){var l,h,d=t.file,m=t.compression,w=c!==a.utf8encode,v=s.transformTo("string",c(d.name)),y=s.transformTo("string",a.utf8encode(d.name)),b=d.comment,p=s.transformTo("string",c(b)),E=s.transformTo("string",a.utf8encode(b)),g=y.length!==d.name.length,P=E.length!==b.length,S="",T="",$="",k=d.dir,O=d.date,_={crc32:0,compressedSize:0,uncompressedSize:0};e&&!r||(_.crc32=t.crc32,_.compressedSize=t.compressedSize,_.uncompressedSize=t.uncompressedSize);var A=0;e&&(A|=8),w||!g&&!P||(A|=2048);var R=0,D=0;k&&(R|=16),"UNIX"===o?(D=798,R|=function(t,e){var r=t;return t||(r=e?16893:33204),(65535&r)<<16}(d.unixPermissions,k)):(D=20,R|=function(t){return 63&(t||0)}(d.dosPermissions)),l=O.getUTCHours(),l<<=6,l|=O.getUTCMinutes(),l<<=5,l|=O.getUTCSeconds()/2,h=O.getUTCFullYear()-1980,h<<=4,h|=O.getUTCMonth()+1,h<<=5,h|=O.getUTCDate(),g&&(T=n(1,1)+n(u(v),4)+y,S+="up"+n(T.length,2)+T),P&&($=n(1,1)+n(u(p),4)+E,S+="uc"+n($.length,2)+$);var N="";return N+="\n\0",N+=n(A,2),N+=m.magic,N+=n(l,2),N+=n(h,2),N+=n(_.crc32,4),N+=n(_.compressedSize,4),N+=n(_.uncompressedSize,4),N+=n(v.length,2),N+=n(S.length,2),{fileRecord:f.LOCAL_FILE_HEADER+N+v+S,dirRecord:f.CENTRAL_FILE_HEADER+n(D,2)+N+n(p.length,2)+"\0\0\0\0"+n(R,4)+n(i,4)+v+S+p}}var s=t("../utils"),o=t("../stream/GenericWorker"),a=t("../utf8"),u=t("../crc32"),f=t("../signature");function c(t,e,r,n){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(c,o),c.prototype.push=function(t){var e=t.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,o.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(e+100*(r-n-1))/r:100}}))},c.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var r=i(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},c.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,r=i(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),e)this.push({data:function(t){return f.DATA_DESCRIPTOR+n(t.crc32,4)+n(t.compressedSize,4)+n(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},c.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var r=this.bytesWritten-t,i=function(t,e,r,i,o){var a=s.transformTo("string",o(i));return f.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(t,2)+n(t,2)+n(e,4)+n(r,4)+n(a.length,2)+a}(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})},c.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},c.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},c.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},c.prototype.error=function(t){var e=this._sources;if(!o.prototype.error.call(this,t))return!1;for(var r=0;r<e.length;r++)try{e[r].error(t)}catch(t){}return!0},c.prototype.lock=function(){o.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=c},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,r){var n=t("../compressions"),i=t("./ZipFileWorker");r.generateWorker=function(t,e,r){var s=new i(e.streamFiles,r,e.platform,e.encodeFileName),o=0;try{t.forEach((function(t,r){o++;var i=function(t,e){var r=t||e,i=n[r];if(!i)throw new Error(r+" is not a valid compression method !");return i}(r.options.compression,e.compression),a=r.options.compressionOptions||e.compressionOptions||{},u=r.dir,f=r.date;r._compressWorker(i,a).withStreamInfo("file",{name:t,dir:u,date:f,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(s)})),s.entriesCount=o}catch(t){s.error(t)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new n;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(n.prototype=t("./object")).loadAsync=t("./load"),n.support=t("./support"),n.defaults=t("./defaults"),n.version="3.10.1",n.loadAsync=function(t,e){return(new n).loadAsync(t,e)},n.external=t("./external"),e.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,r){var n=t("./utils"),i=t("./external"),s=t("./utf8"),o=t("./zipEntries"),a=t("./stream/Crc32Probe"),u=t("./nodejsUtils");function f(t){return new i.Promise((function(e,r){var n=t.decompressed.getContentWorker().pipe(new a);n.on("error",(function(t){r(t)})).on("end",(function(){n.streamInfo.crc32!==t.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var r=this;return e=n.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),u.isNode&&u.isStream(t)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var r=new o(e);return r.load(t),r})).then((function(t){var r=[i.Promise.resolve(t)],n=t.files;if(e.checkCRC32)for(var s=0;s<n.length;s++)r.push(f(n[s]));return i.Promise.all(r)})).then((function(t){for(var i=t.shift(),s=i.files,o=0;o<s.length;o++){var a=s[o],u=a.fileNameStr,f=n.resolve(a.fileNameStr);r.file(f,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:e.createFolders}),a.dir||(r.file(f).unsafeOriginalName=u)}return i.zipComment.length&&(r.comment=i.zipComment),r}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,r){var n=t("../utils"),i=t("../stream/GenericWorker");function s(t,e){i.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}n.inherits(s,i),s.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},s.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,r){var n=t("readable-stream").Readable;function i(t,e,r){n.call(this,e),this._helper=t;var i=this;t.on("data",(function(t,e){i.push(t)||i._helper.pause(),r&&r(e)})).on("error",(function(t){i.emit("error",t)})).on("end",(function(){i.push(null)}))}t("../utils").inherits(i,n),i.prototype._read=function(){this._helper.resume()},e.exports=i},{"../utils":32,"readable-stream":16}],14:[function(t,e,r){e.exports={isNode:"undefined"!=typeof ut,newBufferFrom:function(t,e){if(ut.from&&ut.from!==Uint8Array.from)return ut.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new ut(t,e)},allocBuffer:function(t){if(ut.alloc)return ut.alloc(t);var e=new ut(t);return e.fill(0),e},isBuffer:function(t){return ut.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,r){function n(t,e,r){var n,i=s.getTypeOf(e),a=s.extend(r||{},u);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(t=w(t)),a.createFolders&&(n=m(t))&&v.call(this,n,!0);var l="string"===i&&!1===a.binary&&!1===a.base64;r&&void 0!==r.binary||(a.binary=!l),(e instanceof f&&0===e.uncompressedSize||a.dir||!e||0===e.length)&&(a.base64=!1,a.binary=!0,e="",a.compression="STORE",i="string");var y=null;y=e instanceof f||e instanceof o?e:h.isNode&&h.isStream(e)?new d(t,e):s.prepareContent(t,e,a.binary,a.optimizedBinaryString,a.base64);var b=new c(t,y,a);this.files[t]=b}var i=t("./utf8"),s=t("./utils"),o=t("./stream/GenericWorker"),a=t("./stream/StreamHelper"),u=t("./defaults"),f=t("./compressedObject"),c=t("./zipObject"),l=t("./generate"),h=t("./nodejsUtils"),d=t("./nodejs/NodejsStreamInputAdapter"),m=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},w=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},v=function(t,e){return e=void 0!==e?e:u.createFolders,t=w(t),this.files[t]||n.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function y(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var b={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,r,n;for(e in this.files)n=this.files[e],(r=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(r,n)},filter:function(t){var e=[];return this.forEach((function(r,n){t(r,n)&&e.push(n)})),e},file:function(t,e,r){if(1!==arguments.length)return t=this.root+t,n.call(this,t,e,r),this;if(y(t)){var i=t;return this.filter((function(t,e){return!e.dir&&i.test(t)}))}var s=this.files[this.root+t];return s&&!s.dir?s:null},folder:function(t){if(!t)return this;if(y(t))return this.filter((function(e,r){return r.dir&&t.test(e)}));var e=this.root+t,r=v.call(this,e),n=this.clone();return n.root=r.name,n},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var r=this.filter((function(e,r){return r.name.slice(0,t.length)===t})),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,r={};try{if((r=s.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");s.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";e=l.generateWorker(this,r,n)}catch(t){(e=new o("error")).error(t)}return new a(e,r.type||"string",r.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=b},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,r){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,r){var n=t("./DataReader");function i(t){n.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(i,n),i.prototype.byteAt=function(t){return this.data[this.zero+t]},i.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),r=t.charCodeAt(1),n=t.charCodeAt(2),i=t.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===e&&this.data[s+1]===r&&this.data[s+2]===n&&this.data[s+3]===i)return s-this.zero;return-1},i.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1),n=t.charCodeAt(2),i=t.charCodeAt(3),s=this.readData(4);return e===s[0]&&r===s[1]&&n===s[2]&&i===s[3]},i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./DataReader":18}],18:[function(t,e,r){var n=t("../utils");function i(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var e,r=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)r=(r<<8)+this.byteAt(e);return this.index+=t,r},readString:function(t){return n.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=i},{"../utils":32}],19:[function(t,e,r){var n=t("./Uint8ArrayReader");function i(t){n.call(this,t)}t("../utils").inherits(i,n),i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,r){var n=t("./DataReader");function i(t){n.call(this,t)}t("../utils").inherits(i,n),i.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},i.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},i.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},i.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./DataReader":18}],21:[function(t,e,r){var n=t("./ArrayReader");function i(t){n.call(this,t)}t("../utils").inherits(i,n),i.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,r){var n=t("../utils"),i=t("../support"),s=t("./ArrayReader"),o=t("./StringReader"),a=t("./NodeBufferReader"),u=t("./Uint8ArrayReader");e.exports=function(t){var e=n.getTypeOf(t);return n.checkSupport(e),"string"!==e||i.uint8array?"nodebuffer"===e?new a(t):i.uint8array?new u(n.transformTo("uint8array",t)):new s(n.transformTo("array",t)):new o(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,e,r){var n=t("./GenericWorker"),i=t("../utils");function s(t){n.call(this,"ConvertWorker to "+t),this.destType=t}i.inherits(s,n),s.prototype.processChunk=function(t){this.push({data:i.transformTo(this.destType,t.data),meta:t.meta})},e.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,r){var n=t("./GenericWorker"),i=t("../crc32");function s(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(s,n),s.prototype.processChunk=function(t){this.streamInfo.crc32=i(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,r){var n=t("../utils"),i=t("./GenericWorker");function s(t){i.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}n.inherits(s,i),s.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}i.prototype.processChunk.call(this,t)},e.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,r){var n=t("../utils"),i=t("./GenericWorker");function s(t){i.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=n.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}n.inherits(s,i),s.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,r){function n(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=n},{}],29:[function(t,e,r){var n=t("../utils"),i=t("./ConvertWorker"),s=t("./GenericWorker"),o=t("../base64"),a=t("../support"),u=t("../external"),f=null;if(a.nodestream)try{f=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function c(t,e){return new u.Promise((function(r,i){var s=[],a=t._internalType,u=t._outputType,f=t._mimeType;t.on("data",(function(t,r){s.push(t),e&&e(r)})).on("error",(function(t){s=[],i(t)})).on("end",(function(){try{var t=function(t,e,r){switch(t){case"blob":return n.newBlob(n.transformTo("arraybuffer",e),r);case"base64":return o.encode(e);default:return n.transformTo(t,e)}}(u,function(t,e){var r,n=0,i=null,s=0;for(r=0;r<e.length;r++)s+=e[r].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(i=new Uint8Array(s),r=0;r<e.length;r++)i.set(e[r],n),n+=e[r].length;return i;case"nodebuffer":return ut.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(a,s),f);r(t)}catch(t){i(t)}s=[]})).resume()}))}function l(t,e,r){var o=e;switch(e){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=e,this._mimeType=r,n.checkSupport(o),this._worker=t.pipe(new i(o)),t.lock()}catch(t){this._worker=new s("error"),this._worker.error(t)}}l.prototype={accumulate:function(t){return c(this,t)},on:function(t,e){var r=this;return"data"===t?this._worker.on(t,(function(t){e.call(r,t.data,t.meta)})):this._worker.on(t,(function(){n.delay(e,arguments,r)})),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new f(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=l},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof ut,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(t){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob("application/zip").size}catch(t){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(t){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,r){for(var n=t("./utils"),i=t("./support"),s=t("./nodejsUtils"),o=t("./stream/GenericWorker"),a=new Array(256),u=0;u<256;u++)a[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;a[254]=a[254]=1;function f(){o.call(this,"utf-8 decode"),this.leftOver=null}function c(){o.call(this,"utf-8 encode")}r.utf8encode=function(t){return i.nodebuffer?s.newBufferFrom(t,"utf-8"):function(t){var e,r,n,s,o,a=t.length,u=0;for(s=0;s<a;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<a&&56320==(64512&(n=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),u+=r<128?1:r<2048?2:r<65536?3:4;for(e=i.uint8array?new Uint8Array(u):new Array(u),s=o=0;o<u;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<a&&56320==(64512&(n=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?e[o++]=r:(r<2048?e[o++]=192|r>>>6:(r<65536?e[o++]=224|r>>>12:(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63),e[o++]=128|r>>>6&63),e[o++]=128|63&r);return e}(t)},r.utf8decode=function(t){return i.nodebuffer?n.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,r,i,s,o=t.length,u=new Array(2*o);for(e=r=0;e<o;)if((i=t[e++])<128)u[r++]=i;else if(4<(s=a[i]))u[r++]=65533,e+=s-1;else{for(i&=2===s?31:3===s?15:7;1<s&&e<o;)i=i<<6|63&t[e++],s--;1<s?u[r++]=65533:i<65536?u[r++]=i:(i-=65536,u[r++]=55296|i>>10&1023,u[r++]=56320|1023&i)}return u.length!==r&&(u.subarray?u=u.subarray(0,r):u.length=r),n.applyFromCharCode(u)}(t=n.transformTo(i.uint8array?"uint8array":"array",t))},n.inherits(f,o),f.prototype.processChunk=function(t){var e=n.transformTo(i.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var s=e;(e=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),e.set(s,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var o=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+a[t[r]]>e?r:e}(e),u=e;o!==e.length&&(i.uint8array?(u=e.subarray(0,o),this.leftOver=e.subarray(o,e.length)):(u=e.slice(0,o),this.leftOver=e.slice(o,e.length))),this.push({data:r.utf8decode(u),meta:t.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=f,n.inherits(c,o),c.prototype.processChunk=function(t){this.push({data:r.utf8encode(t.data),meta:t.meta})},r.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,r){var n=t("./support"),i=t("./base64"),s=t("./nodejsUtils"),o=t("./external");function a(t){return t}function u(t,e){for(var r=0;r<t.length;++r)e[r]=255&t.charCodeAt(r);return e}t("setimmediate"),r.newBlob=function(t,e){r.checkSupport("blob");try{return new Blob([t],{type:e})}catch(r){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(e)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(t,e,r){var n=[],i=0,s=t.length;if(s<=r)return String.fromCharCode.apply(null,t);for(;i<s;)"array"===e||"nodebuffer"===e?n.push(String.fromCharCode.apply(null,t.slice(i,Math.min(i+r,s)))):n.push(String.fromCharCode.apply(null,t.subarray(i,Math.min(i+r,s)))),i+=r;return n.join("")},stringifyByChar:function(t){for(var e="",r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(t){return!1}}()}};function c(t){var e=65536,n=r.getTypeOf(t),i=!0;if("uint8array"===n?i=f.applyCanBeUsed.uint8array:"nodebuffer"===n&&(i=f.applyCanBeUsed.nodebuffer),i)for(;1<e;)try{return f.stringifyByChunk(t,n,e)}catch(t){e=Math.floor(e/2)}return f.stringifyByChar(t)}function l(t,e){for(var r=0;r<t.length;r++)e[r]=t[r];return e}r.applyFromCharCode=c;var h={};h.string={string:a,array:function(t){return u(t,new Array(t.length))},arraybuffer:function(t){return h.string.uint8array(t).buffer},uint8array:function(t){return u(t,new Uint8Array(t.length))},nodebuffer:function(t){return u(t,s.allocBuffer(t.length))}},h.array={string:c,array:a,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return s.newBufferFrom(t)}},h.arraybuffer={string:function(t){return c(new Uint8Array(t))},array:function(t){return l(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:a,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return s.newBufferFrom(new Uint8Array(t))}},h.uint8array={string:c,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:a,nodebuffer:function(t){return s.newBufferFrom(t)}},h.nodebuffer={string:c,array:function(t){return l(t,new Array(t.length))},arraybuffer:function(t){return h.nodebuffer.uint8array(t).buffer},uint8array:function(t){return l(t,new Uint8Array(t.length))},nodebuffer:a},r.transformTo=function(t,e){if(e=e||"",!t)return e;r.checkSupport(t);var n=r.getTypeOf(e);return h[n][t](e)},r.resolve=function(t){for(var e=t.split("/"),r=[],n=0;n<e.length;n++){var i=e[n];"."===i||""===i&&0!==n&&n!==e.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},r.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":n.nodebuffer&&s.isBuffer(t)?"nodebuffer":n.uint8array&&t instanceof Uint8Array?"uint8array":n.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(t){if(!n[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(t){var e,r,n="";for(r=0;r<(t||"").length;r++)n+="\\x"+((e=t.charCodeAt(r))<16?"0":"")+e.toString(16).toUpperCase();return n},r.delay=function(t,e,r){setImmediate((function(){t.apply(r||null,e||[])}))},r.inherits=function(t,e){function r(){}r.prototype=e.prototype,t.prototype=new r},r.extend=function(){var t,e,r={};for(t=0;t<arguments.length;t++)for(e in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],e)&&void 0===r[e]&&(r[e]=arguments[t][e]);return r},r.prepareContent=function(t,e,s,a,f){return o.Promise.resolve(e).then((function(t){return n.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new o.Promise((function(e,r){var n=new FileReader;n.onload=function(t){e(t.target.result)},n.onerror=function(t){r(t.target.error)},n.readAsArrayBuffer(t)})):t})).then((function(e){var c=r.getTypeOf(e);return c?("arraybuffer"===c?e=r.transformTo("uint8array",e):"string"===c&&(f?e=i.decode(e):s&&!0!==a&&(e=function(t){return u(t,n.uint8array?new Uint8Array(t.length):new Array(t.length))}(e))),e):o.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,e,r){var n=t("./reader/readerFor"),i=t("./utils"),s=t("./signature"),o=t("./zipEntry"),a=t("./support");function u(t){this.files=[],this.loadOptions=t}u.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(e)+", expected "+i.pretty(t)+")")}},isSignature:function(t,e){var r=this.reader.index;this.reader.setIndex(t);var n=this.reader.readString(4)===e;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=a.uint8array?"uint8array":"array",r=i.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,r,n=this.zip64EndOfCentralSize-44;0<n;)t=this.reader.readInt(2),e=this.reader.readInt(4),r=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(t=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(t<0)throw!this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(t);var e=t;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=e-r;if(0<n)this.isSignature(e,s.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(t){this.reader=n(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,e,r){var n=t("./reader/readerFor"),i=t("./utils"),s=t("./compressedObject"),o=t("./crc32"),a=t("./utf8"),u=t("./compressions"),f=t("./support");function c(t,e){this.options=t,this.loadOptions=e}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in u)if(Object.prototype.hasOwnProperty.call(u,e)&&u[e].magic===t)return u[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+i.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var e,r,n,i=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<i;)e=t.readInt(2),r=t.readInt(2),n=t.readData(r),this.extraFields[e]={id:e,length:r,value:n};t.setIndex(i)},handleUTF8:function(){var t=f.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var r=i.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var s=i.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=n(t.value);return 1!==e.readInt(1)?null:o(this.fileName)!==e.readInt(4)?null:a.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=n(t.value);return 1!==e.readInt(1)?null:o(this.fileComment)!==e.readInt(4)?null:a.utf8decode(e.readData(t.length-5))}return null}},e.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,r){function n(t,e,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=e,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var i=t("./stream/StreamHelper"),s=t("./stream/DataWorker"),o=t("./utf8"),a=t("./compressedObject"),u=t("./stream/GenericWorker");n.prototype={internalStream:function(t){var e=null,r="string";try{if(!t)throw new Error("No output type specified.");var n="string"===(r=t.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),e=this._decompressWorker();var s=!this._dataBinary;s&&!n&&(e=e.pipe(new o.Utf8EncodeWorker)),!s&&n&&(e=e.pipe(new o.Utf8DecodeWorker))}catch(t){(e=new u("error")).error(t)}return new i(e,r,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof a&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(r,t,e)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof u?this._data:new s(this._data)}};for(var f=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},l=0;l<f.length;l++)n.prototype[f[l]]=c;e.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,r){(function(t){var r,n,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var s=0,o=new i(c),a=t.document.createTextNode("");o.observe(a,{characterData:!0}),r=function(){a.data=s=++s%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var u=new t.MessageChannel;u.port1.onmessage=c,r=function(){u.port2.postMessage(0)}}var f=[];function c(){var t,e;n=!0;for(var r=f.length;r;){for(e=f,f=[],t=-1;++t<r;)e[t]();r=f.length}n=!1}e.exports=function(t){1!==f.push(t)||n||r()}}).call(this,"undefined"!=typeof ie?ie:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,r){var n=t("immediate");function i(){}var s={},o=["REJECTED"],a=["FULFILLED"],u=["PENDING"];function f(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,t!==i&&d(this,t)}function c(t,e,r){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function l(t,e,r){n((function(){var n;try{n=e(r)}catch(n){return s.reject(t,n)}n===t?s.reject(t,new TypeError("Cannot resolve promise with itself")):s.resolve(t,n)}))}function h(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function d(t,e){var r=!1;function n(e){r||(r=!0,s.reject(t,e))}function i(e){r||(r=!0,s.resolve(t,e))}var o=m((function(){e(i,n)}));"error"===o.status&&n(o.value)}function m(t,e){var r={};try{r.value=t(e),r.status="success"}catch(t){r.status="error",r.value=t}return r}(e.exports=f).prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(r){return e.resolve(t()).then((function(){return r}))}),(function(r){return e.resolve(t()).then((function(){throw r}))}))},f.prototype.catch=function(t){return this.then(null,t)},f.prototype.then=function(t,e){if("function"!=typeof t&&this.state===a||"function"!=typeof e&&this.state===o)return this;var r=new this.constructor(i);this.state!==u?l(r,this.state===a?t:e,this.outcome):this.queue.push(new c(r,t,e));return r},c.prototype.callFulfilled=function(t){s.resolve(this.promise,t)},c.prototype.otherCallFulfilled=function(t){l(this.promise,this.onFulfilled,t)},c.prototype.callRejected=function(t){s.reject(this.promise,t)},c.prototype.otherCallRejected=function(t){l(this.promise,this.onRejected,t)},s.resolve=function(t,e){var r=m(h,e);if("error"===r.status)return s.reject(t,r.value);var n=r.value;if(n)d(t,n);else{t.state=a,t.outcome=e;for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callFulfilled(e)}return t},s.reject=function(t,e){t.state=o,t.outcome=e;for(var r=-1,n=t.queue.length;++r<n;)t.queue[r].callRejected(e);return t},f.resolve=function(t){if(t instanceof this)return t;return s.resolve(new this(i),t)},f.reject=function(t){var e=new this(i);return s.reject(e,t)},f.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);var o=new Array(r),a=0,u=-1,f=new this(i);for(;++u<r;)c(t[u],u);return f;function c(t,i){e.resolve(t).then((function(t){o[i]=t,++a!==r||n||(n=!0,s.resolve(f,o))}),(function(t){n||(n=!0,s.reject(f,t))}))}},f.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,n=!1;if(!r)return this.resolve([]);var o=-1,a=new this(i);for(;++o<r;)u=t[o],e.resolve(u).then((function(t){n||(n=!0,s.resolve(a,t))}),(function(t){n||(n=!0,s.reject(a,t))}));var u;return a}},{immediate:36}],38:[function(t,e,r){var n={};(0,t("./lib/utils/common").assign)(n,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,r){var n=t("./zlib/deflate"),i=t("./utils/common"),s=t("./utils/strings"),o=t("./zlib/messages"),a=t("./zlib/zstream"),u=Object.prototype.toString,f=0,c=-1,l=0,h=8;function d(t){if(!(this instanceof d))return new d(t);this.options=i.assign({level:c,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==f)throw new Error(o[r]);if(e.header&&n.deflateSetHeader(this.strm,e.header),e.dictionary){var m;if(m="string"==typeof e.dictionary?s.string2buf(e.dictionary):"[object ArrayBuffer]"===u.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,(r=n.deflateSetDictionary(this.strm,m))!==f)throw new Error(o[r]);this._dict_set=!0}}function m(t,e){var r=new d(e);if(r.push(t,!0),r.err)throw r.msg||o[r.err];return r.result}d.prototype.push=function(t,e){var r,o,a=this.strm,c=this.options.chunkSize;if(this.ended)return!1;o=e===~~e?e:!0===e?4:0,"string"==typeof t?a.input=s.string2buf(t):"[object ArrayBuffer]"===u.call(t)?a.input=new Uint8Array(t):a.input=t,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new i.Buf8(c),a.next_out=0,a.avail_out=c),1!==(r=n.deflate(a,o))&&r!==f)return this.onEnd(r),!(this.ended=!0);0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(s.buf2binstring(i.shrinkBuf(a.output,a.next_out))):this.onData(i.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==r);return 4===o?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===f):2!==o||(this.onEnd(f),!(a.avail_out=0))},d.prototype.onData=function(t){this.chunks.push(t)},d.prototype.onEnd=function(t){t===f&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=d,r.deflate=m,r.deflateRaw=function(t,e){return(e=e||{}).raw=!0,m(t,e)},r.gzip=function(t,e){return(e=e||{}).gzip=!0,m(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,r){var n=t("./zlib/inflate"),i=t("./utils/common"),s=t("./utils/strings"),o=t("./zlib/constants"),a=t("./zlib/messages"),u=t("./zlib/zstream"),f=t("./zlib/gzheader"),c=Object.prototype.toString;function l(t){if(!(this instanceof l))return new l(t);this.options=i.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,e.windowBits);if(r!==o.Z_OK)throw new Error(a[r]);this.header=new f,n.inflateGetHeader(this.strm,this.header)}function h(t,e){var r=new l(e);if(r.push(t,!0),r.err)throw r.msg||a[r.err];return r.result}l.prototype.push=function(t,e){var r,a,u,f,l,h,d=this.strm,m=this.options.chunkSize,w=this.options.dictionary,v=!1;if(this.ended)return!1;a=e===~~e?e:!0===e?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof t?d.input=s.binstring2buf(t):"[object ArrayBuffer]"===c.call(t)?d.input=new Uint8Array(t):d.input=t,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new i.Buf8(m),d.next_out=0,d.avail_out=m),(r=n.inflate(d,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&w&&(h="string"==typeof w?s.string2buf(w):"[object ArrayBuffer]"===c.call(w)?new Uint8Array(w):w,r=n.inflateSetDictionary(this.strm,h)),r===o.Z_BUF_ERROR&&!0===v&&(r=o.Z_OK,v=!1),r!==o.Z_STREAM_END&&r!==o.Z_OK)return this.onEnd(r),!(this.ended=!0);d.next_out&&(0!==d.avail_out&&r!==o.Z_STREAM_END&&(0!==d.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(u=s.utf8border(d.output,d.next_out),f=d.next_out-u,l=s.buf2string(d.output,u),d.next_out=f,d.avail_out=m-f,f&&i.arraySet(d.output,d.output,u,f,0),this.onData(l)):this.onData(i.shrinkBuf(d.output,d.next_out)))),0===d.avail_in&&0===d.avail_out&&(v=!0)}while((0<d.avail_in||0===d.avail_out)&&r!==o.Z_STREAM_END);return r===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(d.avail_out=0))},l.prototype.onData=function(t){this.chunks.push(t)},l.prototype.onEnd=function(t){t===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=l,r.inflate=h,r.inflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},r.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])}}return t},r.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+n),i);else for(var s=0;s<n;s++)t[i+s]=e[r+s]},flattenChunks:function(t){var e,r,n,i,s,o;for(e=n=0,r=t.length;e<r;e++)n+=t[e].length;for(o=new Uint8Array(n),e=i=0,r=t.length;e<r;e++)s=t[e],o.set(s,i),i+=s.length;return o}},s={arraySet:function(t,e,r,n,i){for(var s=0;s<n;s++)t[i+s]=e[r+s]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(n)},{}],42:[function(t,e,r){var n=t("./common"),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(t){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){s=!1}for(var o=new n.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function u(t,e){if(e<65537&&(t.subarray&&s||!t.subarray&&i))return String.fromCharCode.apply(null,n.shrinkBuf(t,e));for(var r="",o=0;o<e;o++)r+=String.fromCharCode(t[o]);return r}o[254]=o[254]=1,r.string2buf=function(t){var e,r,i,s,o,a=t.length,u=0;for(s=0;s<a;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),u+=r<128?1:r<2048?2:r<65536?3:4;for(e=new n.Buf8(u),s=o=0;o<u;s++)55296==(64512&(r=t.charCodeAt(s)))&&s+1<a&&56320==(64512&(i=t.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(i-56320),s++),r<128?e[o++]=r:(r<2048?e[o++]=192|r>>>6:(r<65536?e[o++]=224|r>>>12:(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63),e[o++]=128|r>>>6&63),e[o++]=128|63&r);return e},r.buf2binstring=function(t){return u(t,t.length)},r.binstring2buf=function(t){for(var e=new n.Buf8(t.length),r=0,i=e.length;r<i;r++)e[r]=t.charCodeAt(r);return e},r.buf2string=function(t,e){var r,n,i,s,a=e||t.length,f=new Array(2*a);for(r=n=0;r<a;)if((i=t[r++])<128)f[n++]=i;else if(4<(s=o[i]))f[n++]=65533,r+=s-1;else{for(i&=2===s?31:3===s?15:7;1<s&&r<a;)i=i<<6|63&t[r++],s--;1<s?f[n++]=65533:i<65536?f[n++]=i:(i-=65536,f[n++]=55296|i>>10&1023,f[n++]=56320|1023&i)}return u(f,n)},r.utf8border=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;0<=r&&128==(192&t[r]);)r--;return r<0?e:0===r?e:r+o[t[r]]>e?r:e}},{"./common":41}],43:[function(t,e,r){e.exports=function(t,e,r,n){for(var i=65535&t|0,s=t>>>16&65535|0,o=0;0!==r;){for(r-=o=2e3<r?2e3:r;s=s+(i=i+e[n++]|0)|0,--o;);i%=65521,s%=65521}return i|s<<16|0}},{}],44:[function(t,e,r){e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,r){var n=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();e.exports=function(t,e,r,i){var s=n,o=i+r;t^=-1;for(var a=i;a<o;a++)t=t>>>8^s[255&(t^e[a])];return-1^t}},{}],46:[function(t,e,r){var n,i=t("../utils/common"),s=t("./trees"),o=t("./adler32"),a=t("./crc32"),u=t("./messages"),f=0,c=4,l=0,h=-2,d=-1,m=4,w=2,v=8,y=9,b=286,p=30,E=19,g=2*b+1,P=15,S=3,T=258,$=T+S+1,k=42,O=113,_=1,A=2,R=3,D=4;function N(t,e){return t.msg=u[e],e}function j(t){return(t<<1)-(4<t?9:0)}function I(t){for(var e=t.length;0<=--e;)t[e]=0}function M(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(i.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))}function C(t,e){s._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,M(t.strm)}function L(t,e){t.pending_buf[t.pending++]=e}function x(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function B(t,e){var r,n,i=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match,u=t.strstart>t.w_size-$?t.strstart-(t.w_size-$):0,f=t.window,c=t.w_mask,l=t.prev,h=t.strstart+T,d=f[s+o-1],m=f[s+o];t.prev_length>=t.good_match&&(i>>=2),a>t.lookahead&&(a=t.lookahead);do{if(f[(r=e)+o]===m&&f[r+o-1]===d&&f[r]===f[s]&&f[++r]===f[s+1]){s+=2,r++;do{}while(f[++s]===f[++r]&&f[++s]===f[++r]&&f[++s]===f[++r]&&f[++s]===f[++r]&&f[++s]===f[++r]&&f[++s]===f[++r]&&f[++s]===f[++r]&&f[++s]===f[++r]&&s<h);if(n=T-(h-s),s=h-T,o<n){if(t.match_start=e,a<=(o=n))break;d=f[s+o-1],m=f[s+o]}}}while((e=l[e&c])>u&&0!=--i);return o<=t.lookahead?o:t.lookahead}function F(t){var e,r,n,s,u,f,c,l,h,d,m=t.w_size;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=m+(m-$)){for(i.arraySet(t.window,t.window,m,m,0),t.match_start-=m,t.strstart-=m,t.block_start-=m,e=r=t.hash_size;n=t.head[--e],t.head[e]=m<=n?n-m:0,--r;);for(e=r=m;n=t.prev[--e],t.prev[e]=m<=n?n-m:0,--r;);s+=m}if(0===t.strm.avail_in)break;if(f=t.strm,c=t.window,l=t.strstart+t.lookahead,h=s,d=void 0,d=f.avail_in,h<d&&(d=h),r=0===d?0:(f.avail_in-=d,i.arraySet(c,f.input,f.next_in,d,l),1===f.state.wrap?f.adler=o(f.adler,c,d,l):2===f.state.wrap&&(f.adler=a(f.adler,c,d,l)),f.next_in+=d,f.total_in+=d,d),t.lookahead+=r,t.lookahead+t.insert>=S)for(u=t.strstart-t.insert,t.ins_h=t.window[u],t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[u+S-1])&t.hash_mask,t.prev[u&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=u,u++,t.insert--,!(t.lookahead+t.insert<S)););}while(t.lookahead<$&&0!==t.strm.avail_in)}function U(t,e){for(var r,n;;){if(t.lookahead<$){if(F(t),t.lookahead<$&&e===f)return _;if(0===t.lookahead)break}if(r=0,t.lookahead>=S&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-$&&(t.match_length=B(t,r)),t.match_length>=S)if(n=s._tr_tally(t,t.strstart-t.match_start,t.match_length-S),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=S){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(C(t,!1),0===t.strm.avail_out))return _}return t.insert=t.strstart<S-1?t.strstart:S-1,e===c?(C(t,!0),0===t.strm.avail_out?R:D):t.last_lit&&(C(t,!1),0===t.strm.avail_out)?_:A}function q(t,e){for(var r,n,i;;){if(t.lookahead<$){if(F(t),t.lookahead<$&&e===f)return _;if(0===t.lookahead)break}if(r=0,t.lookahead>=S&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=S-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-$&&(t.match_length=B(t,r),t.match_length<=5&&(1===t.strategy||t.match_length===S&&4096<t.strstart-t.match_start)&&(t.match_length=S-1)),t.prev_length>=S&&t.match_length<=t.prev_length){for(i=t.strstart+t.lookahead-S,n=s._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-S),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+S-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=S-1,t.strstart++,n&&(C(t,!1),0===t.strm.avail_out))return _}else if(t.match_available){if((n=s._tr_tally(t,0,t.window[t.strstart-1]))&&C(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return _}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=s._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<S-1?t.strstart:S-1,e===c?(C(t,!0),0===t.strm.avail_out?R:D):t.last_lit&&(C(t,!1),0===t.strm.avail_out)?_:A}function W(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}function G(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new i.Buf16(2*g),this.dyn_dtree=new i.Buf16(2*(2*p+1)),this.bl_tree=new i.Buf16(2*(2*E+1)),I(this.dyn_ltree),I(this.dyn_dtree),I(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new i.Buf16(P+1),this.heap=new i.Buf16(2*b+1),I(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new i.Buf16(2*b+1),I(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function z(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=w,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?k:O,t.adler=2===e.wrap?0:1,e.last_flush=f,s._tr_init(e),l):N(t,h)}function H(t){var e=z(t);return e===l&&function(t){t.window_size=2*t.w_size,I(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=S-1,t.match_available=0,t.ins_h=0}(t.state),e}function V(t,e,r,n,s,o){if(!t)return h;var a=1;if(e===d&&(e=6),n<0?(a=0,n=-n):15<n&&(a=2,n-=16),s<1||y<s||r!==v||n<8||15<n||e<0||9<e||o<0||m<o)return N(t,h);8===n&&(n=9);var u=new G;return(t.state=u).strm=t,u.wrap=a,u.gzhead=null,u.w_bits=n,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=s+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+S-1)/S),u.window=new i.Buf8(2*u.w_size),u.head=new i.Buf16(u.hash_size),u.prev=new i.Buf16(u.w_size),u.lit_bufsize=1<<s+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new i.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=o,u.method=r,H(t)}n=[new W(0,0,0,0,(function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(F(t),0===t.lookahead&&e===f)return _;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,C(t,!1),0===t.strm.avail_out))return _;if(t.strstart-t.block_start>=t.w_size-$&&(C(t,!1),0===t.strm.avail_out))return _}return t.insert=0,e===c?(C(t,!0),0===t.strm.avail_out?R:D):(t.strstart>t.block_start&&(C(t,!1),t.strm.avail_out),_)})),new W(4,4,8,4,U),new W(4,5,16,8,U),new W(4,6,32,32,U),new W(4,4,16,16,q),new W(8,16,32,32,q),new W(8,16,128,128,q),new W(8,32,128,256,q),new W(32,128,258,1024,q),new W(32,258,258,4096,q)],r.deflateInit=function(t,e){return V(t,e,v,15,8,0)},r.deflateInit2=V,r.deflateReset=H,r.deflateResetKeep=z,r.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?h:(t.state.gzhead=e,l):h},r.deflate=function(t,e){var r,i,o,u;if(!t||!t.state||5<e||e<0)return t?N(t,h):h;if(i=t.state,!t.output||!t.input&&0!==t.avail_in||666===i.status&&e!==c)return N(t,0===t.avail_out?-5:h);if(i.strm=t,r=i.last_flush,i.last_flush=e,i.status===k)if(2===i.wrap)t.adler=0,L(i,31),L(i,139),L(i,8),i.gzhead?(L(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),L(i,255&i.gzhead.time),L(i,i.gzhead.time>>8&255),L(i,i.gzhead.time>>16&255),L(i,i.gzhead.time>>24&255),L(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),L(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(L(i,255&i.gzhead.extra.length),L(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=a(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(L(i,0),L(i,0),L(i,0),L(i,0),L(i,0),L(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),L(i,3),i.status=O);else{var d=v+(i.w_bits-8<<4)<<8;d|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(d|=32),d+=31-d%31,i.status=O,x(i,d),0!==i.strstart&&(x(i,t.adler>>>16),x(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(o=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>o&&(t.adler=a(t.adler,i.pending_buf,i.pending-o,o)),M(t),o=i.pending,i.pending!==i.pending_buf_size));)L(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>o&&(t.adler=a(t.adler,i.pending_buf,i.pending-o,o)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=a(t.adler,i.pending_buf,i.pending-o,o)),M(t),o=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,L(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>o&&(t.adler=a(t.adler,i.pending_buf,i.pending-o,o)),0===u&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){o=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>o&&(t.adler=a(t.adler,i.pending_buf,i.pending-o,o)),M(t),o=i.pending,i.pending===i.pending_buf_size)){u=1;break}u=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,L(i,u)}while(0!==u);i.gzhead.hcrc&&i.pending>o&&(t.adler=a(t.adler,i.pending_buf,i.pending-o,o)),0===u&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&M(t),i.pending+2<=i.pending_buf_size&&(L(i,255&t.adler),L(i,t.adler>>8&255),t.adler=0,i.status=O)):i.status=O),0!==i.pending){if(M(t),0===t.avail_out)return i.last_flush=-1,l}else if(0===t.avail_in&&j(e)<=j(r)&&e!==c)return N(t,-5);if(666===i.status&&0!==t.avail_in)return N(t,-5);if(0!==t.avail_in||0!==i.lookahead||e!==f&&666!==i.status){var m=2===i.strategy?function(t,e){for(var r;;){if(0===t.lookahead&&(F(t),0===t.lookahead)){if(e===f)return _;break}if(t.match_length=0,r=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(C(t,!1),0===t.strm.avail_out))return _}return t.insert=0,e===c?(C(t,!0),0===t.strm.avail_out?R:D):t.last_lit&&(C(t,!1),0===t.strm.avail_out)?_:A}(i,e):3===i.strategy?function(t,e){for(var r,n,i,o,a=t.window;;){if(t.lookahead<=T){if(F(t),t.lookahead<=T&&e===f)return _;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=S&&0<t.strstart&&(n=a[i=t.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){o=t.strstart+T;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<o);t.match_length=T-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=S?(r=s._tr_tally(t,1,t.match_length-S),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=s._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(C(t,!1),0===t.strm.avail_out))return _}return t.insert=0,e===c?(C(t,!0),0===t.strm.avail_out?R:D):t.last_lit&&(C(t,!1),0===t.strm.avail_out)?_:A}(i,e):n[i.level].func(i,e);if(m!==R&&m!==D||(i.status=666),m===_||m===R)return 0===t.avail_out&&(i.last_flush=-1),l;if(m===A&&(1===e?s._tr_align(i):5!==e&&(s._tr_stored_block(i,0,0,!1),3===e&&(I(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),M(t),0===t.avail_out))return i.last_flush=-1,l}return e!==c?l:i.wrap<=0?1:(2===i.wrap?(L(i,255&t.adler),L(i,t.adler>>8&255),L(i,t.adler>>16&255),L(i,t.adler>>24&255),L(i,255&t.total_in),L(i,t.total_in>>8&255),L(i,t.total_in>>16&255),L(i,t.total_in>>24&255)):(x(i,t.adler>>>16),x(i,65535&t.adler)),M(t),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?l:1)},r.deflateEnd=function(t){var e;return t&&t.state?(e=t.state.status)!==k&&69!==e&&73!==e&&91!==e&&103!==e&&e!==O&&666!==e?N(t,h):(t.state=null,e===O?N(t,-3):l):h},r.deflateSetDictionary=function(t,e){var r,n,s,a,u,f,c,d,m=e.length;if(!t||!t.state)return h;if(2===(a=(r=t.state).wrap)||1===a&&r.status!==k||r.lookahead)return h;for(1===a&&(t.adler=o(t.adler,e,m,0)),r.wrap=0,m>=r.w_size&&(0===a&&(I(r.head),r.strstart=0,r.block_start=0,r.insert=0),d=new i.Buf8(r.w_size),i.arraySet(d,e,m-r.w_size,r.w_size,0),e=d,m=r.w_size),u=t.avail_in,f=t.next_in,c=t.input,t.avail_in=m,t.next_in=0,t.input=e,F(r);r.lookahead>=S;){for(n=r.strstart,s=r.lookahead-(S-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+S-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--s;);r.strstart=n,r.lookahead=S-1,F(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=S-1,r.match_available=0,t.next_in=f,t.input=c,t.avail_in=u,r.wrap=a,l},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,r){e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,r){e.exports=function(t,e){var r,n,i,s,o,a,u,f,c,l,h,d,m,w,v,y,b,p,E,g,P,S,T,$,k;r=t.state,n=t.next_in,$=t.input,i=n+(t.avail_in-5),s=t.next_out,k=t.output,o=s-(e-t.avail_out),a=s+(t.avail_out-257),u=r.dmax,f=r.wsize,c=r.whave,l=r.wnext,h=r.window,d=r.hold,m=r.bits,w=r.lencode,v=r.distcode,y=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;t:do{m<15&&(d+=$[n++]<<m,m+=8,d+=$[n++]<<m,m+=8),p=w[d&y];e:for(;;){if(d>>>=E=p>>>24,m-=E,0===(E=p>>>16&255))k[s++]=65535&p;else{if(!(16&E)){if(0==(64&E)){p=w[(65535&p)+(d&(1<<E)-1)];continue e}if(32&E){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}g=65535&p,(E&=15)&&(m<E&&(d+=$[n++]<<m,m+=8),g+=d&(1<<E)-1,d>>>=E,m-=E),m<15&&(d+=$[n++]<<m,m+=8,d+=$[n++]<<m,m+=8),p=v[d&b];r:for(;;){if(d>>>=E=p>>>24,m-=E,!(16&(E=p>>>16&255))){if(0==(64&E)){p=v[(65535&p)+(d&(1<<E)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(P=65535&p,m<(E&=15)&&(d+=$[n++]<<m,(m+=8)<E&&(d+=$[n++]<<m,m+=8)),u<(P+=d&(1<<E)-1)){t.msg="invalid distance too far back",r.mode=30;break t}if(d>>>=E,m-=E,(E=s-o)<P){if(c<(E=P-E)&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(T=h,(S=0)===l){if(S+=f-E,E<g){for(g-=E;k[s++]=h[S++],--E;);S=s-P,T=k}}else if(l<E){if(S+=f+l-E,(E-=l)<g){for(g-=E;k[s++]=h[S++],--E;);if(S=0,l<g){for(g-=E=l;k[s++]=h[S++],--E;);S=s-P,T=k}}}else if(S+=l-E,E<g){for(g-=E;k[s++]=h[S++],--E;);S=s-P,T=k}for(;2<g;)k[s++]=T[S++],k[s++]=T[S++],k[s++]=T[S++],g-=3;g&&(k[s++]=T[S++],1<g&&(k[s++]=T[S++]))}else{for(S=s-P;k[s++]=k[S++],k[s++]=k[S++],k[s++]=k[S++],2<(g-=3););g&&(k[s++]=k[S++],1<g&&(k[s++]=k[S++]))}break}}break}}while(n<i&&s<a);n-=g=m>>3,d&=(1<<(m-=g<<3))-1,t.next_in=n,t.next_out=s,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=s<a?a-s+257:257-(s-a),r.hold=d,r.bits=m}},{}],49:[function(t,e,r){var n=t("../utils/common"),i=t("./adler32"),s=t("./crc32"),o=t("./inffast"),a=t("./inftrees"),u=1,f=2,c=0,l=-2,h=1,d=852,m=592;function w(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function y(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=h,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new n.Buf32(d),e.distcode=e.distdyn=new n.Buf32(m),e.sane=1,e.back=-1,c):l}function b(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,y(t)):l}function p(t,e){var r,n;return t&&t.state?(n=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?l:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,b(t))):l}function E(t,e){var r,n;return t?(n=new v,(t.state=n).window=null,(r=p(t,e))!==c&&(t.state=null),r):l}var g,P,S=!0;function T(t){if(S){var e;for(g=new n.Buf32(512),P=new n.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(a(u,t.lens,0,288,g,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;a(f,t.lens,0,32,P,0,t.work,{bits:5}),S=!1}t.lencode=g,t.lenbits=9,t.distcode=P,t.distbits=5}function $(t,e,r,i){var s,o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new n.Buf8(o.wsize)),i>=o.wsize?(n.arraySet(o.window,e,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i<(s=o.wsize-o.wnext)&&(s=i),n.arraySet(o.window,e,r-i,s,o.wnext),(i-=s)?(n.arraySet(o.window,e,r-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0}r.inflateReset=b,r.inflateReset2=p,r.inflateResetKeep=y,r.inflateInit=function(t){return E(t,15)},r.inflateInit2=E,r.inflate=function(t,e){var r,d,m,v,y,b,p,E,g,P,S,k,O,_,A,R,D,N,j,I,M,C,L,x,B=0,F=new n.Buf8(4),U=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return l;12===(r=t.state).mode&&(r.mode=13),y=t.next_out,m=t.output,p=t.avail_out,v=t.next_in,d=t.input,b=t.avail_in,E=r.hold,g=r.bits,P=b,S=p,C=c;t:for(;;)switch(r.mode){case h:if(0===r.wrap){r.mode=13;break}for(;g<16;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(2&r.wrap&&35615===E){F[r.check=0]=255&E,F[1]=E>>>8&255,r.check=s(r.check,F,2,0),g=E=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&E)<<8)+(E>>8))%31){t.msg="incorrect header check",r.mode=30;break}if(8!=(15&E)){t.msg="unknown compression method",r.mode=30;break}if(g-=4,M=8+(15&(E>>>=4)),0===r.wbits)r.wbits=M;else if(M>r.wbits){t.msg="invalid window size",r.mode=30;break}r.dmax=1<<M,t.adler=r.check=1,r.mode=512&E?10:12,g=E=0;break;case 2:for(;g<16;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(r.flags=E,8!=(255&r.flags)){t.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=E>>8&1),512&r.flags&&(F[0]=255&E,F[1]=E>>>8&255,r.check=s(r.check,F,2,0)),g=E=0,r.mode=3;case 3:for(;g<32;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}r.head&&(r.head.time=E),512&r.flags&&(F[0]=255&E,F[1]=E>>>8&255,F[2]=E>>>16&255,F[3]=E>>>24&255,r.check=s(r.check,F,4,0)),g=E=0,r.mode=4;case 4:for(;g<16;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}r.head&&(r.head.xflags=255&E,r.head.os=E>>8),512&r.flags&&(F[0]=255&E,F[1]=E>>>8&255,r.check=s(r.check,F,2,0)),g=E=0,r.mode=5;case 5:if(1024&r.flags){for(;g<16;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}r.length=E,r.head&&(r.head.extra_len=E),512&r.flags&&(F[0]=255&E,F[1]=E>>>8&255,r.check=s(r.check,F,2,0)),g=E=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(b<(k=r.length)&&(k=b),k&&(r.head&&(M=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,d,v,k,M)),512&r.flags&&(r.check=s(r.check,d,k,v)),b-=k,v+=k,r.length-=k),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===b)break t;for(k=0;M=d[v+k++],r.head&&M&&r.length<65536&&(r.head.name+=String.fromCharCode(M)),M&&k<b;);if(512&r.flags&&(r.check=s(r.check,d,k,v)),b-=k,v+=k,M)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===b)break t;for(k=0;M=d[v+k++],r.head&&M&&r.length<65536&&(r.head.comment+=String.fromCharCode(M)),M&&k<b;);if(512&r.flags&&(r.check=s(r.check,d,k,v)),b-=k,v+=k,M)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;g<16;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(E!==(65535&r.check)){t.msg="header crc mismatch",r.mode=30;break}g=E=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=12;break;case 10:for(;g<32;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}t.adler=r.check=w(E),g=E=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=y,t.avail_out=p,t.next_in=v,t.avail_in=b,r.hold=E,r.bits=g,2;t.adler=r.check=1,r.mode=12;case 12:if(5===e||6===e)break t;case 13:if(r.last){E>>>=7&g,g-=7&g,r.mode=27;break}for(;g<3;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}switch(r.last=1&E,g-=1,3&(E>>>=1)){case 0:r.mode=14;break;case 1:if(T(r),r.mode=20,6!==e)break;E>>>=2,g-=2;break t;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=30}E>>>=2,g-=2;break;case 14:for(E>>>=7&g,g-=7&g;g<32;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if((65535&E)!=(E>>>16^65535)){t.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&E,g=E=0,r.mode=15,6===e)break t;case 15:r.mode=16;case 16:if(k=r.length){if(b<k&&(k=b),p<k&&(k=p),0===k)break t;n.arraySet(m,d,v,k,y),b-=k,v+=k,p-=k,y+=k,r.length-=k;break}r.mode=12;break;case 17:for(;g<14;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(r.nlen=257+(31&E),E>>>=5,g-=5,r.ndist=1+(31&E),E>>>=5,g-=5,r.ncode=4+(15&E),E>>>=4,g-=4,286<r.nlen||30<r.ndist){t.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;g<3;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}r.lens[U[r.have++]]=7&E,E>>>=3,g-=3}for(;r.have<19;)r.lens[U[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,L={bits:r.lenbits},C=a(0,r.lens,0,19,r.lencode,0,r.work,L),r.lenbits=L.bits,C){t.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;R=(B=r.lencode[E&(1<<r.lenbits)-1])>>>16&255,D=65535&B,!((A=B>>>24)<=g);){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(D<16)E>>>=A,g-=A,r.lens[r.have++]=D;else{if(16===D){for(x=A+2;g<x;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(E>>>=A,g-=A,0===r.have){t.msg="invalid bit length repeat",r.mode=30;break}M=r.lens[r.have-1],k=3+(3&E),E>>>=2,g-=2}else if(17===D){for(x=A+3;g<x;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}g-=A,M=0,k=3+(7&(E>>>=A)),E>>>=3,g-=3}else{for(x=A+7;g<x;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}g-=A,M=0,k=11+(127&(E>>>=A)),E>>>=7,g-=7}if(r.have+k>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=30;break}for(;k--;)r.lens[r.have++]=M}}if(30===r.mode)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,L={bits:r.lenbits},C=a(u,r.lens,0,r.nlen,r.lencode,0,r.work,L),r.lenbits=L.bits,C){t.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,L={bits:r.distbits},C=a(f,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,L),r.distbits=L.bits,C){t.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===e)break t;case 20:r.mode=21;case 21:if(6<=b&&258<=p){t.next_out=y,t.avail_out=p,t.next_in=v,t.avail_in=b,r.hold=E,r.bits=g,o(t,S),y=t.next_out,m=t.output,p=t.avail_out,v=t.next_in,d=t.input,b=t.avail_in,E=r.hold,g=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;R=(B=r.lencode[E&(1<<r.lenbits)-1])>>>16&255,D=65535&B,!((A=B>>>24)<=g);){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(R&&0==(240&R)){for(N=A,j=R,I=D;R=(B=r.lencode[I+((E&(1<<N+j)-1)>>N)])>>>16&255,D=65535&B,!(N+(A=B>>>24)<=g);){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}E>>>=N,g-=N,r.back+=N}if(E>>>=A,g-=A,r.back+=A,r.length=D,0===R){r.mode=26;break}if(32&R){r.back=-1,r.mode=12;break}if(64&R){t.msg="invalid literal/length code",r.mode=30;break}r.extra=15&R,r.mode=22;case 22:if(r.extra){for(x=r.extra;g<x;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}r.length+=E&(1<<r.extra)-1,E>>>=r.extra,g-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;R=(B=r.distcode[E&(1<<r.distbits)-1])>>>16&255,D=65535&B,!((A=B>>>24)<=g);){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(0==(240&R)){for(N=A,j=R,I=D;R=(B=r.distcode[I+((E&(1<<N+j)-1)>>N)])>>>16&255,D=65535&B,!(N+(A=B>>>24)<=g);){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}E>>>=N,g-=N,r.back+=N}if(E>>>=A,g-=A,r.back+=A,64&R){t.msg="invalid distance code",r.mode=30;break}r.offset=D,r.extra=15&R,r.mode=24;case 24:if(r.extra){for(x=r.extra;g<x;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}r.offset+=E&(1<<r.extra)-1,E>>>=r.extra,g-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===p)break t;if(k=S-p,r.offset>k){if((k=r.offset-k)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=30;break}O=k>r.wnext?(k-=r.wnext,r.wsize-k):r.wnext-k,k>r.length&&(k=r.length),_=r.window}else _=m,O=y-r.offset,k=r.length;for(p<k&&(k=p),p-=k,r.length-=k;m[y++]=_[O++],--k;);0===r.length&&(r.mode=21);break;case 26:if(0===p)break t;m[y++]=r.length,p--,r.mode=21;break;case 27:if(r.wrap){for(;g<32;){if(0===b)break t;b--,E|=d[v++]<<g,g+=8}if(S-=p,t.total_out+=S,r.total+=S,S&&(t.adler=r.check=r.flags?s(r.check,m,S,y-S):i(r.check,m,S,y-S)),S=p,(r.flags?E:w(E))!==r.check){t.msg="incorrect data check",r.mode=30;break}g=E=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;g<32;){if(0===b)break t;b--,E+=d[v++]<<g,g+=8}if(E!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=30;break}g=E=0}r.mode=29;case 29:C=1;break t;case 30:C=-3;break t;case 31:return-4;case 32:default:return l}return t.next_out=y,t.avail_out=p,t.next_in=v,t.avail_in=b,r.hold=E,r.bits=g,(r.wsize||S!==t.avail_out&&r.mode<30&&(r.mode<27||4!==e))&&$(t,t.output,t.next_out,S-t.avail_out)?(r.mode=31,-4):(P-=t.avail_in,S-=t.avail_out,t.total_in+=P,t.total_out+=S,r.total+=S,r.wrap&&S&&(t.adler=r.check=r.flags?s(r.check,m,S,t.next_out-S):i(r.check,m,S,t.next_out-S)),t.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==P&&0===S||4===e)&&C===c&&(C=-5),C)},r.inflateEnd=function(t){if(!t||!t.state)return l;var e=t.state;return e.window&&(e.window=null),t.state=null,c},r.inflateGetHeader=function(t,e){var r;return t&&t.state?0==(2&(r=t.state).wrap)?l:((r.head=e).done=!1,c):l},r.inflateSetDictionary=function(t,e){var r,n=e.length;return t&&t.state?0!==(r=t.state).wrap&&11!==r.mode?l:11===r.mode&&i(1,e,n,0)!==r.check?-3:$(t,e,n,n)?(r.mode=31,-4):(r.havedict=1,c):l},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,r){var n=t("../utils/common"),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,r,u,f,c,l,h){var d,m,w,v,y,b,p,E,g,P=h.bits,S=0,T=0,$=0,k=0,O=0,_=0,A=0,R=0,D=0,N=0,j=null,I=0,M=new n.Buf16(16),C=new n.Buf16(16),L=null,x=0;for(S=0;S<=15;S++)M[S]=0;for(T=0;T<u;T++)M[e[r+T]]++;for(O=P,k=15;1<=k&&0===M[k];k--);if(k<O&&(O=k),0===k)return f[c++]=20971520,f[c++]=20971520,h.bits=1,0;for($=1;$<k&&0===M[$];$++);for(O<$&&(O=$),S=R=1;S<=15;S++)if(R<<=1,(R-=M[S])<0)return-1;if(0<R&&(0===t||1!==k))return-1;for(C[1]=0,S=1;S<15;S++)C[S+1]=C[S]+M[S];for(T=0;T<u;T++)0!==e[r+T]&&(l[C[e[r+T]]++]=T);if(b=0===t?(j=L=l,19):1===t?(j=i,I-=257,L=s,x-=257,256):(j=o,L=a,-1),S=$,y=c,A=T=N=0,w=-1,v=(D=1<<(_=O))-1,1===t&&852<D||2===t&&592<D)return 1;for(;;){for(p=S-A,g=l[T]<b?(E=0,l[T]):l[T]>b?(E=L[x+l[T]],j[I+l[T]]):(E=96,0),d=1<<S-A,$=m=1<<_;f[y+(N>>A)+(m-=d)]=p<<24|E<<16|g|0,0!==m;);for(d=1<<S-1;N&d;)d>>=1;if(0!==d?(N&=d-1,N+=d):N=0,T++,0==--M[S]){if(S===k)break;S=e[r+l[T]]}if(O<S&&(N&v)!==w){for(0===A&&(A=O),y+=$,R=1<<(_=S-A);_+A<k&&!((R-=M[_+A])<=0);)_++,R<<=1;if(D+=1<<_,1===t&&852<D||2===t&&592<D)return 1;f[w=N&v]=O<<24|_<<16|y-c|0}}return 0!==N&&(f[y+N]=S-A<<24|64<<16|0),h.bits=O,0}},{"../utils/common":41}],51:[function(t,e,r){e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,r){var n=t("../utils/common"),i=0,s=1;function o(t){for(var e=t.length;0<=--e;)t[e]=0}var a=0,u=29,f=256,c=f+1+u,l=30,h=19,d=2*c+1,m=15,w=16,v=7,y=256,b=16,p=17,E=18,g=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],P=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],T=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$=new Array(2*(c+2));o($);var k=new Array(2*l);o(k);var O=new Array(512);o(O);var _=new Array(256);o(_);var A=new Array(u);o(A);var R,D,N,j=new Array(l);function I(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function M(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function C(t){return t<256?O[t]:O[256+(t>>>7)]}function L(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function x(t,e,r){t.bi_valid>w-r?(t.bi_buf|=e<<t.bi_valid&65535,L(t,t.bi_buf),t.bi_buf=e>>w-t.bi_valid,t.bi_valid+=r-w):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function B(t,e,r){x(t,r[2*e],r[2*e+1])}function F(t,e){for(var r=0;r|=1&t,t>>>=1,r<<=1,0<--e;);return r>>>1}function U(t,e,r){var n,i,s=new Array(m+1),o=0;for(n=1;n<=m;n++)s[n]=o=o+r[n-1]<<1;for(i=0;i<=e;i++){var a=t[2*i+1];0!==a&&(t[2*i]=F(s[a]++,a))}}function q(t){var e;for(e=0;e<c;e++)t.dyn_ltree[2*e]=0;for(e=0;e<l;e++)t.dyn_dtree[2*e]=0;for(e=0;e<h;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*y]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function W(t){8<t.bi_valid?L(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function G(t,e,r,n){var i=2*e,s=2*r;return t[i]<t[s]||t[i]===t[s]&&n[e]<=n[r]}function z(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&G(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!G(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function H(t,e,r){var n,i,s,o,a=0;if(0!==t.last_lit)for(;n=t.pending_buf[t.d_buf+2*a]<<8|t.pending_buf[t.d_buf+2*a+1],i=t.pending_buf[t.l_buf+a],a++,0===n?B(t,i,e):(B(t,(s=_[i])+f+1,e),0!==(o=g[s])&&x(t,i-=A[s],o),B(t,s=C(--n),r),0!==(o=P[s])&&x(t,n-=j[s],o)),a<t.last_lit;);B(t,y,e)}function V(t,e){var r,n,i,s=e.dyn_tree,o=e.stat_desc.static_tree,a=e.stat_desc.has_stree,u=e.stat_desc.elems,f=-1;for(t.heap_len=0,t.heap_max=d,r=0;r<u;r++)0!==s[2*r]?(t.heap[++t.heap_len]=f=r,t.depth[r]=0):s[2*r+1]=0;for(;t.heap_len<2;)s[2*(i=t.heap[++t.heap_len]=f<2?++f:0)]=1,t.depth[i]=0,t.opt_len--,a&&(t.static_len-=o[2*i+1]);for(e.max_code=f,r=t.heap_len>>1;1<=r;r--)z(t,s,r);for(i=u;r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],z(t,s,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,s[2*i]=s[2*r]+s[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,s[2*r+1]=s[2*n+1]=i,t.heap[1]=i++,z(t,s,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,n,i,s,o,a,u=e.dyn_tree,f=e.max_code,c=e.stat_desc.static_tree,l=e.stat_desc.has_stree,h=e.stat_desc.extra_bits,w=e.stat_desc.extra_base,v=e.stat_desc.max_length,y=0;for(s=0;s<=m;s++)t.bl_count[s]=0;for(u[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<d;r++)v<(s=u[2*u[2*(n=t.heap[r])+1]+1]+1)&&(s=v,y++),u[2*n+1]=s,f<n||(t.bl_count[s]++,o=0,w<=n&&(o=h[n-w]),a=u[2*n],t.opt_len+=a*(s+o),l&&(t.static_len+=a*(c[2*n+1]+o)));if(0!==y){do{for(s=v-1;0===t.bl_count[s];)s--;t.bl_count[s]--,t.bl_count[s+1]+=2,t.bl_count[v]--,y-=2}while(0<y);for(s=v;0!==s;s--)for(n=t.bl_count[s];0!==n;)f<(i=t.heap[--r])||(u[2*i+1]!==s&&(t.opt_len+=(s-u[2*i+1])*u[2*i],u[2*i+1]=s),n--)}}(t,e),U(s,f,t.bl_count)}function Q(t,e,r){var n,i,s=-1,o=e[1],a=0,u=7,f=4;for(0===o&&(u=138,f=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=o,o=e[2*(n+1)+1],++a<u&&i===o||(a<f?t.bl_tree[2*i]+=a:0!==i?(i!==s&&t.bl_tree[2*i]++,t.bl_tree[2*b]++):a<=10?t.bl_tree[2*p]++:t.bl_tree[2*E]++,s=i,f=(a=0)===o?(u=138,3):i===o?(u=6,3):(u=7,4))}function K(t,e,r){var n,i,s=-1,o=e[1],a=0,u=7,f=4;for(0===o&&(u=138,f=3),n=0;n<=r;n++)if(i=o,o=e[2*(n+1)+1],!(++a<u&&i===o)){if(a<f)for(;B(t,i,t.bl_tree),0!=--a;);else 0!==i?(i!==s&&(B(t,i,t.bl_tree),a--),B(t,b,t.bl_tree),x(t,a-3,2)):a<=10?(B(t,p,t.bl_tree),x(t,a-3,3)):(B(t,E,t.bl_tree),x(t,a-11,7));s=i,f=(a=0)===o?(u=138,3):i===o?(u=6,3):(u=7,4)}}o(j);var Z=!1;function J(t,e,r,i){x(t,(a<<1)+(i?1:0),3),function(t,e,r,i){W(t),i&&(L(t,r),L(t,~r)),n.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}(t,e,r,!0)}r._tr_init=function(t){Z||(function(){var t,e,r,n,i,s=new Array(m+1);for(n=r=0;n<u-1;n++)for(A[n]=r,t=0;t<1<<g[n];t++)_[r++]=n;for(_[r-1]=n,n=i=0;n<16;n++)for(j[n]=i,t=0;t<1<<P[n];t++)O[i++]=n;for(i>>=7;n<l;n++)for(j[n]=i<<7,t=0;t<1<<P[n]-7;t++)O[256+i++]=n;for(e=0;e<=m;e++)s[e]=0;for(t=0;t<=143;)$[2*t+1]=8,t++,s[8]++;for(;t<=255;)$[2*t+1]=9,t++,s[9]++;for(;t<=279;)$[2*t+1]=7,t++,s[7]++;for(;t<=287;)$[2*t+1]=8,t++,s[8]++;for(U($,c+1,s),t=0;t<l;t++)k[2*t+1]=5,k[2*t]=F(t,5);R=new I($,g,f+1,c,m),D=new I(k,P,0,l,m),N=new I(new Array(0),S,0,h,v)}(),Z=!0),t.l_desc=new M(t.dyn_ltree,R),t.d_desc=new M(t.dyn_dtree,D),t.bl_desc=new M(t.bl_tree,N),t.bi_buf=0,t.bi_valid=0,q(t)},r._tr_stored_block=J,r._tr_flush_block=function(t,e,r,n){var o,a,u=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return i;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return s;for(e=32;e<f;e++)if(0!==t.dyn_ltree[2*e])return s;return i}(t)),V(t,t.l_desc),V(t,t.d_desc),u=function(t){var e;for(Q(t,t.dyn_ltree,t.l_desc.max_code),Q(t,t.dyn_dtree,t.d_desc.max_code),V(t,t.bl_desc),e=h-1;3<=e&&0===t.bl_tree[2*T[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),o=t.opt_len+3+7>>>3,(a=t.static_len+3+7>>>3)<=o&&(o=a)):o=a=r+5,r+4<=o&&-1!==e?J(t,e,r,n):4===t.strategy||a===o?(x(t,2+(n?1:0),3),H(t,$,k)):(x(t,4+(n?1:0),3),function(t,e,r,n){var i;for(x(t,e-257,5),x(t,r-1,5),x(t,n-4,4),i=0;i<n;i++)x(t,t.bl_tree[2*T[i]+1],3);K(t,t.dyn_ltree,e-1),K(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,u+1),H(t,t.dyn_ltree,t.dyn_dtree)),q(t),n&&W(t)},r._tr_tally=function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(_[r]+f+1)]++,t.dyn_dtree[2*C(e)]++),t.last_lit===t.lit_bufsize-1},r._tr_align=function(t){x(t,2,3),B(t,y,$),function(t){16===t.bi_valid?(L(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,r){e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,r){(function(t){!function(t,e){if(!t.setImmediate){var r,n,i,s,o=1,a={},u=!1,f=t.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(t);c=c&&c.setTimeout?c:t,r="[object process]"==={}.toString.call(t.process)?function(t){G.nextTick((function(){h(t)}))}:function(){if(t.postMessage&&!t.importScripts){var e=!0,r=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=r,e}}()?(s="setImmediate$"+Math.random()+"$",t.addEventListener?t.addEventListener("message",d,!1):t.attachEvent("onmessage",d),function(e){t.postMessage(s+e,"*")}):t.MessageChannel?((i=new MessageChannel).port1.onmessage=function(t){h(t.data)},function(t){i.port2.postMessage(t)}):f&&"onreadystatechange"in f.createElement("script")?(n=f.documentElement,function(t){var e=f.createElement("script");e.onreadystatechange=function(){h(t),e.onreadystatechange=null,n.removeChild(e),e=null},n.appendChild(e)}):function(t){setTimeout(h,0,t)},c.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return a[o]=i,r(o),o++},c.clearImmediate=l}function l(t){delete a[t]}function h(t){if(u)setTimeout(h,0,t);else{var r=a[t];if(r){u=!0;try{!function(t){var r=t.callback,n=t.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(e,n)}}(r)}finally{l(t),u=!1}}}}function d(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(s)&&h(+e.data.slice(s.length))}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,"undefined"!=typeof ie?ie:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)}))}));const We=(()=>{if("undefined"==typeof self)return!1;return"showOpenFilePicker"in self})(),Ge=We?Promise.resolve().then((function(){return Ze})):Promise.resolve().then((function(){return ir}));async function ze(...t){return(await Ge).default(...t)}We?Promise.resolve().then((function(){return tr})):Promise.resolve().then((function(){return or}));const He=We?Promise.resolve().then((function(){return rr})):Promise.resolve().then((function(){return ur}));async function Ve(...t){return(await He).default(...t)}const Qe=async t=>{const e=await t.getFile();return e.handle=t,e};var Ke=async(t=[{}])=>{Array.isArray(t)||(t=[t]);const e=[];t.forEach(((t,r)=>{e[r]={description:t.description||"Files",accept:{}},t.mimeTypes?t.mimeTypes.map((n=>{e[r].accept[n]=t.extensions||[]})):e[r].accept["*/*"]=t.extensions||[]}));const r=await window.showOpenFilePicker({id:t[0].id,startIn:t[0].startIn,types:e,multiple:t[0].multiple||!1,excludeAcceptAllOption:t[0].excludeAcceptAllOption||!1}),n=await Promise.all(r.map(Qe));return t[0].multiple?n:n[0]},Ze={__proto__:null,default:Ke};function Je(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then((function(t){return{value:t,done:e}}))}return Je=function(t){this.s=t,this.n=t.next},Je.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var r=this.s.return;return void 0===r?Promise.resolve({value:t,done:!0}):e(r.apply(this.s,arguments))},throw:function(t){var r=this.s.return;return void 0===r?Promise.reject(t):e(r.apply(this.s,arguments))}},new Je(t)}const Xe=async(t,e,r=t.name,n)=>{const i=[],s=[];var o,a=!1,u=!1;try{for(var f,c=function(t){var e,r,n,i=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);i--;){if(r&&null!=(e=t[r]))return e.call(t);if(n&&null!=(e=t[n]))return new Je(e.call(t));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}(t.values());a=!(f=await c.next()).done;a=!1){const o=f.value,a=`${r}/${o.name}`;"file"===o.kind?s.push(o.getFile().then((e=>(e.directoryHandle=t,e.handle=o,Object.defineProperty(e,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>a}))))):"directory"!==o.kind||!e||n&&n(o)||i.push(Xe(o,e,a,n))}}catch(t){u=!0,o=t}finally{try{a&&null!=c.return&&await c.return()}finally{if(u)throw o}}return[...(await Promise.all(i)).flat(),...await Promise.all(s)]};var Ye=async(t={})=>{t.recursive=t.recursive||!1,t.mode=t.mode||"read";const e=await window.showDirectoryPicker({id:t.id,startIn:t.startIn,mode:t.mode});return(await(await e.values()).next()).done?[e]:Xe(e,t.recursive,void 0,t.skipDirectory)},tr={__proto__:null,default:Ye},er=async(t,e=[{}],r=null,n=!1,i=null)=>{Array.isArray(e)||(e=[e]),e[0].fileName=e[0].fileName||"Untitled";const s=[];let o=null;if(t instanceof Blob&&t.type?o=t.type:t.headers&&t.headers.get("content-type")&&(o=t.headers.get("content-type")),e.forEach(((t,e)=>{s[e]={description:t.description||"Files",accept:{}},t.mimeTypes?(0===e&&o&&t.mimeTypes.push(o),t.mimeTypes.map((r=>{s[e].accept[r]=t.extensions||[]}))):o?s[e].accept[o]=t.extensions||[]:s[e].accept["*/*"]=t.extensions||[]})),r)try{await r.getFile()}catch(t){if(r=null,n)throw t}const a=r||await window.showSaveFilePicker({suggestedName:e[0].fileName,id:e[0].id,startIn:e[0].startIn,types:s,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1});!r&&i&&i(a);const u=await a.createWritable();if("stream"in t){const e=t.stream();return await e.pipeTo(u),a}return"body"in t?(await t.body.pipeTo(u),a):(await u.write(await t),await u.close(),a)},rr={__proto__:null,default:er},nr=async(t=[{}])=>(Array.isArray(t)||(t=[t]),new Promise(((e,r)=>{const n=document.createElement("input");n.type="file";const i=[...t.map((t=>t.mimeTypes||[])),...t.map((t=>t.extensions||[]))].join();n.multiple=t[0].multiple||!1,n.accept=i||"",n.style.display="none",document.body.append(n);const s=t=>{"function"==typeof o&&o(),e(t)},o=t[0].legacySetup&&t[0].legacySetup(s,(()=>o(r)),n),a=()=>{window.removeEventListener("focus",a),n.remove()};n.addEventListener("click",(()=>{window.addEventListener("focus",a)})),n.addEventListener("change",(()=>{window.removeEventListener("focus",a),n.remove(),s(n.multiple?Array.from(n.files):n.files[0])})),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()}))),ir={__proto__:null,default:nr},sr=async(t=[{}])=>(Array.isArray(t)||(t=[t]),t[0].recursive=t[0].recursive||!1,new Promise(((e,r)=>{const n=document.createElement("input");n.type="file",n.webkitdirectory=!0;const i=t=>{"function"==typeof s&&s(),e(t)},s=t[0].legacySetup&&t[0].legacySetup(i,(()=>s(r)),n);n.addEventListener("change",(()=>{let e=Array.from(n.files);t[0].recursive?t[0].recursive&&t[0].skipDirectory&&(e=e.filter((e=>e.webkitRelativePath.split("/").every((e=>!t[0].skipDirectory({name:e,kind:"directory"})))))):e=e.filter((t=>2===t.webkitRelativePath.split("/").length)),i(e)})),"showPicker"in HTMLInputElement.prototype?n.showPicker():n.click()}))),or={__proto__:null,default:sr},ar=async(t,e={})=>{Array.isArray(e)&&(e=e[0]);const r=document.createElement("a");let n=t;"body"in t&&(n=await async function(t,e){const r=t.getReader(),n=new ReadableStream({start:t=>async function e(){return r.read().then((({done:r,value:n})=>{if(!r)return t.enqueue(n),e();t.close()}))}()}),i=new Response(n),s=await i.blob();return r.releaseLock(),new Blob([s],{type:e})}(t.body,t.headers.get("content-type"))),r.download=e.fileName||"Untitled",r.href=URL.createObjectURL(await n);const i=()=>{"function"==typeof s&&s()},s=e.legacySetup&&e.legacySetup(i,(()=>s()),r);return r.addEventListener("click",(()=>{setTimeout((()=>URL.revokeObjectURL(r.href)),3e4),i()})),r.click(),null},ur={__proto__:null,default:ar};const fr=":host{display:block;--jeep-sqlite-top:10%;--jeep-sqlite-right:1%;--jeep-sqlite-font-size:2em;--jeep-sqlite-padding:2%;--jeep-sqlite-background-color:#a9a9a9;--jeep-sqlite-color:#ffffff}#fileElem{display:none}#pickButton{position:absolute;top:var(--jeep-sqlite-top);right:var(--jeep-sqlite-right);font-size:var(--jeep-sqlite-font-size);padding:var(--jeep-sqlite-padding);background-color:var(--jeep-sqlite-background-color);color:var(--jeep-sqlite-color)}#saveButton{position:absolute;top:var(--jeep-sqlite-top);right:var(--jeep-sqlite-right);font-size:var(--jeep-sqlite-font-size);padding:var(--jeep-sqlite-padding);background-color:var(--jeep-sqlite-background-color);color:var(--jeep-sqlite-color)}";const cr=class{constructor(r){t(this,r);this.importProgress=e(this,"jeepSqliteImportProgress",7);this.exportProgress=e(this,"jeepSqliteExportProgress",7);this.HTTPRequestEnded=e(this,"jeepSqliteHTTPRequestEnded",7);this.PickDatabaseEnded=e(this,"jeepSqlitePickDatabaseEnded",7);this.SaveDatabaseEnded=e(this,"jeepSqliteSaveDatabaseToDisk",7);this.isStore=false;this._dbDict={};this.databaseList={};this._versionUpgrades={};this._overwrite=true;this.autoSave=false;this.typeOrm=false;this.wasmPath=undefined;this.pickText=undefined;this.saveText=undefined;this.buttonOptions=undefined;this.innerAutoSave=undefined;this.innerTypeOrm=undefined;this.innerWasmPath=undefined;this.innerPickText=undefined;this.innerSaveText=undefined;this.innerButtonOptions=undefined}parseAutoSave(t){this.innerAutoSave=t}parseTypeOrm(t){this.innerTypeOrm=t}parseWasmPath(t){this.innerWasmPath=t}parsePickText(t){this.innerPickText=t}parseSaveText(t){this.innerSaveText=t}parseButtonOptions(t){this.innerButtonOptions=JSON.parse(t);const e=Object.keys(this.innerButtonOptions);for(const t of e){switch(t){case"top":{this.el.style.setProperty("--jeep-sqlite-top",this.innerButtonOptions[t]);break}case"right":{this.el.style.setProperty("--jeep-sqlite-right",this.innerButtonOptions[t]);break}case"fontSize":{this.el.style.setProperty("--jeep-sqlite-font-size",this.innerButtonOptions[t]);break}case"padding":{this.el.style.setProperty("--jeep-sqlite-padding",this.innerButtonOptions[t]);break}case"backgroundColor":{this.el.style.setProperty("--jeep-sqlite-background-color",this.innerButtonOptions[t]);break}case"color":{this.el.style.setProperty("--jeep-sqlite-color",this.innerButtonOptions[t]);break}}}}async echo(t){return t}async createConnection(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.version?t.version:1;const i=t.readonly?t.readonly:false;try{await this._createConnection(r,n,i);return Promise.resolve()}catch(t){return Promise.reject(t)}}async isConnection(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;const i=await this._isConnection(r,n);return Promise.resolve(i)}async closeConnection(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{await this._closeConnection(r,n);return Promise.resolve()}catch(t){return Promise.reject(t)}}async open(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{await this._open(r,n);return Promise.resolve()}catch(t){return Promise.reject(t)}}async close(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{await this._close(r,n);return Promise.resolve()}catch(t){return Promise.reject(t)}}async getVersion(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{const t=await this._getVersion(r,n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async beginTransaction(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;if(n){return Promise.reject(`BeginTransaction: not allowed in read-only mode`)}try{const t=await this._beginTransaction(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async commitTransaction(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;if(n){return Promise.reject(`CommitTransaction: not allowed in read-only mode`)}try{const t=await this._commitTransaction(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async rollbackTransaction(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;if(n){return Promise.reject(`BeginTransaction: not allowed in read-only mode`)}try{const t=await this._rollbackTransaction(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async isTransactionActive(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;if(n){return Promise.reject(`isTransactionActive: not allowed in read-only mode`)}try{const t=await this._isTransactionActive(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async execute(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}if(!e.includes("statements")||t.statements.length===0){return Promise.reject("Must provide raw SQL statements")}const r=t.database;const n=t.statements;let i=true;const s=t.readonly?t.readonly:false;if(e.includes("transaction"))i=t.transaction;try{const t=await this._execute(r,n,i,s);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async executeSet(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}if(!e.includes("set")||t.set.length===0){return Promise.reject("Must provide a non-empty set of SQL statements")}const r=t.database;const n=t.set;let i=true;if(e.includes("transaction"))i=t.transaction;const s=t.readonly?t.readonly:false;const o=t.returnMode?t.returnMode:"no";try{const t=await this._executeSet(r,n,i,s,o);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async run(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}if(!e.includes("statement")||t.statement.length===0){return Promise.reject("Must provide a run statement")}const r=t.database;const n=t.statement;let i=[];if(e.includes("values")){i=t.values.length>0?t.values:[]}let s=true;if(e.includes("transaction"))s=t.transaction;const o=t.readonly?t.readonly:false;const a=t.returnMode?t.returnMode:"no";try{const t=await this._run(r,n,i,s,o,a);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async query(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}if(!e.includes("statement")||t.statement.length===0){return Promise.reject("Must provide a query statement")}let r=[];if(e.includes("values")){r=t.values.length>0?t.values:[]}const n=t.database;const i=t.statement;const s=t.readonly?t.readonly:false;try{const t=await this._query(n,i,r,s);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async getTableList(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{const t=await this._getTableList(r,n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async isDBExists(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{const t=await this._isDBExists(r,n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async isDBOpen(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{const t=await this._isDBOpen(r,n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async deleteDatabase(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{return await this._deleteDatabase(r,n)}catch(t){return Promise.reject(t)}}async isStoreOpen(){return Promise.resolve(this.isStore)}async copyFromAssets(t){let e;if(t!=null){const r=Object.keys(t);e=r.includes("overwrite")?t.overwrite:true}else{e=true}if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}try{await this._copyFromAssets(e);return Promise.resolve()}catch(t){return Promise.reject(t)}}async isTableExists(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;if(!e.includes("table")){return Promise.reject("Must provide a table name")}const n=t.table;const i=t.readonly?t.readonly:false;try{const t=await this._isTableExists(r,n,i);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async createSyncTable(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{const t=await this._createSyncTable(r,n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async getSyncDate(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{const t=await this._getSyncDate(r,n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async setSyncDate(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}if(!e.includes("syncdate")){return Promise.reject("Must provide a synchronization date")}const r=t.database;const n=t.syncdate;const i=t.readonly?t.readonly:false;try{await this._setSyncDate(r,n,i);return Promise.resolve()}catch(t){return Promise.reject(t)}}async isJsonValid(t){const e=Object.keys(t);if(!e.includes("jsonstring")){return Promise.reject("Must provide a json object")}const r=t.jsonstring;try{const t=await this._isJsonValid(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async importFromJson(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("jsonstring")){return Promise.reject("Must provide a json object")}const r=t.jsonstring;try{const t=await this._importFromJson(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async exportToJson(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}if(!e.includes("jsonexportmode")){return Promise.reject("Must provide a json export mode")}const r=t.database;const n=t.jsonexportmode;const i=t.readonly?t.readonly:false;try{const t=await this._exportToJson(r,n,i);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async deleteExportedRows(t){const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{await this._deleteExportedRows(r,n);return Promise.resolve()}catch(t){return Promise.reject(t)}}async addUpgradeStatement(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}if(!e.includes("upgrade")){return Promise.reject("Must provide an upgrade capSQLiteVersionUpgrade Object")}const r=t.database;const n=t.upgrade;for(const t of n){const e=Object.keys(t);if(!e.includes("toVersion")||!e.includes("statements")){return Promise.reject("Must provide an upgrade capSQLiteVersionUpgrade Object")}if(typeof t.toVersion!="number"){return Promise.reject("upgrade.toVersion must be a number")}if(this._versionUpgrades[r]){this._versionUpgrades[r][t.toVersion]=t}else{const e={};e[t.toVersion]=t;this._versionUpgrades[r]=e}}return Promise.resolve()}async isDatabase(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;try{const t=await this._isDatabase(r);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async getDatabaseList(){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}try{const t=await this._getDatabaseList();return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async checkConnectionsConsistency(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("dbNames")){return Promise.reject(`Must provide a list of connection's name`)}const r=t.dbNames;if(!e.includes("openModes")){return Promise.reject(`Must provide a list of connection's open mode`)}const n=t.openModes;try{const t=await this._checkConnectionsConsistency(r,n);return Promise.resolve(t)}catch(t){return Promise.reject(t)}}async saveToStore(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;const n=t.readonly?t.readonly:false;try{await this._saveToStore(r,n);return Promise.resolve()}catch(t){return Promise.reject(t)}}async saveToLocalDisk(t){const e=Object.keys(t);if(!e.includes("database")){return Promise.reject("Must provide a database name")}const r=t.database;try{await this._saveToLocalDisk(r);return Promise.resolve()}catch(t){return Promise.reject(t)}}async getFromLocalDiskToStore(t){const e=t.overwrite?t.overwrite:true;if(We){console.log("Using the File System Access API.")}else{console.log("Using the fallback implementation.")}try{await this._getFromLocalDiskToStore(e);return Promise.resolve()}catch(t){return Promise.reject(t)}}async getFromHTTPRequest(t){if(!this.isStore){return Promise.reject(`>>> jeep-sqlite StoreName: ${this.storeName} is not opened`)}let e=Object.keys(t);if(!e.includes("url")){return Promise.reject("Must provide an url")}const r=t.url;const n=t.overwrite?t.overwrite:true;try{await this._getFromHTTPRequest(r,n);return Promise.resolve()}catch(t){return Promise.reject(t)}}connectedCallback(){this.parseAutoSave(this.autoSave!==undefined?this.autoSave:false);this.parseTypeOrm(this.typeOrm!==undefined?this.typeOrm:false);this.parseWasmPath(this.wasmPath!==undefined?this.wasmPath:"/assets");this.parseSaveText(this.saveText!==undefined?this.saveText:"Save");this.parsePickText(this.pickText!==undefined?this.pickText:"Pick a database");if(this.buttonOptions!==undefined){this.parseButtonOptions(this.buttonOptions)}this.openStore("jeepSqliteStore","databases").then((t=>{this.isStore=t}))}componentWillLoad(){}async componentDidLoad(){this._element=this.el.shadowRoot;if(!this.isStore){console.log("jeep-sqlite isStore = false")}}async _createConnection(t,e,r){let n={};const i=Object.keys(this._versionUpgrades);if(i.length!==0&&i.includes(t)){n=this._versionUpgrades[t]}const s=Object.keys(this._dbDict);let o;try{if(s.length>0&&(s.includes("RW_"+t)||s.includes("RO_"+t))){o=s.includes("RW_"+t)?this._dbDict["RW_"+t]:this._dbDict["RO_"+t]}else{o=new Fe(t+"SQLite.db",e,n,this.store,this.innerAutoSave,this.innerWasmPath)}const i=r?"RO_"+t:"RW_"+t;this._dbDict[i]=o;return Promise.resolve()}catch(t){return Promise.reject(t.message)}}async _isConnection(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(r.includes(n)){return{result:true}}else{return{result:false}}}async _closeConnection(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`CloseConnection: No available connection for ${t}`)}const i=this._dbDict[n];try{if(i.isDBOpen()){try{await i.close()}catch(e){return Promise.reject(`CloseConnection: close ${t} failed ${e}`)}}delete this._dbDict[n];return Promise.resolve()}catch(t){return Promise.reject(`CloseConnection: ${t.message}`)}}async _open(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`Open: No available connection for ${t}`)}const i=this._dbDict[n];try{await i.open();return Promise.resolve()}catch(t){return Promise.reject(`Open: ${t.message}`)}}async _close(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`Close: No available connection for ${t}`)}const i=this._dbDict[n];try{await i.close();return Promise.resolve()}catch(t){return Promise.reject(`Close: ${t.message}`)}}async _saveToStore(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`SaveToStore: No available connection for ${t}`)}const i=this._dbDict[n];try{await i.saveToStore();return Promise.resolve()}catch(t){return Promise.reject(`SaveToStore: ${t.message}`)}}async _saveToLocalDisk(t){try{const e=Object.keys(this._dbDict);const r="RW_"+t;if(!e.includes(r)){return Promise.reject("_saveToLocalDisk: No available connection for "+`${t}`)}const n=this._dbDict[r];const i=await n.exportDB();this._blob=await this.uint2blob(i);const s=`${t}SQLite.db`;this._opts={fileName:s,extensions:[".db"]};this._buttonSaveEl=document.createElement("button");this._buttonSaveEl.setAttribute("id","saveButton");this._buttonSaveEl.innerHTML=`${this.innerSaveText} ${s}`;this._element.appendChild(this._buttonSaveEl);this._buttonSaveEl.addEventListener("click",this.saveFile.bind(this));return Promise.resolve()}catch(t){return Promise.reject(`_saveToLocalDisk: ${t.message}`)}}async _getFromLocalDiskToStore(t){this._buttonPickEl=document.createElement("button");this._buttonPickEl.setAttribute("id","pickButton");this._buttonPickEl.innerHTML=`${this.innerPickText}`;this._element.appendChild(this._buttonPickEl);this._buttonPickEl.addEventListener("click",this.pickDatabase.bind(this));this._overwrite=t;return Promise.resolve()}async pickDatabase(){try{const t=await ze({extensions:[".db"]});let e=await this.blob2uint(t);const r=this.removePathSuffix(t.name);const n=this.setPathSuffix(t.name);const i=await Re.isDBInStore(n,this.store);if(!i){await Re.saveDBToStore(n,e,this.store)}else{if(this._overwrite){await Re.removeDBFromStore(n,this.store);await Re.saveDBToStore(n,e,this.store)}else{this.PickDatabaseEnded.emit({message:`Error: cannot overwrite ${n}`})}}this._element.removeChild(this._buttonPickEl);this.PickDatabaseEnded.emit({db_name:r})}catch(t){const e=t.message?t.message:t;this.PickDatabaseEnded.emit({message:e})}}async saveFile(){try{await Ve(this._blob,[this._opts]);const t=this._opts.fileName;this._element.removeChild(this._buttonSaveEl);this.SaveDatabaseEnded.emit({db_name:t})}catch(t){const e=t.message?t.message:t;this.SaveDatabaseEnded.emit({message:e})}}async _getVersion(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`Open: No available connection for ${t}`)}const i=this._dbDict[n];try{const t=await i.getVersion();const e={};e.version=t;return Promise.resolve(e)}catch(t){return Promise.reject(`Open: ${t.message}`)}}async _beginTransaction(t){const e=Object.keys(this._dbDict);const r="RW_"+t;if(!e.includes(r)){return Promise.reject(`BeginTransaction: No available connection for ${t}`)}const n=this._dbDict[r];let i={};const s=await n.beginTransaction();i={changes:{changes:s}};return Promise.resolve(i)}async _commitTransaction(t){const e=Object.keys(this._dbDict);const r="RW_"+t;if(!e.includes(r)){return Promise.reject(`CommitTransaction: No available connection for ${t}`)}const n=this._dbDict[r];let i={};const s=await n.commitTransaction();i={changes:{changes:s}};return Promise.resolve(i)}async _rollbackTransaction(t){const e=Object.keys(this._dbDict);const r="RW_"+t;if(!e.includes(r)){return Promise.reject(`RollbackTransaction: No available connection for ${t}`)}const n=this._dbDict[r];let i={};const s=await n.rollbackTransaction();i={changes:{changes:s}};return Promise.resolve(i)}async _isTransactionActive(t){const e=Object.keys(this._dbDict);const r="RW_"+t;if(!e.includes(r)){return Promise.reject(`IsTransactionActive: No available connection for ${t}`)}const n=this._dbDict[r];let i={};const s=n.isTransActive();i={result:s};return Promise.resolve(i)}async _execute(t,e,r,n){const i=Object.keys(this._dbDict);const s="RW_"+t;if(!i.includes(s)){return Promise.reject(`Execute: No available connection for ${t}`)}const o=this._dbDict[s];if(n){return Promise.reject(`Execute: not allowed in read-only mode`)}let a={};const u=e.substring(0,6);if(this.innerAutoSave&&u==="COMMIT"&&this.innerTypeOrm){a={changes:{changes:0}};return Promise.resolve(a)}try{const t=await o.executeSQL(e,r);a={changes:{changes:t}};return Promise.resolve(a)}catch(t){return Promise.reject(`Execute: ${t.message}`)}}async _executeSet(t,e,r,n,i){const s=Object.keys(this._dbDict);const o="RW_"+t;if(!s.includes(o)){return Promise.reject(`ExecuteSet: No available connection for ${t}`)}const a=this._dbDict[o];if(n){return Promise.reject(`ExecuteSet: not allowed in read-only mode`)}for(const t of e){if(!("statement"in t)||!("values"in t)){return Promise.reject("ExecuteSet: Must provide a set as "+"Array of {statement,values}")}}try{const t=await a.execSet(e,r,i);const n={changes:{changes:t.changes,lastId:t.lastId,values:t.values}};return Promise.resolve(n)}catch(t){return Promise.reject(`ExecuteSet: ${t.message}`)}}async _run(t,e,r,n,i,s){const o=Object.keys(this._dbDict);const a="RW_"+t;if(!o.includes(a)){return Promise.reject(`Run: No available connection for ${t}`)}const u=this._dbDict[a];if(i){return Promise.reject(`Run: not allowed in read-only mode`)}let f={};const c=e.substring(0,6);if(this.innerAutoSave&&c==="COMMIT"){f={changes:{changes:0}};return Promise.resolve(f)}try{const t=await u.runSQL(e,r,n,s);f={changes:{changes:t.changes,lastId:t.lastId,values:t.values}};return Promise.resolve(f)}catch(t){return Promise.reject(`Run: ${t.message}`)}}async _query(t,e,r,n){const i=Object.keys(this._dbDict);const s=n?"RO_"+t:"RW_"+t;if(!i.includes(s)){return Promise.reject(`Query: No available connection for ${t}`)}const o=this._dbDict[s];let a=[];const u=e.substring(0,6);if(this.innerAutoSave&&u==="COMMIT"){return Promise.resolve({values:a})}try{a=await o.selectSQL(e,r);return Promise.resolve({values:a})}catch(t){return Promise.reject(`Query failed: ${t.message}`)}}async _getTableList(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`GetTableList: No available connection for ${t}`)}const i=this._dbDict[n];let s=[];try{s=await i.getTableNames();return Promise.resolve({values:s})}catch(t){return Promise.reject(`GetTableList failed: ${t.message}`)}}async _isDBExists(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`IsDBExists: No available connection for ${t}`)}const i=this._dbDict[n];try{const e=await i.isDBExists(t+"SQLite.db");const r={result:e};return Promise.resolve(r)}catch(t){return Promise.reject(`IsDBExists: ${t.message}`)}}async _isDBOpen(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject(`IsDBOpen: No available connection for ${t}`)}const i=this._dbDict[n];try{const e=await i.isDBOpen(t+"SQLite.db");const r={result:e};return Promise.resolve(r)}catch(t){return Promise.reject(`IsDBOpen: ${t.message}`)}}async _deleteDatabase(t,e){const r=Object.keys(this._dbDict);const n="RW_"+t;if(!r.includes(n)){return Promise.reject(`DeleteDatabase: No available connection for ${t}`)}const i=this._dbDict[n];if(e){return Promise.reject(`DeleteDatabase: not allowed in read-only mode`)}try{await i.deleteDB(t+"SQLite.db");return Promise.resolve()}catch(t){return Promise.reject(`DeleteDatabase: ${t.message}`)}}async _isTableExists(t,e,r){const n=Object.keys(this._dbDict);const i=r?"RO_"+t:"RW_"+t;if(!n.includes(i)){return Promise.reject(`IsTableExists: No available connection for ${t}`)}const s=this._dbDict[i];try{const t=await s.isTable(e);const r={result:t};return Promise.resolve(r)}catch(t){return Promise.reject(`IsTableExists: ${t.message}`)}}async _createSyncTable(t,e){const r=Object.keys(this._dbDict);const n="RW_"+t;if(!r.includes(n)){return Promise.reject("CreateSyncTable: No available connection for "+`${t}`)}const i=this._dbDict[n];if(e){return Promise.reject(`CreateSyncTable: not allowed in read-only mode`)}try{const t=await i.createSyncTable();return Promise.resolve({changes:{changes:t}})}catch(t){return Promise.reject(`CreateSyncTable: ${t.message}`)}}async _getSyncDate(t,e){const r=Object.keys(this._dbDict);const n=e?"RO_"+t:"RW_"+t;if(!r.includes(n)){return Promise.reject("GetSyncDate: No available connection for "+`${t}`)}const i=this._dbDict[n];try{const t=await i.getSyncDate();return Promise.resolve({syncDate:t})}catch(t){return Promise.reject(`GetSyncDate: ${t.message}`)}}async _setSyncDate(t,e,r){const n=Object.keys(this._dbDict);const i="RW_"+t;if(!n.includes(i)){return Promise.reject("SetSyncDate: No available connection for "+`${t}`)}const s=this._dbDict[i];if(r){return Promise.reject(`SetSyncDate: not allowed in read-only mode`)}try{const t=await s.setSyncDate(e);if(t.result){return Promise.resolve()}else{return Promise.reject(`SetSyncDate: ${t.message}`)}}catch(t){return Promise.reject(`SetSyncDate: ${t.message}`)}}async _isJsonValid(t){const e=JSON.parse(t);const r=await Ne.isJsonSQLite(e);if(!r){return Promise.reject("IsJsonValid: Stringify Json Object not Valid")}else{return Promise.resolve({result:true})}}async _importFromJson(t){var e,r;const n=JSON.parse(t);const i=await Ne.isJsonSQLite(n);if(!i){return Promise.reject("ImportFromJson: Stringify Json Object not Valid")}const s=n;const o=`${s.database}SQLite.db`;const a=(e=s.version)!==null&&e!==void 0?e:1;const u=s.mode;const f=(r=s.overwrite)!==null&&r!==void 0?r:false;const c=new Fe(o,a,{},this.store,this.innerAutoSave,this.innerWasmPath);try{if(f&&u==="full"){const t=Re.isDBInStore(o,this.store);if(t){await Re.removeDBFromStore(o,this.store)}}await c.open();const t=await c.getTableNames();if(u==="full"&&t.length>0){const t=await c.getVersion();if(a<t){return Promise.reject(`ImportFromJson: Cannot import a version lower than ${t}`)}if(t===a){return Promise.resolve({changes:{changes:0}})}}const e=await c.importJson(s,this.importProgress);await c.close();return Promise.resolve({changes:{changes:e}})}catch(t){return Promise.reject(`ImportFromJson: ${t.message}`)}}async _exportToJson(t,e,r){const n=Object.keys(this._dbDict);const i=r?"RO_"+t:"RW_"+t;if(!n.includes(i)){return Promise.reject("ExportToJson: No available connection for "+`${t}`)}const s=this._dbDict[i];try{const t=await s.exportJson(e,this.exportProgress);const r=Object.keys(t);if(r.includes("message")){return Promise.reject(`ExportToJson: ${t.message}`)}else{return Promise.resolve({export:t})}}catch(t){return Promise.reject(`ExportToJson: ${t.message}`)}}async _deleteExportedRows(t,e){const r=Object.keys(this._dbDict);const n="RW_"+t;if(!r.includes(n)){return Promise.reject("ExportToJson: No available connection for "+`${t}`)}const i=this._dbDict[n];if(e){return Promise.reject(`SetSyncDate: not allowed in read-only mode`)}try{await i.deleteExportedRows()}catch(t){return Promise.reject(`DeleteExportedRows: ${t.message}`)}}async _copyFromAssets(t){const e=await this.loadJSON("/assets/databases/databases.json");if(e!=null){this.databaseList=JSON.parse(e);const r=Object.keys(this.databaseList);if(r.includes("databaseList")){try{for(const e of this.databaseList.databaseList){if(e.substring(e.length-3)===".db"){await this.copyDatabase(`/assets/databases/${e}`,t)}if(e.substring(e.length-4)===".zip"){await this.unzipDatabase(`/assets/databases/${e}`,t)}}return Promise.resolve()}catch(t){return Promise.reject(`CopyFromAssets: ${t.message}`)}}else{return Promise.reject(`CopyFromAssets: no key databaseList in databases.json`)}}else{return Promise.reject(`CopyFromAssets: no databases.json file in /assets/databases folder`)}}async _getFromHTTPRequest(t,e){try{let r;if(t.substring(t.length-3)===".db"){await this.copyDatabase(t,e);r="db"}if(t.substring(t.length-4)===".zip"){await this.unzipDatabase(t,e);r="zip"}this.HTTPRequestEnded.emit({message:r});return Promise.resolve()}catch(t){return Promise.reject(`GetFromHTTPRequest: ${t.message}`)}}async _isDatabase(t){try{const e=await Re.isDBInStore(t+"SQLite.db",this.store);const r={result:e};return Promise.resolve(r)}catch(t){return Promise.reject(`IsDatabase: ${t.message}`)}}async _getDatabaseList(){try{const t=await Re.getDBListFromStore(this.store);const e={values:t};return Promise.resolve(e)}catch(t){return Promise.reject(`GetDatabaseList: ${t.message}`)}}async _checkConnectionsConsistency(t,e){const r={};r.result=false;const n=[];t.forEach(((t,r)=>{n.push(`${e[r]}_${t}`)}));try{let t=new Set(Object.keys(this._dbDict));const e=new Set(n);if(e.size===0){await this._resetDbDict(Object.keys(this._dbDict));return Promise.resolve(r)}if(t.size<e.size){await this._resetDbDict(Object.keys(this._dbDict));return Promise.resolve(r)}if(t.size>e.size){const r={};for(const n of t){if(!Array.from(e.keys()).includes(n)){let t=false;if(n.substring(0,3)==="RO_"){t=true}r.database=n.substring(3);r.readonly=t;await this._closeConnection(r.database,r.readonly)}}}t=new Set(Object.keys(this._dbDict));if(t.size===e.size){const n=await this.symmetricDifference(t,e);if(n.size===0){r.result=true;return Promise.resolve(r)}else{await this._resetDbDict(Object.keys(this._dbDict));return Promise.resolve(r)}}else{await this._resetDbDict(Object.keys(this._dbDict));return Promise.resolve(r)}}catch(t){return Promise.reject(`CheckConnectionsConsistency: ${t.message}`)}}async _resetDbDict(t){try{for(const e of t){const t={};let r=false;if(e.substring(0,3)==="RO_"){r=true}t.database=e.substring(3);t.readonly=r;await this._closeConnection(t.database,t.readonly)}}catch(t){return Promise.reject(`ResetDbDict: ${t.message}`)}}async symmetricDifference(t,e){let r=new Set;t.forEach((t=>{r.add(t.substring(3))}));let n=new Set;e.forEach((t=>{n.add(t.substring(3))}));for(const t of n){if(r.has(t)){r.delete(t)}else{r.add(t)}}return r}async unzipDatabase(t,e){return new Promise(((r,n)=>{var i=new XMLHttpRequest;i.open("GET",t,true);i.responseType="arraybuffer";i.onerror=()=>{n(new Error(`unzipDatabase: failed`))};i.onload=()=>{qe.loadAsync(i.response).then((async t=>{const i=Object.keys(t.files);try{for(const r of i){await this.retrieveDBFromZip(t.files,r,e)}r()}catch(t){n(new Error(`unzipDatabase Error: ${t.message}`))}}))};i.send()}))}async retrieveDBFromZip(t,e,r){return new Promise(((n,i)=>{t[e].async("nodebuffer").then((async t=>{try{const s=new Uint8Array(t);const o=this.setPathSuffix(e);const a=await Re.isDBInStore(o,this.store);if(!a){await Re.saveDBToStore(o,s,this.store)}else{if(r){await Re.removeDBFromStore(o,this.store);await Re.saveDBToStore(o,s,this.store)}else{i(new Error(`retrieveDBFromZip: cannot overwrite ${o}`))}}n()}catch(t){i(new Error(`retrieveDBFromZip:: ${t.message}`))}}))}))}async copyDatabase(t,e){return new Promise(((r,n)=>{var i=new XMLHttpRequest;var s;i.open("GET",t,true);i.responseType="arraybuffer";i.onerror=()=>{n(new Error(`CopyDatabase: failed`))};i.onload=()=>{s=new Uint8Array(i.response)};i.onloadend=async()=>{const i=this.setPathSuffix(t);const o=await Re.isDBInStore(i,this.store);if(!o){await Re.saveDBToStore(i,s,this.store)}else{if(e){await Re.removeDBFromStore(i,this.store);await Re.saveDBToStore(i,s,this.store)}else{n(new Error(`CopyDatabase Error: cannot overwrite ${i}`))}}r()};i.send()}))}async loadJSON(t){return new Promise(((e,r)=>{var n=new XMLHttpRequest;n.overrideMimeType("application/json");n.open("GET",t,true);n.onerror=()=>{r(new Error(`LoadJSON: failed`))};n.onreadystatechange=function(){if(n.status==404)e(null);if(n.readyState==4&&n.status==200){e(n.responseText)}};n.send(null)}))}async openStore(t,e){let r=false;const n=this.setConfig(t,e);this.store=Ue.createInstance(n);if(this.store!=null){this.storeName=t;r=true}return r}setConfig(t,e){const r={name:t,storeName:e,driver:[Ue.INDEXEDDB],version:1};return r}removePathSuffix(t){return t.includes("SQLite.db")?t.split("SQLite.db")[0]:t.substring(t.length-3)===".db"?t.slice(0,t.lastIndexOf(".")):t}setPathSuffix(t){let e=t.slice(t.lastIndexOf("/")+1);const r=".db";if(t.substring(t.length-3)===r){if(!t.includes("SQLite.db")){e=t.slice(t.lastIndexOf("/")+1,-3)+"SQLite.db"}}return e}async blob2uint(t){return new Response(t).arrayBuffer().then((t=>{const e=new Uint8Array(t);return e}))}async uint2blob(t){const e=new Blob([t.buffer]);return Promise.resolve(e)}render(){return}static get assetsDirs(){return["assets"]}get el(){return r(this)}static get watchers(){return{autoSave:["parseAutoSave"],typeOrm:["parseTypeOrm"],wasmPath:["parseWasmPath"],pickText:["parsePickText"],saveText:["parseSaveText"],buttonOptions:["parseButtonOptions"]}}};cr.style=fr;export{cr as jeep_sqlite};
//# sourceMappingURL=p-950b8f29.entry.js.map