"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9616],{9616:(pe,C,l)=>{l.r(C),l.d(C,{HomePageModule:()=>ae});var m=l(1929),u=l(6814),w=l(6223),p=l(2724),g=l(5861),y=l(3603),T=l(7955),x=l(553),Z=l(1081),M=l(5398),S=l(7442),b=l(7055),e=l(9212),f=l(6215),O=l(4874),I=l(7342),A=l(471),P=l(4083),k=l(8645);let D=(()=>{var i;class c{constructor(){var t=this;this.connected=!1,this.networkInfo=new k.x,this.networkConnection$=this.networkInfo.asObservable(),P.Z.addListener("networkStatusChange",function(){var n=(0,g.Z)(function*(a){t.connected=a.connected,t.networkInfo.next(t.connected)});return function(a){return n.apply(this,arguments)}}())}getNetworkStatus(){var t=this;return(0,g.Z)(function*(){return t.connected=yield(yield P.Z.getStatus()).connected,t.connected})()}}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),c})();var H=l(6593),L=l(1925),v=l(8698),U=l(981),J=l(5189),E=l(3029);const N=["refresher"];function Q(i,c){1&i&&(e.TgZ(0,"div",8),e._UZ(1,"ion-spinner",9),e.qZA())}function Y(i,c){1&i&&(e.TgZ(0,"div",12)(1,"div",13)(2,"div",14),e._UZ(3,"app-skeleton-item",15),e.qZA(),e.TgZ(4,"div",16)(5,"div",17),e._UZ(6,"app-skeleton-item",18),e.qZA(),e.TgZ(7,"div",19),e._UZ(8,"app-skeleton-item",18),e.qZA()()()())}const F=()=>[0,1,2,3,4,5,6,7,8];function $(i,c){1&i&&(e.TgZ(0,"ion-list",10),e.YNc(1,Y,9,0,"div",11),e.qZA()),2&i&&(e.xp6(1),e.Q6J("ngForOf",e.DdM(1,F)))}function R(i,c){1&i&&(e.TgZ(0,"ion-list")(1,"ion-item",20)(2,"ion-label",21),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"No Result")))}function B(i,c){1&i&&(e.TgZ(0,"ion-list")(1,"ion-item",20)(2,"ion-label",21),e._uU(3),e.ALo(4,"translate"),e.qZA()()()),2&i&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"An unknown error occured, please try after sometime")))}function G(i,c){if(1&i){const o=e.EpF();e.TgZ(0,"div",24)(1,"div",25),e.NdJ("click",function(){e.CHM(o);const n=e.oxw(3);return e.KtG(n.navigateToSakhi("story"))}),e._UZ(2,"img",26),e.TgZ(3,"div",27),e._uU(4),e.ALo(5,"translate"),e.qZA()(),e.TgZ(6,"div",25),e.NdJ("click",function(){e.CHM(o);const n=e.oxw(3);return e.KtG(n.navigateToSakhi("teacher"))}),e._UZ(7,"img",28),e.TgZ(8,"div",27),e._uU(9),e.ALo(10,"translate"),e.qZA()()()}2&i&&(e.xp6(4),e.Oqu(e.lcZ(5,2,"Katha Sakhi")),e.xp6(5),e.Oqu(e.lcZ(10,4,"Teacher Tara")))}function W(i,c){if(1&i&&e._UZ(0,"img",34),2&i){const o=e.oxw(2).$implicit;e.Q6J("src",null!=o&&null!=o.metaData&&o.metaData.thumbnail&&!o.metaData.identifier.startsWith("do_")?null==o||null==o.metaData?null:o.metaData.thumbnail:"assets/images/Audio.png",e.LSH)}}function j(i,c){if(1&i&&e._UZ(0,"img",35),2&i){const o=e.oxw(2).$implicit;e.Q6J("appThumbnail",null==o?null:o.metaData)}}function z(i,c){if(1&i&&e._UZ(0,"img",34),2&i){const o=e.oxw(2).$implicit;e.Q6J("src",null!=o&&null!=o.metaData&&o.metaData.thumbnail&&!o.metaData.identifier.startsWith("do_")?null==o||null==o.metaData?null:o.metaData.thumbnail:"assets/images/Video.png",e.LSH)}}function K(i,c){if(1&i&&e._UZ(0,"img",34),2&i){const o=e.oxw(2).$implicit;e.Q6J("src",null!=o&&null!=o.metaData&&o.metaData.thumbnail&&!o.metaData.identifier.startsWith("do_")?null==o||null==o.metaData?null:o.metaData.thumbnail:"assets/images/PDF.png",e.LSH)}}function V(i,c){if(1&i){const o=e.EpF();e.TgZ(0,"div",13)(1,"div",29),e.NdJ("click",function(n){e.CHM(o);const a=e.oxw().$implicit,r=e.oxw(2);return e.KtG(r.playContent(n,a))}),e.YNc(2,W,1,1,"img",30)(3,j,1,1,"img",31)(4,z,1,1,"img",30)(5,K,1,1,"img",30),e.qZA(),e.TgZ(6,"div",16)(7,"div",32),e._uU(8),e.qZA(),e.TgZ(9,"ion-icon",33),e.NdJ("click",function(){e.CHM(o);const n=e.oxw().$implicit,a=e.oxw(2);return e.KtG(a.moreOtions(n))}),e.qZA()()()}if(2&i){const o=e.oxw().$implicit,t=e.oxw(2);e.xp6(2),e.Q6J("ngIf",o.metaData.mimetype===t.mimeType.AUDIO),e.xp6(1),e.Q6J("ngIf",o.metaData.mimetype===t.mimeType.YOUTUBE),e.xp6(1),e.Q6J("ngIf",o.metaData.mimetype===t.mimeType.MP4),e.xp6(1),e.Q6J("ngIf",o.metaData.mimetype===t.mimeType.PDF),e.xp6(3),e.Oqu(null==o.metaData?null:o.metaData.name)}}function q(i,c){if(1&i&&(e.TgZ(0,"div",12),e.YNc(1,G,11,6,"div",22)(2,V,10,5,"div",23),e.qZA()),2&i){const o=c.$implicit,t=c.index;e.xp6(1),e.Q6J("ngIf",5===t),e.xp6(1),e.Q6J("ngIf",o.metaData&&o.metaData.name)}}function X(i,c){if(1&i&&(e.TgZ(0,"ion-list"),e.YNc(1,q,3,2,"div",11),e.qZA()),2&i){const o=e.oxw();e.xp6(1),e.Q6J("ngForOf",o.configContents)}}function ee(i,c){if(1&i){const o=e.EpF();e.TgZ(0,"ion-infinite-scroll",36),e.NdJ("ionInfinite",function(n){e.CHM(o);const a=e.oxw();return e.KtG(a.onIonInfinite(n))}),e._UZ(1,"ion-infinite-scroll-content"),e.qZA()}}const te=[{path:"",component:(()=>{var i;class c{constructor(t,n,a,r,s,d,h,re,se,le,ce,de,ge,me,fe,he,ue){this.headerService=t,this.router=n,this.contentService=a,this.configService=r,this.sunbirdProcess=s,this.modalCtrl=d,this.networkService=h,this.cacheService=re,this.domSanitiser=se,this.storage=le,this.telemetryGeneratorService=ce,this.searchService=de,this.translateService=ge,this.toastController=me,this.botMessageApiService=fe,this.lcoalNotifService=he,this.appUpdateService=ue,this.refresh=!1,this.showSheenAnimation=!0,this.contentList=[],this.isOpen=!1,this.configContents=[],this.optModalOpen=!1,this.networkConnected=!1,this.mimeType=y.Gn,this.noSearchData=!1,this.langChangeSubscription=null,this.serverError=!1,this.onlineState=!1,this.offlineState=!1,this.networkChangeSub=null,this.selectedLang="",this.appName="",b.g.getInfo().then(_=>{this.appName=_.name}),this.configContents=[],this.contentList=[],this.networkChangeSub=this.networkService.networkConnection$.subscribe(_=>{this.networkConnected=_})}ngOnDestroy(){try{this.langChangeSubscription&&this.langChangeSubscription.unsubscribe(),this.networkChangeSub&&this.networkChangeSub.unsubscribe()}catch(t){console.log("error in unsubscribe",t)}}ngOnInit(){var t=this;return(0,g.Z)(function*(){t.headerService.headerEventEmitted$.subscribe(function(){var r=(0,g.Z)(function*(s){if("language"==s){let d=yield t.storage.getData("lang");console.log("lang ",d,t.selectedLang),t.selectedLang!==d&&(t.selectedLang=d,t.showSheenAnimation=!0,t.getServerMetaConfig())}});return function(s){return r.apply(this,arguments)}}());let n={request:{pageId:"",query:void 0,filters:void 0}};if(t.headerService.filterConfigEmitted$.subscribe(function(){var r=(0,g.Z)(function*(s){n.request.pageId=y.uZ.HOME,n.request.query=s.defaultFilter.query,n.request.filters=s.defaultFilter.filters,t.configContents=[],t.contentList=[],t.serverError=!1,t.showSheenAnimation=!0;try{let d=yield t.storage.getData("lang"),h=yield t.configService.getAllContent(n,d);console.log("content",h),t.mappUIContentList(h)}catch{t.showSheenAnimation=!1,t.serverError=!0}});return function(s){return r.apply(this,arguments)}}()),t.headerService.sideMenuItemEventEmitted$.subscribe(function(){var r=(0,g.Z)(function*(s){console.log(s),t.showSheenAnimation=!0;try{let d=yield t.searchService.postContentSearch({query:s.query,filter:s.filters},yield t.storage.getData("lang"));console.log("Response",d),t.mappUIContentList(d)}catch(d){console.log("error",d)}});return function(s){return r.apply(this,arguments)}}()),t.networkConnected=yield t.networkService.getNetworkStatus(),yield t.cacheService.getCacheTimeout())t.getServerMetaConfig();else if(t.networkConnected){t.getServerMetaConfig(),t.configContents=[],t.contentList=[];let r=yield t.contentService.getAllContent();t.contentList=r,t.generateItems(),t.showSheenAnimation=!1}else{t.configContents=[],t.contentList=[];let r=yield t.contentService.getAllContent();t.contentList=r,t.generateItems(),0==t.contentList.length&&t.getServerMetaConfig(),t.showSheenAnimation=!1}yield S.y.preload({assetPath:"public/assets/sounds/windchime.mp3",assetId:"windchime",volume:1,audioChannelNum:1,isUrl:!1}),t.botMessageApiService.deleteExpiredChatMessages().catch(r=>{console.error(r)}),t.appUpdateService.checkForUpdate()})()}mappUIContentList(t){var n=this;return(0,g.Z)(function*(){if(yield n.contentService.deleteAllContents(),n.showSheenAnimation=!1,n.configContents=[],n.contentList=[],t.length>0){n.noSearchData=!1,console.log("content ",t);let a={};t.forEach((r,s)=>{a={},a.source="djp",a.sourceType="djp-content",a.metaData=r,n.contentList.push(a),s<50&&n.configContents.push(a)}),yield n.contentService.saveContents(n.contentList),n.contentService.getAllContent().then(r=>{n.contentList=[],n.contentList=r})}else n.noSearchData=!0})()}getServerMetaConfig(){var t=this;return(0,g.Z)(function*(){let n=yield t.storage.getData("configMeta"),a=n&&"undefined"!=n?JSON.parse(n):yield t.configService.getConfigMeta();a.pageConfig.forEach(r=>{t.filters=r.additionalFilters.sort((s,d)=>s.index-d.index)}),t.languages=a.languages.sort((r,s)=>r.id.localeCompare(s.id)),t.headerService.filterEvent({defaultFilter:a.pageConfig[0].defaultFilter,filter:t.filters,languages:t.languages})})()}tabViewWillEnter(){var t=this;return(0,g.Z)(function*(){yield t.headerService.showHeader(t.appName,!1),setTimeout(()=>{t.headerService.showStatusBar(!1)},0)})()}ionViewWillEnter(){var t=this;return(0,g.Z)(function*(){t.tabViewWillEnter()})()}ionViewDidEnter(){this.headerService.showStatusBar(!1)}moreOtions(t){var n=this;return(0,g.Z)(function*(){let a;n.optModalOpen||(n.optModalOpen=!0,a=yield n.modalCtrl.create({component:T.K,componentProps:{content:t},cssClass:"sheet-modal",breakpoints:[.25],showBackdrop:!1,initialBreakpoint:.25,handle:!1,handleBehavior:"none"}),yield a.present()),a.onDidDismiss().then(function(){var r=(0,g.Z)(function*(s){n.optModalOpen=!1,s.data&&"addToPitara"===s.data.type?n.addContentToMyPitara(s.data.content||t):s.data&&"like"==s.data.type&&(n.contentService.likeContent(s.data.content||t,"guest",!0),s.data.content.metaData.isLiked&&(yield S.y.play({assetId:"windchime"}),(0,M.Z)({startVelocity:30,particleCount:400,spread:360,ticks:60,origin:{y:.5,x:.5},colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"]})),n.telemetryGeneratorService.generateInteractTelemetry("TOUCH","content-liked","home","home",new Z.DR(null==t?void 0:t.metaData.identifier,null==t?void 0:t.metaData.mimetype,"")))});return function(s){return r.apply(this,arguments)}}())})()}initialiseSources(t,n){const a=n.mappings;t.sources&&t.sources.length>0&&t.sources.forEach(r=>{if("sunbird"==r.sourceType){const s=a.find(d=>"sunbird"==d.sourceType);this.sunbirdProcess.process(r,s)}})}playContent(t,n){var a=this;return(0,g.Z)(function*(){a.contentService.markContentAsViewed(n),a.configContents.forEach(r=>{r.play=!1}),yield a.router.navigate(["/player"],{state:{content:n}})})()}addContentToMyPitara(t){var n=this;return(0,g.Z)(function*(){const a=yield n.modalCtrl.create({component:x.W,componentProps:{content:t},cssClass:"add-to-pitara",breakpoints:[0,1],showBackdrop:!1,initialBreakpoint:1,handle:!1,handleBehavior:"none"});yield a.present(),a.onWillDismiss().then(r=>{})})()}doRefresh(t){this.refresh=!0,this.serverError=!1,this.showSheenAnimation=!0,this.getServerMetaConfig(),setTimeout(()=>{this.refresh=!1,t&&t.detail.complete()},100)}handleFilter(t){alert("handle filter "+t)}sanitiseUrl(t){let n=t.split("&")[0];return this.domSanitiser.bypassSecurityTrustResourceUrl(n.replace("watch?v=","embed/")+"?autoplay=1&controls=1")}navigateToSakhi(t){this.telemetryGeneratorService.generateStartTelemetry("bot",`${t}-sakhi`),"story"==t?this.router.navigate([`/${t}`]):"teacher"==t&&this.router.navigate(["/teacher-sakhi"])}generateItems(){const t=this.configContents.length+50;for(let n=this.configContents.length;n<this.contentList.length-1;n++)n<=t&&this.configContents.push(this.contentList[n])}onIonInfinite(t){setTimeout(()=>{this.generateItems(),t.target.complete()},500)}}return(i=c).\u0275fac=function(t){return new(t||i)(e.Y36(f.uj),e.Y36(p.F0),e.Y36(O._),e.Y36(I.E),e.Y36(A.v),e.Y36(m.IN),e.Y36(D),e.Y36(f.$P),e.Y36(H.H7),e.Y36(f.V1),e.Y36(L.E),e.Y36(f.oD),e.Y36(v.sK),e.Y36(m.yF),e.Y36(f.Vn),e.Y36(f.sx),e.Y36(U.Q))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-home"]],viewQuery:function(t,n){if(1&t&&e.Gf(N,5),2&t){let a;e.iGM(a=e.CRH())&&(n.refresher=a.first)}},decls:10,vars:7,consts:[[3,"fullscreen"],["class","spinner-div",4,"ngIf"],["slot","fixed",3,"ionRefresh"],["refresher",""],["refreshingSpinner","circles"],["class","m-n",4,"ngIf"],[4,"ngIf"],[3,"ionInfinite",4,"ngIf"],[1,"spinner-div"],["icon","spiral",1,"refreshspinner"],[1,"m-n"],["class","cards-container",4,"ngFor","ngForOf"],[1,"cards-container"],[1,"card"],["item-start","",1,"card__img"],["height","15rem","width","100%","radius","16px"],[1,"card__metadata"],[2,"width","90%"],["height","12px","width","100%"],[2,"padding-left","1.5rem","width","10%"],["lines","none"],[1,"no-data"],["class","bot-section",4,"ngIf"],["class","card",4,"ngIf"],[1,"bot-section"],[1,"image",3,"click"],["src","assets/images/Story_bot.svg","alt",""],[1,"image-title"],["src","assets/images/Question_bot.svg","alt",""],[1,"card__img",3,"click"],["alt","",3,"src",4,"ngIf"],["appThumbnail","","alt","",3,"appThumbnail",4,"ngIf"],[1,"card__title"],["aria-hidden","true","src","assets/icon/kabab-icon.svg",3,"click"],["alt","",3,"src"],["appThumbnail","","alt","",3,"appThumbnail"],[3,"ionInfinite"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content",0),e.YNc(1,Q,2,0,"div",1),e.TgZ(2,"ion-refresher",2,3),e.NdJ("ionRefresh",function(r){return n.doRefresh(r)}),e._UZ(4,"ion-refresher-content",4),e.qZA(),e.YNc(5,$,2,2,"ion-list",5)(6,R,5,3,"ion-list",6)(7,B,5,3,"ion-list",6)(8,X,2,1,"ion-list",6)(9,ee,2,0,"ion-infinite-scroll",7),e.qZA()),2&t&&(e.Q6J("fullscreen",!0),e.xp6(1),e.Q6J("ngIf",n.refresh),e.xp6(4),e.Q6J("ngIf",n.showSheenAnimation),e.xp6(1),e.Q6J("ngIf",!n.showSheenAnimation&&n.noSearchData&&0==n.configContents.length),e.xp6(1),e.Q6J("ngIf",!n.showSheenAnimation&&n.serverError),e.xp6(1),e.Q6J("ngIf",!n.showSheenAnimation&&n.configContents.length>0),e.xp6(1),e.Q6J("ngIf",!n.showSheenAnimation&&n.configContents.length>0))},dependencies:[m.W2,m.gu,m.ju,m.MB,m.Ie,m.Q$,m.q_,m.nJ,m.Wo,m.PQ,u.sg,u.O5,J.w,E.W,v.X$],styles:[".cards-container[_ngcontent-%COMP%]{padding:.2rem 1rem}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 1rem 1rem}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .image-title[_ngcontent-%COMP%]{position:absolute;bottom:.625rem;color:var(--ion-color-primary-contrast);left:0;right:0;text-align:center}.card[_ngcontent-%COMP%]{position:relative;padding-bottom:1rem}.card__img[_ngcontent-%COMP%]{height:194px;width:100%;overflow:hidden}.card__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;border-radius:1rem}.card__metadata[_ngcontent-%COMP%]{padding-top:.5rem;display:flex;align-items:center;justify-content:space-between}.card__metadata[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{height:1.75rem;width:1.75rem}.card__action-btns[_ngcontent-%COMP%]{display:flex;align-items:center}.card__action-btns[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;margin-right:1rem}.card__action-btns[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]:last-child{margin-left:auto;margin-right:0}.card__title[_ngcontent-%COMP%]{font-size:.75rem;font-weight:400;width:90%;text-transform:capitalize;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.no-data[_ngcontent-%COMP%]{text-align:center}ion-label[_ngcontent-%COMP%]{width:95%}.refreshspinner[_ngcontent-%COMP%]{stroke:#024f9d!important;width:1.875rem;left:0;top:0;height:2.5rem;position:relative!important}.spinner-div[_ngcontent-%COMP%]{padding:2.5rem;background-color:#eceff0;text-align:center;border:none!important}.landscape-icon[_ngcontent-%COMP%]{position:absolute;width:100%;background:transparent;bottom:3.5rem;z-index:9999;background:var(--ion-color-secondary-contrast);opacity:.5}.landscape-icon[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{float:right;font-size:1.5rem;margin-right:.5rem}ion-list[_ngcontent-%COMP%]{background-color:transparent}ion-item[_ngcontent-%COMP%]{--background: transparent}"]}),c})()}];let ne=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[p.Bz.forChild(te),p.Bz]}),c})();var ie=l(822),oe=l(577);let ae=(()=>{var i;class c{}return(i=c).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.Pc,u.ez,w.u5,ne,v.aw,ie.K,oe.o]}),c})()}}]);