"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6577],{8884:(y,_,r)=>{r.d(_,{N1:()=>f});const f=(0,r(2726).fo)("Keyboard")},6577:(y,_,r)=>{r.r(_),r.d(_,{SearchPageModule:()=>X});var p=r(6814),u=r(6223),m=r(1929),f=r(2724),d=r(5861),S=r(3603),M=r(7955),O=r(553),b=r(1081),T=r(8884),t=r(9212),v=r(8698);let Z=(()=>{var a;class h{constructor(n){this.modalCtrl=n}ngOnInit(){}hadleAudioSearch(){this.modalCtrl.dismiss("search")}}return(a=h).\u0275fac=function(n){return new(n||a)(t.Y36(m.IN))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-recording-alert"]],decls:15,vars:6,consts:[["lines","none"],[1,"record_audio"],[1,"msg_speak"],[1,"circle_ripple"],[1,"circle_ripple-2"],[1,"circle"],[1,"circle-2"],["aria-hidden","true","src","assets/icon/mic.svg"],[1,"search_div"],[3,"click"]],template:function(n,i){1&n&&(t.TgZ(0,"div")(1,"ion-item",0)(2,"ion-label",1),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.TgZ(5,"div",2),t._UZ(6,"div",3)(7,"div",4),t.TgZ(8,"div",5)(9,"div",6),t._UZ(10,"ion-icon",7),t.qZA()()(),t.TgZ(11,"div",8)(12,"ion-button",9),t.NdJ("click",function(){return i.hadleAudioSearch()}),t._uU(13),t.ALo(14,"translate"),t.qZA()()()),2&n&&(t.xp6(3),t.Oqu(t.lcZ(4,2,"Speak...")),t.xp6(10),t.Oqu(t.lcZ(14,4,"Search")))},dependencies:[m.YG,m.gu,m.Ie,m.Q$,v.X$],styles:[".record_audio[_ngcontent-%COMP%]{font-size:20px;margin:.5rem 0 0 .5rem}.search_div[_ngcontent-%COMP%]{position:absolute;top:33%;left:50%;transform:translate(-50%,-50%)}.msg_speak[_ngcontent-%COMP%]{position:absolute;left:40%;top:-2%;bottom:100%;transform:translate(-50%)}.msg_speak[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{height:2rem!important;width:2rem!important}.circle_ripple[_ngcontent-%COMP%]{height:50px;width:50px;background:#36B37E;border-radius:50%;animation:_ngcontent-%COMP%_ripple 2s infinite;position:absolute;left:10px;top:110px;z-index:0}.circle_ripple-2[_ngcontent-%COMP%]{height:50px;width:50px;background:#36B37E;border-radius:50%;animation:_ngcontent-%COMP%_ripple-2 2s infinite;position:absolute;left:10px;top:110px}@keyframes _ngcontent-%COMP%_ripple{0%{transform:scale(1)}50%{transform:scale(2);opacity:.3}to{transform:scale(1)}}@keyframes _ngcontent-%COMP%_ripple-2{0%{transform:scale(1)}50%{transform:scale(2.5);opacity:.3}to{transform:scale(1)}}.circle[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:50%;background:#EAEAEA;position:absolute;left:5px;top:105px}.circle-2[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;background:#ffffff;position:absolute;left:5px;top:5px;box-shadow:0 0 8px #00000029;z-index:2}.circle-2[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:20px;position:absolute;left:10px;top:10px}"]}),h})();var A=r(7442),w=r(5398),x=r(2919),P=r(6215),D=r(4584),k=r(1690),R=r(4874),I=r(1925),J=r(5189),B=r(3029);const U=["searchInput"];function L(a,h){1&a&&(t.TgZ(0,"ion-item",16)(1,"div",17),t._UZ(2,"app-skeleton-item",18),t.qZA(),t.TgZ(3,"ion-label",19),t._UZ(4,"app-skeleton-item",20)(5,"app-skeleton-item",21),t.qZA(),t.TgZ(6,"ion-label",22),t._UZ(7,"app-skeleton-item",23),t.qZA()())}const Q=()=>[0,1,2,3,4,5,6,7,8];function N(a,h){1&a&&(t.TgZ(0,"ion-list",12)(1,"ion-item",13)(2,"ion-label",14),t._uU(3),t.ALo(4,"translate"),t.qZA()(),t.YNc(5,L,8,0,"ion-item",15),t.qZA()),2&a&&(t.xp6(3),t.Oqu(t.lcZ(4,2,"Searching...")),t.xp6(2),t.Q6J("ngForOf",t.DdM(4,Q)))}function Y(a,h){if(1&a&&(t.TgZ(0,"ion-list")(1,"ion-item",13)(2,"ion-label",24),t._uU(3),t.ALo(4,"translate"),t.qZA()()()),2&a){const o=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,1,o.errMsg))}}function E(a,h){if(1&a&&t._UZ(0,"img",33),2&a){const o=t.oxw().$implicit;t.Q6J("src",null!=o&&null!=o.metaData&&o.metaData.thumbnail&&!o.metaData.identifier.startsWith("do_")?null==o||null==o.metaData?null:o.metaData.thumbnail:"assets/images/Audio.png",t.LSH)}}function F(a,h){if(1&a&&t._UZ(0,"img",34),2&a){const o=t.oxw().$implicit;t.Q6J("appThumbnail",null==o?null:o.metaData)}}function G(a,h){if(1&a&&t._UZ(0,"img",33),2&a){const o=t.oxw().$implicit;t.Q6J("src",null!=o&&null!=o.metaData&&o.metaData.thumbnail&&!o.metaData.identifier.startsWith("do_")?null==o||null==o.metaData?null:o.metaData.thumbnail:"assets/images/Video.png",t.LSH)}}function K(a,h){if(1&a&&t._UZ(0,"img",33),2&a){const o=t.oxw().$implicit;t.Q6J("src",null!=o&&null!=o.metaData&&o.metaData.thumbnail&&!o.metaData.identifier.startsWith("do_")?null==o||null==o.metaData?null:o.metaData.thumbnail:"assets/images/PDF.png",t.LSH)}}function H(a,h){if(1&a){const o=t.EpF();t.TgZ(0,"ion-item",26)(1,"div",27),t.NdJ("click",function(i){const c=t.CHM(o).$implicit,l=t.oxw(2);return t.KtG(l.playContent(i,c))}),t.YNc(2,E,1,1,"img",28)(3,F,1,1,"img",29)(4,G,1,1,"img",28)(5,K,1,1,"img",28),t.qZA(),t.TgZ(6,"div",30)(7,"div",31),t._uU(8),t.qZA(),t.TgZ(9,"ion-icon",32),t.NdJ("click",function(){const e=t.CHM(o).$implicit,c=t.oxw(2);return t.KtG(c.moreOtions(e))}),t.qZA()()()}if(2&a){const o=h.$implicit,n=t.oxw(2);t.xp6(2),t.Q6J("ngIf",o.metaData.mimetype===n.mimeType.AUDIO),t.xp6(1),t.Q6J("ngIf",o.metaData.mimetype===n.mimeType.YOUTUBE),t.xp6(1),t.Q6J("ngIf",o.metaData.mimetype===n.mimeType.MP4),t.xp6(1),t.Q6J("ngIf",o.metaData.mimetype===n.mimeType.PDF),t.xp6(3),t.Oqu(null==o.metaData?null:o.metaData.name)}}function W(a,h){if(1&a&&(t.TgZ(0,"ion-list"),t.YNc(1,H,10,5,"ion-item",25),t.qZA()),2&a){const o=t.oxw();t.xp6(1),t.Q6J("ngForOf",o.searchContentResult)}}const j=[{path:"",component:(()=>{var a;class h{constructor(n,i,e,c,l,g,s,C,q){this.headerService=n,this.location=i,this.record=e,this.searchApi=c,this.modalCtrl=l,this.contentService=g,this.router=s,this.telemetryGeneratorService=C,this.storage=q,this.showSheenAnimation=!1,this.searchKeywords="",this.searchContentResult=[],this.optModalOpen=!1,this.mimeType=S.Gn,this.noSearchData=!1,this.errMsg="",this.modalPresent=!1,this.disabled=!1,this.startRecording=!1,this.duration=0,this.durationDisplay=""}tabViewWillEnter(){this.headerService.hideHeader(),this.headerService.showStatusBar(!1)}ngOnInit(){}navigateBack(){this.location.back()}ionViewWillEnter(){this.headerService.hideHeader(),this.headerService.showStatusBar(!1)}handleSearch(n,i=!1){var e=this;return(0,d.Z)(function*(){if(i){e.showSheenAnimation=!0;let s=yield e.makeSearchContextApiCall(n,i);var c;null!=s&&s.input?(null!==(c=s.input)&&void 0!==c&&c.sourceText&&(e.searchKeywords=s.input.sourceText),e.handleContentSearch(s,i)):(e.disabled=!1,e.showSheenAnimation=!1,e.noSearchData=!0,e.searchContentResult=[],e.errMsg="Sorry, please try again!")}else if(e.searchKeywords.replace(/\s/g,"").length>0){var l;e.showSheenAnimation=!0,T.N1.hide();let s=yield e.makeSearchContextApiCall(e.searchKeywords,i);var g;null!=s&&null!==(l=s.input)&&void 0!==l&&l.sourceText&&(e.searchKeywords=null==s||null===(g=s.input)||void 0===g?void 0:g.sourceText),e.handleContentSearch(s,!1)}})()}makeSearchContextApiCall(n,i){var e=this;return(0,d.Z)(function*(){return yield e.searchApi.postSearchContext({text:n,currentLang:yield e.storage.getData("lang")},i).then(c=>c).catch(c=>{var l;i?(e.disabled=!1,e.showSheenAnimation=!1,e.noSearchData=!0,e.searchContentResult=[],e.errMsg="unsupported language!"==(null==c||null===(l=c.body)||void 0===l||null===(l=l.detail)||void 0===l?void 0:l.toLowerCase())?"Sorry, this language is not currently supported.":"Sorry, please try again!"):e.handleContentSearch("",!1)})})()}handleContentSearch(n,i=!1){var e=this;return(0,d.Z)(function*(){var c,l;yield e.searchApi.postContentSearch({query:null!==(c=null==n?void 0:n.context)&&void 0!==c?c:e.searchKeywords,filter:null!==(l=null==n?void 0:n.filter)&&void 0!==l?l:""},yield e.storage.getData("lang")).then(g=>{if(console.log("searchRes ",g),e.telemetryGeneratorService.generateSearchTelemetry(i?"audio":"text",i?"":e.searchKeywords,g.length,"search",""),e.disabled=!1,g.length>0){e.showSheenAnimation=!1,e.noSearchData=!1;let s={};e.searchContentResult=[],g.forEach(C=>{s={},s.source="djp",s.sourceType="djp-content",s.metaData=C,e.searchContentResult.push(s)})}else e.showSheenAnimation=!1,e.noSearchData=!0,e.searchContentResult=[],e.errMsg="No Result"}).catch(g=>{var s;e.disabled=!1,e.showSheenAnimation=!1,e.noSearchData=!0,e.searchContentResult=[],e.errMsg="unsupported language!"==(null==g||null===(s=g.body)||void 0===s||null===(s=s.detail)||void 0===s?void 0:s.toLowerCase())?"Sorry, this language is not currently supported.":"Sorry, please try again!"})})()}moreOtions(n){var i=this;return(0,d.Z)(function*(){let e;i.optModalOpen||(i.optModalOpen=!0,e=yield i.modalCtrl.create({component:M.K,componentProps:{content:n},cssClass:"sheet-modal",breakpoints:[.25],showBackdrop:!1,initialBreakpoint:.25,handle:!1,handleBehavior:"none"}),yield e.present()),e.onDidDismiss().then(function(){var c=(0,d.Z)(function*(l){i.optModalOpen=!1,l.data&&"addToPitara"===l.data.type?i.addContentToMyPitara(l.data.content||n):l.data&&"like"==l.data.type&&(i.contentService.likeContent(l.data.content||n,"guest",!0),l.data.content.metaData.isLiked&&(yield A.y.play({assetId:"windchime"}),(0,w.Z)({startVelocity:30,particleCount:400,spread:360,ticks:60,origin:{y:.5,x:.5},colors:["#a864fd","#29cdff","#78ff44","#ff718d","#fdff6a"]})),i.telemetryGeneratorService.generateInteractTelemetry("TOUCH","content-liked","search","search",new b.DR(null==n?void 0:n.metaData.identifier,null==n?void 0:n.metaData.mimetype,"")))});return function(l){return c.apply(this,arguments)}}())})()}addContentToMyPitara(n){var i=this;return(0,d.Z)(function*(){const e=yield i.modalCtrl.create({component:O.W,componentProps:{content:n},cssClass:"add-to-pitara",breakpoints:[0,1],showBackdrop:!1,initialBreakpoint:1,handle:!1,handleBehavior:"none"});yield e.present(),e.onWillDismiss().then(c=>{})})()}playContent(n,i){var e=this;return(0,d.Z)(function*(){e.contentService.markContentAsViewed(i),yield e.router.navigate(["/player"],{state:{content:i}})})()}onLongPressStart(){var n=this;return(0,d.Z)(function*(){console.log("long press on search start"),n.searchKeywords="",(yield(yield x.S.hasAudioRecordingPermission()).value)?(n.record.startRecognition("search"),n.disabled=!0,n.startRecording=!0,n.presentPopover(event),n.calculation()):yield x.S.requestAudioRecordingPermission()})()}presentPopover(n){var i=this;return(0,d.Z)(function*(){i.modal=yield i.modalCtrl.create({component:Z,cssClass:"sheet-modal",breakpoints:[.4],showBackdrop:!1,initialBreakpoint:.4,handle:!1,handleBehavior:"none"}),i.modalPresent=!0,yield i.modal.present(),yield i.modal.onDidDismiss().then(e=>{"search"===e.data&&i.onLongPressEnd()})})()}calculation(){if(!this.startRecording)return this.duration=0,void(this.durationDisplay="");this.duration+=1;const n=Math.floor(this.duration/60),i=(this.duration%60).toString().padStart(2,"0");this.durationDisplay=`${n}:${i}`,this.durationDisplay>"0:05"&&this.onLongPressEnd(),setTimeout(()=>{this.calculation()},1e3)}onLongPressEnd(){var n=this;return(0,d.Z)(function*(){console.log("long press on search end"),yield n.record.stopRecognition("search").then(function(){var i=(0,d.Z)(function*(e){n.modalPresent&&(n.modalPresent=!1,yield n.modal.dismiss()),n.startRecording=!1,n.handleSearch(e,!0)});return function(e){return i.apply(this,arguments)}}())})()}}return(a=h).\u0275fac=function(n){return new(n||a)(t.Y36(P.uj),t.Y36(p.Ye),t.Y36(D.s),t.Y36(k.o),t.Y36(m.IN),t.Y36(R._),t.Y36(f.F0),t.Y36(I.E),t.Y36(P.V1))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-search"]],viewQuery:function(n,i){if(1&n&&t.Gf(U,5),2&n){let e;t.iGM(e=t.CRH())&&(i.searchBar=e.first)}},decls:16,vars:9,consts:[[1,"custom-header"],[1,"header-content"],["slot","start",1,"start-icon"],[3,"click"],["aria-hidden","true","src","assets/icon/back.svg"],["type","search","fill","outline","shape","round",3,"disabled","ngModel","placeholder","keyup.enter","ngModelChange"],["searchInput",""],["slot","end"],[3,"disabled","click"],["aria-hidden","true","src","assets/icon/mic.svg"],["class","m-n",4,"ngIf"],[4,"ngIf"],[1,"m-n"],["lines","none"],[1,"ion-text-center"],["lines","none","style","padding: 5px;",4,"ngFor","ngForOf"],["lines","none",2,"padding","5px"],["item-start","",2,"border-radius","16px"],["height","100px","width","200px","radius","16px",2,"border-radius","16px"],[2,"padding-left","10px"],["height","12px","width","100px",2,"padding-bottom","8px"],["height","12px","width","80px",2,"padding-bottom","8px"],[2,"padding-left","30px"],["height","12px","width","10px",2,"padding-bottom","8px"],[1,"no-data"],["lines","none","class","card",4,"ngFor","ngForOf"],["lines","none",1,"card"],[1,"card__img",3,"click"],["alt","",3,"src",4,"ngIf"],["appThumbnail","","alt","",3,"appThumbnail",4,"ngIf"],[1,"card__metadata"],[1,"card__title"],["aria-hidden","true","src","assets/icon/kabab-icon.svg",3,"click"],["alt","",3,"src"],["appThumbnail","","alt","",3,"appThumbnail"]],template:function(n,i){1&n&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"div",1)(3,"ion-buttons",2)(4,"ion-button",3),t.NdJ("click",function(){return i.navigateBack()}),t._UZ(5,"ion-icon",4),t.qZA()(),t.TgZ(6,"ion-input",5,6),t.NdJ("keyup.enter",function(){return i.handleSearch()})("ngModelChange",function(){return!i.searchContentResult})("ngModelChange",function(c){return i.searchKeywords=c}),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"ion-buttons",7)(10,"ion-button",8),t.NdJ("click",function(){return i.onLongPressStart()}),t._UZ(11,"ion-icon",9),t.qZA()()()()(),t.TgZ(12,"ion-content"),t.YNc(13,N,6,5,"ion-list",10)(14,Y,5,3,"ion-list",11)(15,W,2,1,"ion-list",11),t.qZA()),2&n&&(t.xp6(6),t.Q6J("disabled",i.disabled)("ngModel",i.searchKeywords)("placeholder",t.lcZ(8,7,"SEARCH_HINT")),t.xp6(4),t.Q6J("disabled",i.disabled),t.xp6(3),t.Q6J("ngIf",i.showSheenAnimation),t.xp6(1),t.Q6J("ngIf",!i.showSheenAnimation&&i.noSearchData),t.xp6(1),t.Q6J("ngIf",!i.showSheenAnimation&&i.searchContentResult.length>0))},dependencies:[p.sg,p.O5,u.JJ,u.On,m.YG,m.Sm,m.W2,m.Gu,m.gu,m.pK,m.Ie,m.Q$,m.q_,m.sr,m.j9,J.w,B.W,v.X$],styles:[".cards-container[_ngcontent-%COMP%]{padding:.2rem 1rem}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:0 1rem 1rem}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative}.cards-container[_ngcontent-%COMP%]   .bot-section[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   .image-title[_ngcontent-%COMP%]{position:absolute;bottom:.625rem;color:var(--ion-color-primary-contrast);left:0;right:0;text-align:center}.card[_ngcontent-%COMP%]{position:relative;padding-bottom:1rem}.card__img[_ngcontent-%COMP%]{height:194px;width:100%;overflow:hidden}.card__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;width:100%;height:100%;border-radius:1rem}.card__metadata[_ngcontent-%COMP%]{padding-top:.5rem;display:flex;align-items:center;justify-content:space-between}.card__metadata[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{height:1.75rem;width:1.75rem}.card__action-btns[_ngcontent-%COMP%]{display:flex;align-items:center}.card__action-btns[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;margin-right:1rem}.card__action-btns[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]:last-child{margin-left:auto;margin-right:0}.card__title[_ngcontent-%COMP%]{font-size:.75rem;font-weight:400;width:90%;text-transform:capitalize;word-break:break-word;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.no-data[_ngcontent-%COMP%]{text-align:center}ion-header[_ngcontent-%COMP%]{box-shadow:none}ion-header[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--ion-color-primary)}ion-content[_ngcontent-%COMP%]{--padding-top: 0 !important}.header-content[_ngcontent-%COMP%]{display:flex}  .toolbar-container{padding:0!important;min-height:auto}ion-input[_ngcontent-%COMP%]{margin-top:.5rem;min-height:3rem!important;--border-color: var(--ion-color-medium) !important;--highlight-color: var(--ion-color-secondary-contrast) !important}ion-icon[_ngcontent-%COMP%]{width:1.75rem;height:1.75rem;margin-left:0}.card__img[_ngcontent-%COMP%]{width:40%;height:auto}.card__img[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:90%!important}.card__metadata[_ngcontent-%COMP%]{padding-top:0;padding-left:1rem;align-items:center;width:60%;height:90%}ion-list[_ngcontent-%COMP%]{background-color:transparent}ion-item[_ngcontent-%COMP%]{--background: transparent}.search_text[_ngcontent-%COMP%]{text-align:center}"]}),h})()}];let z=(()=>{var a;class h{}return(a=h).\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[f.Bz.forChild(j),f.Bz]}),h})();var V=r(577),$=r(822);let X=(()=>{var a;class h{}return(a=h).\u0275fac=function(n){return new(n||a)},a.\u0275mod=t.oAB({type:a}),a.\u0275inj=t.cJS({imports:[p.ez,u.u5,m.Pc,z,v.aw,$.K,V.o]}),h})()}}]);